---
title: Exchange 2013 のバックアップ操作の種類
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
localization_priority: Normal
ms.assetid: 70510902-9583-4177-be3d-afbf757a1ec0
description: Exchange 2013 ストア データベースで実行できるバックアップの種類 (完全バックアップ、コピー バックアップ、増分バックアップ、差分バックアップ) について説明します。
ms.openlocfilehash: dd07226acb3a3bb055e98f861a5c01375ee50dda
ms.sourcegitcommit: 88ec988f2bb67c1866d06b361615f3674a24e795
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/31/2020
ms.locfileid: "44456293"
---
# <a name="types-of-backup-operations-for-exchange-2013"></a>Exchange 2013 のバックアップ操作の種類

Exchange 2013 ストア データベースで実行できるバックアップの種類 (完全バックアップ、コピー バックアップ、増分バックアップ、差分バックアップ) について説明します。
  
**製品:** Exchange Server 2013 
  
この記事では、Exchange Server 2013 データベースで実行できるさまざまな種類のバックアップについての情報と、それらのバックアップがデータベースファイルに与える影響について説明します。 
  
ボリューム シャドウ コピー サービス (VSS) と Exchange ライターを使用するバックアップと復元アプリケーションでは、次の表に示す種類のバックアップを実行できます。
  
**表 1.バックアップ操作の種類**

|**バックアップの種類**|**説明**|
|:-----|:-----|
|[完全バックアップ](types-of-backup-operations-for-exchange-2013.md#bk_FullBackups) <br/> |データベース (.edb)、 \* トランザクションログ ( \* .log)、チェックポイントファイル (.chk) をバックアップ \* し、特定のデータベースのトランザクションログを切り詰めます。  <br/> |
|[コピー バックアップ](types-of-backup-operations-for-exchange-2013.md#bk_CopyBackups) <br/> |データベース、トランザクション ログ、およびチェックポイント ファイルをバックアップします。 コピー バックアップでは、データベースのトランザクション ログは切り詰められません。  <br/> |
|[増分バックアップ](types-of-backup-operations-for-exchange-2013.md#bk_IncrementalBackups) <br/> |最後の完全バックアップまたは増分バックアップ以降に行われた変更を記録するトランザクション ログをバックアップして、トランザクション ログを切り詰めます。  <br/> |
|[差分バックアップ](types-of-backup-operations-for-exchange-2013.md#bk_DifferentialBackups) <br/> |最後の完全バックアップまたは増分バックアップ以降に行われた変更を記録するトランザクション ログをバックアップしますが、トランザクション ログは切り詰めません。  <br/> |
   
Exchange ライターによって定義されたコンポーネント、またはデータベースファイルは、Exchange 2013 データベース内のデータベースファイルとトランザクションログを表します。 これにより、バックアップおよび復元アプリケーションで、バックアップ操作中に Exchange 2013 データベース内のコンポーネントの名前を表示することができます。 ただし、バックアップアプリケーションは個別のデータベースコンポーネントをバックアップできません。データベース全体をバックアップできます。 
  
Exchange ライターは、データベース コンポーネントの論理パスを標準化します。このパスは Exchange ライターのメタデータで指定されています。必要に応じて、Exchange ライターはバックアップと復元のアプリケーションに論理パスを返します。
  
Exchange ライターは、論理パスを次の形式で提供します。 
  
 `logicalPath = "Exchange Server\Microsoft Information Store\<Server name>"`
  
サーバー コンポーネントとデータベース コンポーネントはファイル グループのコンポーネントですが、関連ファイルはありません。これらには、個々のファイルを指定するサブコンポーネントがあります。データベースには、Logs という名前のログ コンポーネントが 1 つだけ含まれています。個々のデータベース コンポーネントのコンポーネント名は、文字列で表示されるデータベースの GUID です。  
  
Exchange ライターには、VSS フレームワークのガイドラインに基づいてバックアップできるデータベースのみが一覧表示されます。 Exchange 2013 回復用データベースとしてマウントされているデータベース、およびマウントされていないデータベースはバックアップできないため、Exchange ライターのメタデータにリストされていません。
  
次の図に、Exchange ライターのバックアップ プロセスを示します。 
  
**図 1バックアップ プロセスのイベントのシーケンス**

![バックアップ プロセスのイベント シーケンスを示す図。シーケンスは、Exchange ストアの起動から始まり、Exchange ライター、VSS、およびクライアント アプリケーションの間での多くのステップが続きます。](media/VSS_StoreWriterBackup.gif)
  
## <a name="full-backups"></a>完全バックアップ
<a name="bk_FullBackups"> </a>

Exchange データベースの完全バックアップでは、データベース ファイル、トランザクション ログ、およびチェックポイント ファイルのコピーを作成して格納する必要があります。 Exchange 2013 データベースには、専用のトランザクションログファイルのセットが1つあります。
  
データベースのバックアップが終了した後に、ディスク上のトランザクション ログ ファイルが切り詰められます。これで、バックアップ後に実行したデータベースの変更のみが維持されるようになります。このプロセスの間、Exchange ライターは、データベースが直近のチェックポイントまでのすべての変更を含んだ整合状態で現在バックアップされている、という前提に基づいて、チェックポイントまですべてのログ エントリを削除します。  
  
バックアップ操作中にバックアップ対象のデータベースがマウント解除されている場合、Exchange 2013 はトランザクションログを切り捨てません。結果は、完全なバックアップ操作ではなくコピーバックアップ操作と同じになります。 
  
完全バックアップが完了すると、マウントされているアクティブなデータベースのヘッダーが、現在のバックアップ情報を使用して更新されます。レプリケートされた展開では、この情報はトランザクション ログ ファイルにコミットされ、データベースの別の DAG のコピーにレプリケートされます。データベース コピーのヘッダーは、このトランザクション ログ ファイルがデータベース コピーで再生されるように更新されます。
  
完全シャドウ コピー バックアップは、増分シャドウ コピー バックアップまたは差分シャドウ コピー バックアップを実行するために必要です。完全バックアップは、任意のコピー (シャドウ コピー バックアップに限る) から取得できます。
  
完全バックアップは、次に示すシナリオで使用できます。
  
- データベースが破損または消失したが、ディスク上のトランザクション ログ ファイルはそのまま残っている。このシナリオでは、影響を受けるデータベース ファイルを完全バックアップから復元し、ディスク上に残っているトランザクション ログを再生することにより回復します。  
    
- ディスク上のデータベース ファイルとトランザクション ログ ファイルが消失している。このシナリオでは、完全バックアップの際にバックアップされたトランザクション ログ ファイルがデータベースと共に復元されます。
    
Exchange 2013 では、完全バックアップセットから該当するデータベースを復元しなくても、ログを復元できます。 このオプションは、以前の完全バックアップを復元し、最新の完全バックアップからのトランザクション ログ ファイルを結合して、ロール フォワードを可能にします。
  
Exchange ライターがバックアップを実行するときに VSS の[VSS_BACKUP_TYPE](https://msdn.microsoft.com/library/windows/desktop/aa384679%28v=vs.85%29.aspx)列挙が**VSS_BT_FULL**に設定されている場合は、次のコンポーネントがバックアップに含まれます。 
  
- 論理パスが指定されたデータベース \\ サーバー名 \> \\<データベース GUID<サーバー名\> 
    
- 論理パスが含まれているログファイル。 Exchange サーバー名 Microsoft Information Store \\<サーバー名 \> \\<データベース GUID\> 
    
## <a name="copy-backups"></a>コピー バックアップ
<a name="bk_CopyBackups"> </a>

Exchange データベースのコピー バックアップでは、完全バックアップに含まれる要素と同じ要素を作成して格納する必要があります。ただし、完全バックアップとは異なり、ディスク上のトランザクション ログ ファイルはバックアップが完了しても切り詰められません。コピー バックアップは、データ復旧を目的としたものではありません。その代わりに、コピーバックアップでは、テストや問題の診断、レプリカのシード処理に使用するデータのイメージを提供します。
  
たとえば、exchange ストアに問題が発生している Exchange 2013 管理者は、運用システムに影響を与えることなく、テスト環境で使用するコピーバックアップを作成できます。 コピーバックアップは、定期的なバックアップスケジュールに影響しません。ただし、コピーバックアップでは、Exchange ストアが進行中のバックアップ状態になるため、コピーバックアップが完了するか中止されるまで、他のスケジュールされたバックアップを実行しないようにすることができます。 
  
VSS の[VSS_BACKUP_TYPE](https://msdn.microsoft.com/library/windows/desktop/aa384679%28v=vs.85%29.aspx)列挙が**VSS_BT_COPY**に設定されている場合は、次のコンポーネントがコピーバックアップに含まれます。 
  
- 論理パスが指定されたデータベース \\ サーバー名 \> \\<データベース GUID<サーバー名\> 
    
- 論理パスが含まれているログファイルコンポーネント Exchange \\ サーバー名<サーバー名 \> \\<データベース GUID\>
    
## <a name="incremental-backups"></a>増分バックアップ
<a name="bk_IncrementalBackups"> </a>

Exchange 2013 データベースの増分バックアップは、前回の完全バックアップまたは増分バックアップ以降に発生したデータベースへの変更を保存します。 すべてのデータベース ファイルとログ ファイルがシステムに復元されると、前回の増分バックアップの時点の状態に回復できます。 増分バックアップに格納されているデータには、現在の時刻までのトランザクション ログ ファイルのみが含まれています。 
  
バックアップが完了すると、Exchange サーバーはログ ファイルを切り詰め、データベース ヘッダー内にあるバックアップの時間をマークします。増分バックアップを使用してデータベースを回復するには、復元されるデータ セットが少なくとも 2 つ (直前の完全バックアップと、その後のすべての増分バックアップ) 必要です。増分バックアップの使用には、個々のバックアップが完全バックアップよりはるかに小さいことや、個々の増分バックアップが差分バックアップより小さくなることが多いという利点があります。  
  
増分バックアップの使用には、完全バックアップと完全バックアップの間に何度も増分バックアップを行うと、Exchange ストアの回復によって多くの増分バックアップを引き起こす可能性があるという欠点もあります。Exchange では、増分の変更の開始点を確立するための、以前の完全バックアップがない場合、増分バックアップを実行できません。  
  
DAG コピーの場所から取得した完全バックアップの後に、アクティブな場所からの増分バックアップとその逆を行うことができます。 最後のバックアップ状態がアクティブデータベースのヘッダーに保持され、データベースヘッダーに対する変更が、DAG 展開の他のすべてのトランザクションログと同様に、コピーデータベースの場所でトランザクションログに書き込まれ、レプリケートされ、再生されるという制限があることに注意してください。 バックアップと復元の相互運用性のため、バックアップアプリケーションは、特定の DAG ノードでのみバックアップを実行する機能を提供します。これには、ノードがアクティブであるかパッシブであるかにかかわらず、パッシブノードのみから、またはアクティブなノードからのみバックアップを実行することもできます。
  
VSS の[VSS_BACKUP_TYPE](https://msdn.microsoft.com/library/windows/desktop/aa384679%28v=vs.85%29.aspx)列挙が**VSS_BT_INCREMENTAL**に設定されている場合は、次のコンポーネントが増分バックアップに含まれます。 
  
- 論理パスが指定されたデータベース \\ サーバー名 \> \\<データベース GUID<サーバー名\> 
    
- 論理パスが含まれているログファイル。 Exchange サーバー名 Microsoft Information Store \\<サーバー名 \> \\<データベース GUID\>
    
## <a name="differential-backups"></a>差分バックアップ
<a name="bk_DifferentialBackups"> </a>

Exchange 2013 データベースの差分バックアップは、前回の完全バックアップまたは増分バックアップ以降に発生したデータベースへの変更を保存します。 データベース ファイルとログ ファイルがシステムによって復元されると、前回の差分バックアップの時点の状態に回復できます。 
  
差分バックアップに格納されているデータには、現在のチェックポイントまでのトランザクション ログ ファイルのみが含まれています。差分バックアップでは、ログ ファイルを削除または変更しないでください。または、データベースのヘッダーを変更しないでください。データベースの回復に差分バックアップを使用する場合は、2 つのデータ セット (直前の完全バックアップと、その後に最新の差分バックアップ) のみを復元する必要があります。  
  
差分バックアップの使用には、完全バックアップが実行されるまで差分バックアップは各バックアップ内のバックアップされたデータを重複させる、という欠点があります。　完全バックアップと完全バックアップの間に何度も差分バックアップを行うと、必要な記憶域の量は、同じ回数の増分バックアップに必要な量を超える可能性があります。Exchange では、異なるバックアップの変更の開始点を確立するための完全バックアップまたは増分バックアップがない場合、差分バックアップを実行できません。
  
コピーの場所から取得した完全バックアップに続いて、アクティブな場所とその逆の場所からの差分バックアップを実行できます。最後のバックアップの状態がアクティブなデータベースのヘッダーに維持されていること、データベースのヘッダーに対する変更がトランザクション ログに書き込まれ、レプリケートされ、DAG 展開の他のすべてのトランザクション ログと同様にコピー データベースの場所で再生されること、などの制限に留意してください。バックアップと復元は相互運用されるため、バックアップ アプリケーションでは特定の DAG ノード上で排他的にすべてのバックアップを実行する機能を提供します。これは、ノードがアクティブでもパッシブでも関係ありません。また、パッシブ ノードからの排他的なバックアップの実行でもアクティブ ノードからの排他的なバックアップの実行でも関係ありません。
  
VSS の[VSS_BACKUP_TYPE](https://msdn.microsoft.com/library/windows/desktop/aa384679%28v=vs.85%29.aspx)列挙が**VSS_BT_DIFFERENTIAL**に設定されている場合は、次のコンポーネントが差分バックアップに含まれます。 
  
- 論理パスが指定されたデータベース \\ サーバー名 \> \\<データベース GUID<サーバー名\> 
    
- 論理パスが含まれているログファイル。 Exchange サーバー名 Microsoft Information Store \\<サーバー名 \> \\<データベース GUID\>
    
## <a name="see-also"></a>関連項目
<a name="bk_AdditionalResources"> </a>

- [Exchange 2013 のバックアップと復元アプリケーションの作成](build-backup-and-restore-applications-for-exchange-2013.md)
    
- [Exchange 2013 のバックアップと復元の概念](backup-and-restore-concepts-for-exchange-2013.md)
    
- [Exchange 2013 のデータベースを復元する](restoring-exchange-2013-databases.md)
    
- [Exchange 2013 で CHKSGFILES API を使用してバックアップの整合性を検証する](how-to-validate-backup-integrity-by-using-the-chksgfiles-api-in-exchange.md)
    
- [Exchange 2013 で Eseutil ツールを使用してバックアップの整合性を検証する](how-to-validate-backup-integrity-by-using-the-eseutil-tool-in-exchange-2013.md)
    

