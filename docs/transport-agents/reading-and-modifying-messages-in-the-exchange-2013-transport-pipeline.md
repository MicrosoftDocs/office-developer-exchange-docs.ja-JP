---
title: Exchange 2013 トランスポート パイプライン内のメッセージの読み取りおよび変更
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
localization_priority: Normal
ms.assetid: b53ed47a-3d01-4c4e-ad32-fb0532872aad
description: Exchange 2013 のカスタム トランスポート エージェントでメッセージを読み取り、書き込み、および変更するために使用できる .NET Framework クラスの詳細について説明します。
ms.openlocfilehash: 42d9dc7f05dce495b7695a2862af244313caffcb
ms.sourcegitcommit: 88ec988f2bb67c1866d06b361615f3674a24e795
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/03/2020
ms.locfileid: "44527580"
---
# <a name="reading-and-modifying-messages-in-the-exchange-2013-transport-pipeline"></a><span data-ttu-id="33e37-103">Exchange 2013 トランスポート パイプライン内のメッセージの読み取りおよび変更</span><span class="sxs-lookup"><span data-stu-id="33e37-103">Reading and modifying messages in the Exchange 2013 transport pipeline</span></span>

<span data-ttu-id="33e37-104">Exchange 2013 のカスタム トランスポート エージェントでメッセージを読み取り、書き込み、および変更するために使用できる .NET Framework クラスの詳細について説明します。</span><span class="sxs-lookup"><span data-stu-id="33e37-104">Learn about the .NET Framework classes you can use in your Exchange 2013 transport agents to read, write, and modify messages.</span></span>
  
<span data-ttu-id="33e37-105">**製品:** Exchange Server 2013</span><span class="sxs-lookup"><span data-stu-id="33e37-105">**Applies to:** Exchange Server 2013</span></span>
  
- <span data-ttu-id="33e37-106">メッセージの読み取り、書き込み、または変更に使用するクラス</span><span class="sxs-lookup"><span data-stu-id="33e37-106">Classes used to read, write, or modify messages</span></span>
- <span data-ttu-id="33e37-107">Encoders 名前空間</span><span class="sxs-lookup"><span data-stu-id="33e37-107">Encoders namespace</span></span>
- <span data-ttu-id="33e37-108">iCalendar 名前空間</span><span class="sxs-lookup"><span data-stu-id="33e37-108">iCalendar namespace</span></span>
- <span data-ttu-id="33e37-109">MIME 名前空間</span><span class="sxs-lookup"><span data-stu-id="33e37-109">MIME namespace</span></span>
- <span data-ttu-id="33e37-110">TextConverters 名前空間</span><span class="sxs-lookup"><span data-stu-id="33e37-110">TextConverters namespace</span></span>
- <span data-ttu-id="33e37-111">Tnef 名前空間</span><span class="sxs-lookup"><span data-stu-id="33e37-111">Tnef namespace</span></span>
- <span data-ttu-id="33e37-112">vCard 名前空間</span><span class="sxs-lookup"><span data-stu-id="33e37-112">vCard namespace</span></span>
  
<span data-ttu-id="33e37-p101">メッセージがトランスポート パイプラインを通過するときに、トランスポート エージェントはメッセージの内容を読み取ったり、書き込んだり、別のデータ形式に変換したりできます。たとえば、MIME データを読み取ったり書き込んだりできます。また、uuencode 形式や Quoted-printable (qp) 形式の着信メッセージを識別して、そのメッセージを組織で使用している標準に変換することも、着信メッセージに関連付けられている予定表または連絡先情報を読み取って保存することもできます。 </span><span class="sxs-lookup"><span data-stu-id="33e37-p101">As messages pass through the transport pipeline, your transport agent can read, write, and convert message content between different data formats. For example, you can read and write MIME data, identify incoming messages that are in Uuencoded or Quoted-printable (qp) format, and then convert them to a standard used by your organization, or read and then save calendar or contact information associated with incoming messages.</span></span> 
  
<span data-ttu-id="33e37-115">さらに、セキュリティ上の問題を引き起こすコンテンツを識別し、それらを含むコンテンツやメッセージを移動または削除する (たとえば、HTML メッセージのリンクを削除するなど) こともできます。</span><span class="sxs-lookup"><span data-stu-id="33e37-115">You can also identify content that poses a security threat and move or delete the content or the messages that contain them; for example, by removing links in an HTML message.</span></span>
  
<span data-ttu-id="33e37-116">この記事では、メッセージの読み取り、書き込み、および変更に使用できる .NET Framework のクラスに関する情報を提供します。</span><span class="sxs-lookup"><span data-stu-id="33e37-116">This article provides information about the .NET Framework classes that you can use to read, write, and modify messages.</span></span>
  
> [!CAUTION]
> <span data-ttu-id="33e37-p102">コンテンツ変換 API の多くのプロパティとパラメーターには、パフォーマンスの問題 (サービス拒否攻撃を含む) を引き起こすほど大きな値が使用できます。トランスポート エージェントでコンテンツ変換 API を使用する場合は、エージェントのリソース消費量に制限をかけるため、読み取り時や書き込み時にプロパティ値とパラメーター値でサポートするサイズに制限を実装する必要があります。</span><span class="sxs-lookup"><span data-stu-id="33e37-p102">Many of the properties and parameters in the content conversion APIs allow values large enough to cause performance problems, including denial of service. When you use the content conversion APIs in a transport agent, you should implement limits on the property and parameter value sizes you support when reading or writing in order to limit resource consumption by your agent.</span></span> 

<span data-ttu-id="33e37-119"><a name="Namespaces"> </a></span><span class="sxs-lookup"><span data-stu-id="33e37-119"><a name="Namespaces"> </a></span></span>

## <a name="classes-used-to-read-write-or-modify-messages"></a><span data-ttu-id="33e37-120">メッセージの読み取り、書き込み、または変更に使用するクラス</span><span class="sxs-lookup"><span data-stu-id="33e37-120">Classes used to read, write, or modify messages</span></span>

<span data-ttu-id="33e37-121">次の表に、電子メール メッセージの読み取り、書き込み、および変更に使用できる .NET Framework のクラスを示します。</span><span class="sxs-lookup"><span data-stu-id="33e37-121">The following table lists the .NET Framework classes that you can use to read, write, and modify email messages.</span></span>
  
<span data-ttu-id="33e37-122">**.NET Framework のメッセージ処理の名前空間**</span><span class="sxs-lookup"><span data-stu-id="33e37-122">**.NET Framework message processing namespaces**</span></span>

|<span data-ttu-id="33e37-123">**.NET Framework 名前空間**</span><span class="sxs-lookup"><span data-stu-id="33e37-123">**.NET Framework namespace**</span></span>|<span data-ttu-id="33e37-124">**Classes**</span><span class="sxs-lookup"><span data-stu-id="33e37-124">**Classes**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="33e37-125">(データの場合)</span><span class="sxs-lookup"><span data-stu-id="33e37-125">Microsoft.Exchange.Data.Mime.Encoders</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.aspx) <br/> |<span data-ttu-id="33e37-126">メモリ内エンコードおよびデコード用のクラスが含まれています。これには、関連付けられている列挙に含まれるエンコーダークラスまたはデコーダークラスの1つ、およびエンコーダーとデコーダーの[Byteencoder](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.ByteEncoder.aspx)基本クラスと[ByteEncoderException](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.ByteEncoderException.aspx) exception クラスのいずれかを受け取るエンコーダーストリームクラスが含まれます。</span><span class="sxs-lookup"><span data-stu-id="33e37-126">Contains classes for in-memory encoding and decoding, an encoder stream class that accepts one of the encoder or decoder classes contained in an associated enumeration, and the [ByteEncoder](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.ByteEncoder.aspx) base class and [ByteEncoderException](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.ByteEncoderException.aspx) exception class for the encoders and decoders.</span></span>  <br/> |
|[<span data-ttu-id="33e37-127">ContentTypes を行います。</span><span class="sxs-lookup"><span data-stu-id="33e37-127">Microsoft.Exchange.Data.ContentTypes.iCalendar</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.aspx) <br/> |<span data-ttu-id="33e37-p103">予定表の情報が含まれているデータ ストリームの読み書きを可能にする型が含まれています。これには、予定表のリーダーとライター、例外オブジェクト、定期的なアイテム オブジェクト、および予定表アイテムに関するプロパティ情報を返す際に役立つ構造体と列挙体が含まれます。</span><span class="sxs-lookup"><span data-stu-id="33e37-p103">Contains types that enable you to read and write data streams that contain calendar information. Includes a calendar reader and writer, an exception object, a recurrence object, and structures and enumerations that help you return property information about calendar items.</span></span>  <br/> |
|[<span data-ttu-id="33e37-130">Microsoft. データの Mime</span><span class="sxs-lookup"><span data-stu-id="33e37-130">Microsoft.Exchange.Data.Mime</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.aspx) <br/> |<span data-ttu-id="33e37-p104">MIME データの作成、読み取り、書き込み、走査、エンコード、およびデコードに使用できるクラス、構造体、列挙体およびデリゲートが含まれています。これには、MIME データ ストリームへの順方向専用の読み取り書き込みアクセスが可能になるストリーム ベースのリーダーとライターと、MIME ドキュメントに使用可能な DOM ベースのメソッドとクラスが含まれています。</span><span class="sxs-lookup"><span data-stu-id="33e37-p104">Contains classes, structures, enumerations, and delegates that you can use to create, read, write, traverse, encode, and decode MIME data. Includes a stream-based reader and writer that gives you forward-only read and write access to MIME data streams, as well as DOM-based methods and classes you can use on MIME documents.</span></span>  <br/> |
|[<span data-ttu-id="33e37-133">Microsoft のデータ変換器</span><span class="sxs-lookup"><span data-stu-id="33e37-133">Microsoft.Exchange.Data.TextConverters</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.aspx) <br/> |<span data-ttu-id="33e37-p105">データ ストリームの読み書きと、特定のデータ形式間での変換 (HTML からリッチ テキスト形式 (RTF) への変換など) の実行を可能にするクラス、構造体、列挙体、およびデリゲートが含まれています。テキスト コンバーターを使用すると、ドキュメント ストリームの形式を相互に変換できるようになり、セキュリティ上のリスクを招く可能性のあるドキュメントの要素を選択的に削除することもできるようになります。 </span><span class="sxs-lookup"><span data-stu-id="33e37-p105">Contains classes, structures, enumerations, and delegates that allow you to read and write a data stream and perform conversions between specific data types; for example, HTML to Rich Text Format (RTF). Text converters enable you to change the format of a document stream from one form to another as well as selectively remove elements of a document that might pose a security risk.</span></span>  <br/> |
|[<span data-ttu-id="33e37-136">ContentTypes (. Tnef)</span><span class="sxs-lookup"><span data-stu-id="33e37-136">Microsoft.Exchange.Data.ContentTypes.Tnef</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.aspx) <br/> |<span data-ttu-id="33e37-137">Transport Neutral Encapsulation Format (TNEF) の読み取りと書き込みが容易になる順方向専用のストリーム リーダーとライター、例外クラス、および構造体と列挙体が含まれています。</span><span class="sxs-lookup"><span data-stu-id="33e37-137">Contains a forward-only stream reader and writer, an exception class, and structures and enumerations that facilitate reading and writing Transport Neutral Encapsulation Format (TNEF) data.</span></span>  <br/> |
|[<span data-ttu-id="33e37-138">ContentTypes (. vCard)</span><span class="sxs-lookup"><span data-stu-id="33e37-138">Microsoft.Exchange.Data.ContentTypes.vCard</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.vCard.aspx) <br/> |<span data-ttu-id="33e37-139">vCard 形式の連絡先データの読み取りと書き込みが容易になる順方向専用のストリーム リーダーとライター、例外クラス、および構造体と列挙体が含まれています。</span><span class="sxs-lookup"><span data-stu-id="33e37-139">Contains a forward-only stream reader and writer, an exception class, and structures and enumerations that facilitate reading and writing vCard-formatted contact data.</span></span>  <br/> |
   
## <a name="encoders-namespace"></a><span data-ttu-id="33e37-140">Encoders 名前空間</span><span class="sxs-lookup"><span data-stu-id="33e37-140">Encoders namespace</span></span>
<span data-ttu-id="33e37-141"><a name="Encoders"> </a></span><span class="sxs-lookup"><span data-stu-id="33e37-141"><a name="Encoders"> </a></span></span>

<span data-ttu-id="33e37-142">Encoders 名前空間には、メモリ内エンコードおよびデコードに対応するクラスが含まれています。</span><span class="sxs-lookup"><span data-stu-id="33e37-142">The Encoders namespace contains classes for in-memory encoding and decoding.</span></span> <span data-ttu-id="33e37-143">これらは、 [Byteencoder](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.ByteEncoder.aspx)基本クラスから継承します。</span><span class="sxs-lookup"><span data-stu-id="33e37-143">These inherit from the [ByteEncoder](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.ByteEncoder.aspx) base class.</span></span> <span data-ttu-id="33e37-144">各クラスでは、Base64、BinHex、Quoted-printable (qp)、および Unix-to-Unix (Uu) のエンコードとデコードを行います。</span><span class="sxs-lookup"><span data-stu-id="33e37-144">Classes encode and decode for Base64, BinHex, Quoted-printable (qp), and Unix-to-Unix (Uu).</span></span> <span data-ttu-id="33e37-145">メモリ内エンコードおよびデコードに使用されるクラスを次に示します。</span><span class="sxs-lookup"><span data-stu-id="33e37-145">The following classes are used for in-memory encoding and decoding:</span></span> 
  
- [<span data-ttu-id="33e37-146">Base64Encoder</span><span class="sxs-lookup"><span data-stu-id="33e37-146">Base64Encoder</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.Base64Encoder.aspx)
    
- [<span data-ttu-id="33e37-147">Base64Decoder</span><span class="sxs-lookup"><span data-stu-id="33e37-147">Base64Decoder</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.Base64Decoder.aspx)
    
- [<span data-ttu-id="33e37-148">BinHexEncoder</span><span class="sxs-lookup"><span data-stu-id="33e37-148">BinHexEncoder</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.BinHexEncoder.aspx)
    
- [<span data-ttu-id="33e37-149">BinHexDecoder</span><span class="sxs-lookup"><span data-stu-id="33e37-149">BinHexDecoder</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.BinHexDecoder.aspx)
    
- [<span data-ttu-id="33e37-150">QPEncoder</span><span class="sxs-lookup"><span data-stu-id="33e37-150">QPEncoder</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.QPEncoder.aspx)
    
- [<span data-ttu-id="33e37-151">QPDecoder</span><span class="sxs-lookup"><span data-stu-id="33e37-151">QPDecoder</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.QPDecoder.aspx)
    
- [<span data-ttu-id="33e37-152">UUEncoder</span><span class="sxs-lookup"><span data-stu-id="33e37-152">UUEncoder</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.UUEncoder.aspx)
    
- [<span data-ttu-id="33e37-153">UUDecoder</span><span class="sxs-lookup"><span data-stu-id="33e37-153">UUDecoder</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.UUDecoder.aspx)
    
<span data-ttu-id="33e37-154">エンコーダーとデコーダーは、 [Byteencoder](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.ByteEncoder.aspx)基本クラスから継承し、エラー処理に[ByteEncoderException](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.ByteEncoderException.aspx) exception クラスを使用します。</span><span class="sxs-lookup"><span data-stu-id="33e37-154">The encoders and decoders inherit from the [ByteEncoder](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.ByteEncoder.aspx) base class and use the [ByteEncoderException](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.ByteEncoderException.aspx) exception class for error handling.</span></span> 
  
<span data-ttu-id="33e37-155">また、この名前空間には、MacBinary でエンコードされたファイルを識別し、関連するファイルヘッダーを読み取る[Macbinaryheader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.MacBinaryHeader.aspx)クラスが含まれています。</span><span class="sxs-lookup"><span data-stu-id="33e37-155">Additionally, the namespace contains the [MacBinaryHeader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.MacBinaryHeader.aspx) class, which identifies MacBinary encoded files and reads their associated file header.</span></span> 
  
<span data-ttu-id="33e37-156">最後に、 [EncoderStream](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.EncoderStream.aspx)クラスでは、メモリ内オブジェクトではなく、データストリームに対する変換が実行されます。</span><span class="sxs-lookup"><span data-stu-id="33e37-156">Finally, the [EncoderStream](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.EncoderStream.aspx) class performs a conversion on a data stream instead of an in-memory object.</span></span> <span data-ttu-id="33e37-157">このクラスは、エンコーダーまたはデコーダーのいずれかのクラスを受け入れ、関連付けられた[EncoderStreamAccess](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.EncoderStreamAccess.aspx)列挙に従って読み取りまたは書き込みを行います。</span><span class="sxs-lookup"><span data-stu-id="33e37-157">This class accepts one of the encoder or decoder classes and either reads or writes according to the associated [EncoderStreamAccess](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.EncoderStreamAccess.aspx) enumeration.</span></span> 
  
## <a name="icalendar-namespace"></a><span data-ttu-id="33e37-158">iCalendar 名前空間</span><span class="sxs-lookup"><span data-stu-id="33e37-158">iCalendar namespace</span></span>
<span data-ttu-id="33e37-159"><a name="iCalendar"> </a></span><span class="sxs-lookup"><span data-stu-id="33e37-159"><a name="iCalendar"> </a></span></span>

<span data-ttu-id="33e37-160">iCalendar 名前空間には、iCalendar データに対応した順方向専用のリーダーおよびライターと、iCalendar ストリームの作成、アクセス、および変更をサポートする構造体とクラスが用意されています。</span><span class="sxs-lookup"><span data-stu-id="33e37-160">The iCalendar namespace provides a forward-only reader and writer for iCalendar data, in addition to supporting structures and classes for creating, accessing, and modifying iCalendar streams.</span></span>
  
<span data-ttu-id="33e37-161">[Calendarreader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.aspx)および[calendarreader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarWriter.aspx)クラスは、iCalendar ストリームデータの読み取りおよび書き込みに使用されます。</span><span class="sxs-lookup"><span data-stu-id="33e37-161">The [CalendarReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.aspx) and [CalendarWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarWriter.aspx) classes are used to read and write iCalendar stream data.</span></span> 
  
<span data-ttu-id="33e37-162">CalendarReader は、読み取り可能な[ストリーム](https://msdn.microsoft.com/library/System.IO.Stream.aspx)をコンストラクターの引数として受け取ります。</span><span class="sxs-lookup"><span data-stu-id="33e37-162">The CalendarReader takes a readable [Stream](https://msdn.microsoft.com/library/System.IO.Stream.aspx) as an argument to its constructors.</span></span> <span data-ttu-id="33e37-163">その後、 [Readfirstchildcomponent](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.ReadFirstChildComponent.aspx)、 [ReadNextSiblingComponent](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.ReadNextSiblingComponent.aspx)、 [readnextcomponent](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.ReadNextComponent.aspx)の各メソッドを使用して、データストリーム内の iCalendar コンポーネントに順次アクセスします。</span><span class="sxs-lookup"><span data-stu-id="33e37-163">You can then use the [ReadFirstChildComponent](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.ReadFirstChildComponent.aspx), [ReadNextSiblingComponent](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.ReadNextSiblingComponent.aspx), and [ReadNextComponent](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.ReadNextComponent.aspx) methods to sequentially access the iCalendar components in the data stream.</span></span> <span data-ttu-id="33e37-164">[ComplianceMode](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.ComplianceMode.aspx)プロパティに設定した値に基づいて、iCalendar ストリームのエラーによって例外がスローされるか、 [ComplianceStatus](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.ComplianceStatus.aspx)プロパティが[準拠](https://msdn.microsoft.com/library/microsoft.exchange.data.contenttypes.icalendar.calendarcompliancestatus.aspx)していない値に設定されることがあります。</span><span class="sxs-lookup"><span data-stu-id="33e37-164">Based on the value that you have set for the [ComplianceMode](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.ComplianceMode.aspx) property, errors in the iCalendar stream will cause an exception to be thrown or will cause the [ComplianceStatus](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.ComplianceStatus.aspx) property to be set to a value other than [Compliant](https://msdn.microsoft.com/library/microsoft.exchange.data.contenttypes.icalendar.calendarcompliancestatus.aspx).</span></span> <span data-ttu-id="33e37-165">このプロパティを確認することで、受信 iCalendar データの問題を検出できます。</span><span class="sxs-lookup"><span data-stu-id="33e37-165">You can check this property to discover any issues with incoming iCalendar data.</span></span> 
  
<span data-ttu-id="33e37-166">[Calendarwriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarWriter.aspx)クラスは、書き込み可能な[ストリーム](https://msdn.microsoft.com/library/System.IO.Stream.aspx)をコンストラクターの引数として受け取ります。</span><span class="sxs-lookup"><span data-stu-id="33e37-166">The [CalendarWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarWriter.aspx) class takes a writable [Stream](https://msdn.microsoft.com/library/System.IO.Stream.aspx) as an argument to its constructors.</span></span> 
  
## <a name="mime-namespace"></a><span data-ttu-id="33e37-167">MIME 名前空間</span><span class="sxs-lookup"><span data-stu-id="33e37-167">MIME namespace</span></span>
<span data-ttu-id="33e37-168"><a name="MIME"> </a></span><span class="sxs-lookup"><span data-stu-id="33e37-168"><a name="MIME"> </a></span></span>

<span data-ttu-id="33e37-p109">MIME 名前空間には、MIME ドキュメントの作成、アクセス、および変更を可能にするクラスが用意されています。ストリーム ベースのメソッドまたは DOM ベースのメソッドのどちらかを使用して、MIME ドキュメントを操作できます。</span><span class="sxs-lookup"><span data-stu-id="33e37-p109">The MIME namespace provides classes that enable you to create, access, and modify MIME documents. You can work with MIME documents by using either a stream-based or DOM-based method.</span></span>
  
### <a name="mimedocument-class-and-the-mime-dom"></a><span data-ttu-id="33e37-171">MimeDocument クラスと MIME DOM</span><span class="sxs-lookup"><span data-stu-id="33e37-171">MimeDocument class and the MIME DOM</span></span>

<span data-ttu-id="33e37-172">[MimeDocument](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.aspx)クラスを使用すると、MIME ドキュメントへの DOM アクセスが可能になります。</span><span class="sxs-lookup"><span data-stu-id="33e37-172">The [MimeDocument](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.aspx) class enables DOM access to a MIME document.</span></span> <span data-ttu-id="33e37-173">この型のオブジェクトは、DOM 全体をロードできるメモリ容量があり、メッセージのヘッダーとコンテンツへのランダム アクセスが必要なときに使用します。</span><span class="sxs-lookup"><span data-stu-id="33e37-173">Use objects of this type when you have the available memory to load a whole DOM and you must have random access to the headers and content of the message.</span></span> 
  
<span data-ttu-id="33e37-174">[Getloadstream](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.GetLoadStream.aspx)メソッドまたは[load](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.Load.aspx)メソッドを使用して、 [MimeDocument](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.aspx)オブジェクトにデータを読み込むことができます。</span><span class="sxs-lookup"><span data-stu-id="33e37-174">You load data into a [MimeDocument](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.aspx) object by using the [GetLoadStream](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.GetLoadStream.aspx) or [Load](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.Load.aspx) methods.</span></span> <span data-ttu-id="33e37-175">その後、DOM 階層を辿って MIME データを作成、変更、または削除します。</span><span class="sxs-lookup"><span data-stu-id="33e37-175">You can then walk the DOM hierarchy and create, modify, or remove MIME data.</span></span> <span data-ttu-id="33e37-176">MIME データを変更した後は、 [writeto](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeNode.WriteTo.aspx)メソッドのいずれかを使用して、そのデータをストリームに書き込むことができます。</span><span class="sxs-lookup"><span data-stu-id="33e37-176">After you have modified the MIME data, you can write it to a stream by using one of the [WriteTo](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeNode.WriteTo.aspx) methods.</span></span> 
  
<span data-ttu-id="33e37-177">次の図は、 [MimeDocument](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.aspx)オブジェクト内のデータの構造を示しています。</span><span class="sxs-lookup"><span data-stu-id="33e37-177">The following figure shows the structure of data within a [MimeDocument](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.aspx) object.</span></span> 
  
<span data-ttu-id="33e37-178">**図1。MimeDocument オブジェクトの構造**</span><span class="sxs-lookup"><span data-stu-id="33e37-178">**Figure 1. Structure of MimeDocument objects**</span></span>

![MIME DOM のアーキテクチャ](media/MimeDomArchitecture.gif)
  
### <a name="mimereader-and-mimewriter-classes-and-stream-based-mime-parsing"></a><span data-ttu-id="33e37-180">MimeReader クラスおよび MimeWriter クラスとストリーム ベースの MIME 解析</span><span class="sxs-lookup"><span data-stu-id="33e37-180">MimeReader and MimeWriter classes and stream-based MIME parsing</span></span>

<span data-ttu-id="33e37-181">[MimeReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeReader.aspx)クラスと[MimeWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeWriter.aspx)クラスは、MIME ストリームへの前方のみのアクセスを有効にします。</span><span class="sxs-lookup"><span data-stu-id="33e37-181">The [MimeReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeReader.aspx) and [MimeWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeWriter.aspx) classes enable forward-only access to MIME streams.</span></span> <span data-ttu-id="33e37-182">これらのクラスは、MIME データを変更する必要がなく、読み取りまたは書き込みが完了しているデータが必要になる場合に使用します。</span><span class="sxs-lookup"><span data-stu-id="33e37-182">Use these classes when you do not have to change the MIME data that requires data that has already been read or written.</span></span> <span data-ttu-id="33e37-183">たとえば、定義済みの形式に一致するメッセージを印刷する場合は、 [MimeWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeWriter.aspx)クラスが理想的な場合があります。</span><span class="sxs-lookup"><span data-stu-id="33e37-183">For example, if you want to print messages that fit a predefined format, the [MimeWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeWriter.aspx) class might be ideal.</span></span> 
  
<span data-ttu-id="33e37-184">[MimeDocument](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.aspx)クラスは、DOM をカプセル化します。</span><span class="sxs-lookup"><span data-stu-id="33e37-184">The [MimeDocument](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.aspx) class encapsulates a DOM.</span></span> <span data-ttu-id="33e37-185">[MimeReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeReader.aspx)クラスと[MimeWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeWriter.aspx)クラスは、状態コンピューターを表します。</span><span class="sxs-lookup"><span data-stu-id="33e37-185">The [MimeReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeReader.aspx) and [MimeWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeWriter.aspx) classes represent state computers.</span></span> <span data-ttu-id="33e37-186">それらの状態は、受信した入力と呼び出したメソッドによって変化します。</span><span class="sxs-lookup"><span data-stu-id="33e37-186">Their states change based on the input received and the methods called.</span></span> <span data-ttu-id="33e37-187">図 2 ~ 5 は、 [MimeReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeReader.aspx)オブジェクトに対して、各状態から呼び出すことができるメソッドとその結果の状態を示す、簡略化された状態遷移図です。</span><span class="sxs-lookup"><span data-stu-id="33e37-187">Figures 2 through 5 are simplified state transition diagrams that show, for the [MimeReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeReader.aspx) object, which methods are valid to call from each state and the state that will result.</span></span> 
  
<span data-ttu-id="33e37-188">これらの図を使用する場合は、ある状態から次の状態への矢印に従い、状態の変化を起こすメソッドの呼び出しや戻り値に注目します。</span><span class="sxs-lookup"><span data-stu-id="33e37-188">To use these diagrams, follow the arrows from one state to the next, noting the method calls or return values that cause the state to change.</span></span> <span data-ttu-id="33e37-189">たとえば、最初の図では、自作の MimeReader に属するストリームの開始点を想定しています。</span><span class="sxs-lookup"><span data-stu-id="33e37-189">For example, in the first diagram, assume that you are at the start of the stream that belongs to the MimeReader that you have created.</span></span> <span data-ttu-id="33e37-190">パーツヘッダーの状態を取得するには、 [Readnextpart](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeReader.ReadNextPart.aspx)または[readfirstchildpart](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeReader.ReadFirstChildPart.aspx)のいずれかをその順序で呼び出します。</span><span class="sxs-lookup"><span data-stu-id="33e37-190">To get to the Part Headers state, call one of [ReadNextPart](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeReader.ReadNextPart.aspx) or [ReadFirstChildPart](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeReader.ReadFirstChildPart.aspx), in that order.</span></span> <span data-ttu-id="33e37-191">ヘッダーが存在する場合 (MIME が整形式の場合) は、Part Headers 状態に移行します。</span><span class="sxs-lookup"><span data-stu-id="33e37-191">If there are headers (that is, if the MIME is well-formed), you will enter into the Part Headers state.</span></span> <span data-ttu-id="33e37-192">それ以外の場合は、例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="33e37-192">Otherwise, an exception will be thrown.</span></span> 
  
<span data-ttu-id="33e37-193">**図2MimeReader オブジェクトの簡略化された状態遷移図**</span><span class="sxs-lookup"><span data-stu-id="33e37-193">**Figure 2. Simplified state transition diagram for MimeReader objects**</span></span>

![MimeReader 状態図](media/MimeReader_StateDiagram_01.gif)
  
> [!NOTE]
> <span data-ttu-id="33e37-195">図 3、4 および 5 では、それぞれ前の図に示した状態を詳しく説明しています。</span><span class="sxs-lookup"><span data-stu-id="33e37-195">Figures 3, 4, and 5 expand on states shown in each of the previous diagrams.</span></span> 
  
<span data-ttu-id="33e37-196">**図3図2のパーツヘッダー状態の拡張**</span><span class="sxs-lookup"><span data-stu-id="33e37-196">**Figure 3. Expansion of Part Headers state from Figure 2**</span></span>

!["Part Headers" 状態の拡張](media/MimeReader_StateDiagram_02.gif)
  
<span data-ttu-id="33e37-198">**図4ヘッダーでパラメーターが検出された場合の、図3からのヘッダー状態の拡張**</span><span class="sxs-lookup"><span data-stu-id="33e37-198">**Figure 4. Expansion of Header state from Figure 3 when a parameter has been encountered in a header**</span></span>

!["Part Headers" 状態の拡張](media/MimeReader_StateDiagram_03.gif)
  
> [!NOTE]
> <span data-ttu-id="33e37-200">図5に示されている状態は、アドレスグループが検出された場合に、グループ内のアドレスを読み取るために[Groupた閲覧](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeAddressReader.GroupRecipientReader.aspx)者のプロパティを使用できます。</span><span class="sxs-lookup"><span data-stu-id="33e37-200">The state represented by Figure 5 is recursive in that, if an address group is encountered, you can use the [GroupRecipientReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeAddressReader.GroupRecipientReader.aspx) property to read the addresses in the group.</span></span> 
  
<span data-ttu-id="33e37-201">**図5アドレスまたはアドレスグループが検出された場合の、図3のヘッダー状態の展開**</span><span class="sxs-lookup"><span data-stu-id="33e37-201">**Figure 5. Expansion of Header state from Figure 3 when an address or address group is encountered**</span></span>

![住所またはグループに対する "Header" 状態の拡張](media/MimeReader_StateDiagram_04.gif)
  
<span data-ttu-id="33e37-203">図6および7は、 [MimeWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeWriter.aspx)オブジェクトの単純化された状態遷移図を示しています。</span><span class="sxs-lookup"><span data-stu-id="33e37-203">Figures 6 and 7 show simplified state transition diagrams for the [MimeWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeWriter.aspx) object.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="33e37-204">図 7 では、図 6 に示した Part Headers 状態を詳しく説明しています。</span><span class="sxs-lookup"><span data-stu-id="33e37-204">Figure 7 expands on the Part Headers state shown in Figure 6.</span></span> 
  
<span data-ttu-id="33e37-205">**図6MimeWriter オブジェクトの簡略化された状態遷移図**</span><span class="sxs-lookup"><span data-stu-id="33e37-205">**Figure 6. Simplified state transition diagram for MimeWriter objects**</span></span>

![MimeWriter 用の状態遷移図](media/MimeWriter_TopLevel.gif)
  
<span data-ttu-id="33e37-207">**図7図6のパーツヘッダー状態の拡張**</span><span class="sxs-lookup"><span data-stu-id="33e37-207">**Figure 7. Expansion of Part Headers state from Figure 6**</span></span>

![MimeWriter 用の状態遷移図拡張機能](media/MimeWriter_Diagram_Expansion.gif)
  
## <a name="textconverters-namespace"></a><span data-ttu-id="33e37-209">TextConverters 名前空間</span><span class="sxs-lookup"><span data-stu-id="33e37-209">TextConverters namespace</span></span>
<span data-ttu-id="33e37-210"><a name="TextConverters"> </a></span><span class="sxs-lookup"><span data-stu-id="33e37-210"><a name="TextConverters"> </a></span></span>

<span data-ttu-id="33e37-211">TextConverters 名前空間には、電子メールメッセージの内容の変換をサポートする型が含まれています。</span><span class="sxs-lookup"><span data-stu-id="33e37-211">The TextConverters namespace contains types that support the conversion of the contents of email messages.</span></span> <span data-ttu-id="33e37-212">これらの型は、コードページの変換、セキュリティで保護されていない HTML の削除、および電子メールメッセージの本文でのその他の変換を実行できます。</span><span class="sxs-lookup"><span data-stu-id="33e37-212">These types can perform code page conversion, remove HTML that is not secure, and perform other transformations on email message bodies.</span></span> <span data-ttu-id="33e37-213">この[名前空間には、](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.aspx) [textconverters](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.TextConverter.aspx)抽象クラスから派生した次のクラスが含まれています。</span><span class="sxs-lookup"><span data-stu-id="33e37-213">The [Microsoft.Exchange.Data.TextConverters](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.aspx) namespace includes the following classes that derive from the [TextConverter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.TextConverter.aspx) abstract class:</span></span> 
  
- [<span data-ttu-id="33e37-214">EnrichedToHtml</span><span class="sxs-lookup"><span data-stu-id="33e37-214">EnrichedToHtml</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.EnrichedToHtml.aspx)
    
- [<span data-ttu-id="33e37-215">EnrichedToText</span><span class="sxs-lookup"><span data-stu-id="33e37-215">EnrichedToText</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.EnrichedToText.aspx)
    
- [<span data-ttu-id="33e37-216">HtmlToEnriched</span><span class="sxs-lookup"><span data-stu-id="33e37-216">HtmlToEnriched</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.HtmlToEnriched.aspx)
    
- [<span data-ttu-id="33e37-217">HtmlToHtml</span><span class="sxs-lookup"><span data-stu-id="33e37-217">HtmlToHtml</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.HtmlToHtml.aspx)
    
- [<span data-ttu-id="33e37-218">HtmlToRtf</span><span class="sxs-lookup"><span data-stu-id="33e37-218">HtmlToRtf</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.HtmlToRtf.aspx)
    
- [<span data-ttu-id="33e37-219">HtmlToText</span><span class="sxs-lookup"><span data-stu-id="33e37-219">HtmlToText</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.HtmlToText.aspx)
    
- [<span data-ttu-id="33e37-220">RtfCompressedToRtf</span><span class="sxs-lookup"><span data-stu-id="33e37-220">RtfCompressedToRtf</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.RtfCompressedToRtf.aspx)
    
- [<span data-ttu-id="33e37-221">RtfToHtml</span><span class="sxs-lookup"><span data-stu-id="33e37-221">RtfToHtml</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.RtfToHtml.aspx)
    
- [<span data-ttu-id="33e37-222">RtfToRtf</span><span class="sxs-lookup"><span data-stu-id="33e37-222">RtfToRtf</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.RtfToRtf.aspx)
    
- [<span data-ttu-id="33e37-223">RtfToRtfCompressed</span><span class="sxs-lookup"><span data-stu-id="33e37-223">RtfToRtfCompressed</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.RtfToRtfCompressed.aspx)
    
- [<span data-ttu-id="33e37-224">RtfToText</span><span class="sxs-lookup"><span data-stu-id="33e37-224">RtfToText</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.RtfToText.aspx)
    
- [<span data-ttu-id="33e37-225">TextToHtml</span><span class="sxs-lookup"><span data-stu-id="33e37-225">TextToHtml</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.TextToHtml.aspx)
    
- [<span data-ttu-id="33e37-226">TextToRtf</span><span class="sxs-lookup"><span data-stu-id="33e37-226">TextToRtf</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.TextToRtf.aspx)
    
- [<span data-ttu-id="33e37-227">TextToText</span><span class="sxs-lookup"><span data-stu-id="33e37-227">TextToText</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.TextToText.aspx)
    
<span data-ttu-id="33e37-228">これらのテキスト コンバーターを使用すると、ドキュメント ストリームの形式を変更したり、HTML ドキュメントから安全でない要素を削除したりできます。</span><span class="sxs-lookup"><span data-stu-id="33e37-228">These text converters enable you to change the format of a document stream or to remove elements that are not secure from an HTML document.</span></span> <span data-ttu-id="33e37-229">これらのクラスは、直接変換を実行するために、 [Textconverter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.TextConverter.aspx)基本クラスの Convert メソッドの1つの呼び出しを使用するか、またはコンバータのコンストラクターに渡すことができます。これは、変換された読み取りまたは書き込みを実行するために使用します。</span><span class="sxs-lookup"><span data-stu-id="33e37-229">These classes can be used by themselves to perform a conversion by using a single call to one of the Convert methods in the [TextConverter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.TextConverter.aspx) base class, or they can be passed to a constructor of the converter, which uses it to perform converted reads or writes.</span></span> 
  
<span data-ttu-id="33e37-230">基底クラスから継承した機能は、元のドキュメントと変換後の出力を保存するための十分な領域がある場合や、変換の結果を保存する必要がある場合の変換を実行する際に役立ちます。</span><span class="sxs-lookup"><span data-stu-id="33e37-230">The functionality inherited from the base class is useful for performing conversions when you have sufficient space to store the original document and its converted output, or when you want to store the results of the conversion.</span></span> <span data-ttu-id="33e37-231">**Convert** メソッドは、入力と出力のストリーム、テキスト リーダー、またはテキスト ライターを受け取り、入力のコンテンツを関連付けられた出力に変換します。</span><span class="sxs-lookup"><span data-stu-id="33e37-231">The **Convert** method takes input and output streams, text readers, or text writers, and converts the content of the input to the associated output.</span></span> 
  
<span data-ttu-id="33e37-232">この名前空間には、次に示すテキスト リーダー、ライター、およびストリームのクラスも含まれています。</span><span class="sxs-lookup"><span data-stu-id="33e37-232">Also included in the namespace are the following text reader, writer, and stream classes:</span></span>
  
- <span data-ttu-id="33e37-233">[コンバーター](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.ConverterReader.aspx) :**システム**から派生したもの。</span><span class="sxs-lookup"><span data-stu-id="33e37-233">[ConverterReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.ConverterReader.aspx) — Derived from **System.IO.TextReader**.</span></span> 
    
- <span data-ttu-id="33e37-234">[コンバーター](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.ConverterWriter.aspx)は、**システム**から派生します。</span><span class="sxs-lookup"><span data-stu-id="33e37-234">[ConverterWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.ConverterWriter.aspx) — Derived from **System.IO.TextWriter**.</span></span> 
    
- <span data-ttu-id="33e37-235">[収束 terstream](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.ConverterStream.aspx) - **system.object から派生します。**</span><span class="sxs-lookup"><span data-stu-id="33e37-235">[ConverterStream](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.ConverterStream.aspx) — Derived from **System.IO.Stream**.</span></span> 
    
<span data-ttu-id="33e37-236">これらは、元のデータや変換後の出力を保存する領域がない場合、ストリームからの入力を受信する場合やストリームに出力を送信する場合、または出力の用途がインデックスの作成や検索のみで変換の結果を保存する必要のない場合の変換を実行するために使用します。</span><span class="sxs-lookup"><span data-stu-id="33e37-236">These are used to perform conversions when you do not have room to store the original or its converted output, when you receive the input from or send the output to a stream, or when you want the output only for indexing or search purposes and therefore do not want to store the result of a conversion.</span></span>
  
## <a name="tnef-namespace"></a><span data-ttu-id="33e37-237">Tnef 名前空間</span><span class="sxs-lookup"><span data-stu-id="33e37-237">Tnef namespace</span></span>
<span data-ttu-id="33e37-238"><a name="TNEF"> </a></span><span class="sxs-lookup"><span data-stu-id="33e37-238"><a name="TNEF"> </a></span></span>

<span data-ttu-id="33e37-p118">Tnef 名前空間には、TNEF データについて順方向専用のストリーム ベースの読み取りおよび書き込みを可能にするクラスと型が含まれています。TNEF とは、MAPI を解釈できないクライアントのために、MAPI のプロパティをカプセル化することを目的として使用されるデータ形式のことです。</span><span class="sxs-lookup"><span data-stu-id="33e37-p118">The Tnef namespace contains classes and types that enable forward-only stream-based reading and writing of TNEF data. TNEF is a data format that is used to encapsulate MAPI properties for clients that cannot interpret MAPI.</span></span>
  
<span data-ttu-id="33e37-241">[TnefReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefReader.aspx)および[TnefWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefWriter.aspx)クラスは、 [ContentTypes](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.aspx)名前空間のコア機能を提供します。</span><span class="sxs-lookup"><span data-stu-id="33e37-241">The [TnefReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefReader.aspx) and [TnefWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefWriter.aspx) classes provide the core functionality in the [Microsoft.Exchange.Data.ContentTypes.Tnef](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.aspx) namespace.</span></span> 
  
<span data-ttu-id="33e37-242">[TnefReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefReader.aspx)クラスは、コンストラクターの引数として、読み取り可能なストリームを受け取ります。</span><span class="sxs-lookup"><span data-stu-id="33e37-242">The [TnefReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefReader.aspx) class takes a readable stream as an argument to its constructors.</span></span> <span data-ttu-id="33e37-243">次に、 [Readnextattribute](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefReader.ReadNextAttribute.aspx)メソッドを使用して、TNEF ストリーム内の属性をシーケンシャルに読み取ります。</span><span class="sxs-lookup"><span data-stu-id="33e37-243">You then use the [ReadNextAttribute](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefReader.ReadNextAttribute.aspx) method to sequentially read the attributes in the TNEF stream.</span></span> <span data-ttu-id="33e37-244">属性を読み取ると、現在のプロパティを読み取る[TnefPropertyReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefPropertyReader.aspx)を取得することに加えて、 [TnefReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefReader.aspx)オブジェクトで読み取り専用のプロパティを使用して、属性に関する情報にアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="33e37-244">After you have read an attribute, you can access information about the attribute by using any of the read-only properties on the [TnefReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefReader.aspx) object, in addition to getting a [TnefPropertyReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefPropertyReader.aspx) to read the current property.</span></span> <span data-ttu-id="33e37-245">[ReadAttributeRawValue](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefReader.ReadAttributeRawValue.aspx)メソッドを使用して、現在の属性に直接アクセスすることもできます。</span><span class="sxs-lookup"><span data-stu-id="33e37-245">You can also directly access the current attribute by using the [ReadAttributeRawValue](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefReader.ReadAttributeRawValue.aspx) method.</span></span> 
  
<span data-ttu-id="33e37-246">[TnefWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefWriter.aspx)クラスは、書き込み可能な[ストリーム](https://msdn.microsoft.com/library/System.IO.Stream.aspx)をコンストラクターの引数として受け取ります。</span><span class="sxs-lookup"><span data-stu-id="33e37-246">The [TnefWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefWriter.aspx) class takes a writable [Stream](https://msdn.microsoft.com/library/System.IO.Stream.aspx) as an argument to its constructors.</span></span> <span data-ttu-id="33e37-247">[TnefWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefWriter.aspx)クラスには、このストリームにデータを書き込む複数の方法が用意されています。</span><span class="sxs-lookup"><span data-stu-id="33e37-247">The [TnefWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefWriter.aspx) class provides multiple ways in which to write data to this stream.</span></span> 
  
## <a name="vcard-namespace"></a><span data-ttu-id="33e37-248">vCard 名前空間</span><span class="sxs-lookup"><span data-stu-id="33e37-248">vCard namespace</span></span>
<span data-ttu-id="33e37-249"><a name="vCard"> </a></span><span class="sxs-lookup"><span data-stu-id="33e37-249"><a name="vCard"> </a></span></span>

<span data-ttu-id="33e37-p121">vCard 名前空間には、vCard データ形式で電子メール メッセージに含まれている連絡先情報を読み書きするために使用するクラス、構造体、および列挙体が含まれています。この名前空間には、電子メール メッセージに関連付けられた vCard データの読み取りを可能にする連絡先リーダーとライター、例外クラス、プロパティ リーダー、パラメーター リーダー、およびサポート用列挙体が含まれています。</span><span class="sxs-lookup"><span data-stu-id="33e37-p121">The vCard namespace contains classes, structures, and enumerations used to read and write contact information contained in an email message that is in the vCard data format. The namespace contains a contact reader and writer, an exception class, a property reader, a parameter reader, and supporting enumerations that allow you to read vCard data associated with an email message.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="33e37-252">関連項目</span><span class="sxs-lookup"><span data-stu-id="33e37-252">See also</span></span>

- [<span data-ttu-id="33e37-253">Exchange のトランスポート エージェント</span><span class="sxs-lookup"><span data-stu-id="33e37-253">Transport agents in Exchange</span></span>](transport-agents-in-exchange-2013.md)  
- [<span data-ttu-id="33e37-254">Exchange 2013 におけるトランスポート エージェントの概念</span><span class="sxs-lookup"><span data-stu-id="33e37-254">Transport agent concepts in Exchange 2013</span></span>](transport-agent-concepts-in-exchange-2013.md) 
- [<span data-ttu-id="33e37-255">Exchange 2013 のトランスポート エージェントのリファレンス</span><span class="sxs-lookup"><span data-stu-id="33e37-255">Transport agent reference for Exchange 2013</span></span>](transport-agent-reference-for-exchange-2013.md)
- [<span data-ttu-id="33e37-256">MIME メディアの種類</span><span class="sxs-lookup"><span data-stu-id="33e37-256">MIME Media Types</span></span>](http://www.iana.org/assignments/media-types)
    

