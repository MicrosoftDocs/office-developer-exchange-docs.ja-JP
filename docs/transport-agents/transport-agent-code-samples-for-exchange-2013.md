---
title: Exchange 2013 のトランスポート エージェントのコード サンプル
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
localization_priority: Normal
ms.assetid: 626345ec-918f-4d91-932f-e6ce92553ccb
description: Exchange 2013 で利用可能なサンプルトランスポートエージェントに関する情報を検索します。
ms.openlocfilehash: c14a4e34102b55014cc6507e375929c186f5f6e9
ms.sourcegitcommit: 88ec988f2bb67c1866d06b361615f3674a24e795
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/31/2020
ms.locfileid: "44461801"
---
# <a name="transport-agent-code-samples-for-exchange-2013"></a><span data-ttu-id="2161b-103">Exchange 2013 のトランスポート エージェントのコード サンプル</span><span class="sxs-lookup"><span data-stu-id="2161b-103">Transport agent code samples for Exchange 2013</span></span>

<span data-ttu-id="2161b-104">Exchange 2013 で利用可能なサンプルトランスポートエージェントに関する情報を検索します。</span><span class="sxs-lookup"><span data-stu-id="2161b-104">Find information about the sample transport agents that are available for Exchange 2013.</span></span>
  
<span data-ttu-id="2161b-105">**製品:** Exchange Server 2013</span><span class="sxs-lookup"><span data-stu-id="2161b-105">**Applies to:** Exchange Server 2013</span></span>
  
<span data-ttu-id="2161b-106">Exchange Server 2013 に含まれる Api を使用して、トランスポート機能を拡張するエージェントを開発できます。</span><span class="sxs-lookup"><span data-stu-id="2161b-106">You can use the APIs that are included in Exchange Server 2013 to develop agents that extend transport functionality.</span></span> <span data-ttu-id="2161b-107">この記事では、トランスポート動作をプログラムによって拡張する方法の学習に利用できるサンプル エージェントに関する情報について説明します。</span><span class="sxs-lookup"><span data-stu-id="2161b-107">This article provides information about the sample agents that are available to help you to learn how to extend transport behavior programmatically.</span></span> <span data-ttu-id="2161b-108">サンプル エージェントには、各コンポーネントのソース コードが含まれています。</span><span class="sxs-lookup"><span data-stu-id="2161b-108">The sample agents include the source code for each component.</span></span> 
  
<span data-ttu-id="2161b-109">次の表に、Exchange 2013 のサンプルエージェントを示します。</span><span class="sxs-lookup"><span data-stu-id="2161b-109">The following table lists the sample agents for Exchange 2013.</span></span>
  
<span data-ttu-id="2161b-110">**表1トランスポートエージェントのサンプル**</span><span class="sxs-lookup"><span data-stu-id="2161b-110">**Table 1. Transport agent samples**</span></span>

|<span data-ttu-id="2161b-111">**サンプルの名前**</span><span class="sxs-lookup"><span data-stu-id="2161b-111">**Sample name**</span></span>|<span data-ttu-id="2161b-112">**説明**</span><span class="sxs-lookup"><span data-stu-id="2161b-112">**Description**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="2161b-113">Exchange 2013: ウイルス対策トランスポートエージェントを構築する</span><span class="sxs-lookup"><span data-stu-id="2161b-113">Exchange 2013: Build an antivirus transport agent</span></span>](https://code.msdn.microsoft.com/Exchange/Exchange-2013-Build-an-6e544269) <br/> |<span data-ttu-id="2161b-114">このエージェントは、 [Onendofdata](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent.OnEndOfData.aspx)および[onsubmittedmessage](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Routing.RoutingAgent.OnSubmittedMessage.aspx)イベントに応答して、メッセージを非同期で調べ、変更されたバージョンを返すプロセス外のサーバーに受信メッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="2161b-114">This agent responds to the [OnEndOfData](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent.OnEndOfData.aspx) and [OnSubmittedMessage](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Routing.RoutingAgent.OnSubmittedMessage.aspx) events and sends the incoming message to an out-of-process server that asynchronously examines the message and returns a modified version.</span></span>  <br/> |
|[<span data-ttu-id="2161b-115">Exchange 2013: 帯域幅ログトランスポートエージェントを構築する</span><span class="sxs-lookup"><span data-stu-id="2161b-115">Exchange 2013: Build a bandwidth logging transport agent</span></span>](https://code.msdn.microsoft.com/Exchange/Exchange-2013-Build-a-d61a4aaa) <br/> |<span data-ttu-id="2161b-116">このエージェントは、 [Onsubmittedmessage](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Routing.RoutingAgent.OnSubmittedMessage.aspx)イベントと[onsubmittedmessage](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Routing.RoutingAgent.OnRoutedMessage.aspx)イベントに応答し、指定された受信者の帯域幅使用状況をキャプチャして、帯域幅使用状況の情報をテキストファイルに記録します。</span><span class="sxs-lookup"><span data-stu-id="2161b-116">This agent responds to the [OnSubmittedMessage](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Routing.RoutingAgent.OnSubmittedMessage.aspx) and [OnRoutedMessage](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Routing.RoutingAgent.OnRoutedMessage.aspx) events, captures bandwidth usage for specified recipients, and logs the bandwidth usage information to a text file.</span></span>  <br/> |
|[<span data-ttu-id="2161b-117">Exchange 2013: 本文変換トランスポートエージェントを構築する</span><span class="sxs-lookup"><span data-stu-id="2161b-117">Exchange 2013: Build a body conversion transport agent</span></span>](https://code.msdn.microsoft.com/Exchange/Exchange-2013-Build-a-body-ed36ecb0) <br/> |<span data-ttu-id="2161b-p102">このエージェントは、着信メッセージの形式を判断し、フィルター処理が必要かどうかを決定することで、電子メール メッセージのスクリプトをフィルターで除去します。フィルター処理が必要になる場合は、コンテンツを HTML に変換し、フィルターを適用してから元の形式に戻します。</span><span class="sxs-lookup"><span data-stu-id="2161b-p102">This agent filters scripts out of email messages by determining the format of the incoming message and deciding if filtering must occur. If filtering is needed, the content is converted to HTML, filtered, and then converted back to the source format.</span></span>  <br/> |
|[<span data-ttu-id="2161b-120">Exchange 2013: SMTP ログトランスポートエージェントを作成する</span><span class="sxs-lookup"><span data-stu-id="2161b-120">Exchange 2013: Build an SMTP logging transport agent</span></span>](https://code.msdn.microsoft.com/Exchange/Exchange-2013-Build-an-fc23dc33) <br/> |<span data-ttu-id="2161b-121">このエージェントは[Onendofdata](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent.OnEndOfData.aspx)イベントに応答し、ローカルハードディスク上のファイルにメッセージを非同期的に記録します。</span><span class="sxs-lookup"><span data-stu-id="2161b-121">This agent responds to the [OnEndOfData](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent.OnEndOfData.aspx) event, and asynchronously logs the message to a file on the local hard disk.</span></span>  <br/> |
|[<span data-ttu-id="2161b-122">Exchange 2013: 送信者を一時的にブロックするトランスポートエージェントを構築する</span><span class="sxs-lookup"><span data-stu-id="2161b-122">Exchange 2013: Build a transport agent that blocks senders temporarily</span></span>](https://code.msdn.microsoft.com/Exchange/Exchange-2013-Build-a-52a767d8) <br/> |<span data-ttu-id="2161b-123">このエージェントは、 [Onendofheaders](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent.OnEndOfHeaders.aspx)および[Onrcptcommand](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent.OnRcptCommand.aspx)イベントに応答し、メッセージの送信者が以前にフロントエンドトランスポートサービスにメッセージを送信したかどうかを判断します。</span><span class="sxs-lookup"><span data-stu-id="2161b-123">This agent responds to the [OnEndOfHeaders](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent.OnEndOfHeaders.aspx) and [OnRcptCommand](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent.OnRcptCommand.aspx) events and determines whether the message sender has previously sent messages to the Front End Transport service.</span></span> <span data-ttu-id="2161b-124">送信者が以前にメッセージをフロント エンド トランスポート サービスに送信していない場合、その送信者は送信者のリストに追加され、メッセージは拒否され、クライアントには後で再試行するように通知する応答が返されます (グレイリスト方式とも呼ばれます)。</span><span class="sxs-lookup"><span data-stu-id="2161b-124">If the sender has not previously sent a message to the Front End Transport service, the sender is added to a list of senders, and the message is rejected with a response that tells the client to try again later (also known as graylisting).</span></span> <span data-ttu-id="2161b-125">送信者が以前の送信者のリストに含まれている場合は、エージェントがメッセージを拒否することはありません。</span><span class="sxs-lookup"><span data-stu-id="2161b-125">If the sender is in the list of previous senders, the agent does not reject the message.</span></span>  <br/> |
|[<span data-ttu-id="2161b-126">Exchange 2013: メールボックスサーバーログトランスポートエージェントを構築する</span><span class="sxs-lookup"><span data-stu-id="2161b-126">Exchange 2013: Build a Mailbox server logging transport agent</span></span>](https://code.msdn.microsoft.com/Exchange/Exchange-2013-Build-a-fc8632e5) <br/> |<span data-ttu-id="2161b-127">このエージェントは、 [Onルーブル tedmessage](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Routing.RoutingAgent.OnRoutedMessage.aspx) transport pipeline イベントに応答し、メッセージをローカルハードディスク上のファイルに同期的に記録します。</span><span class="sxs-lookup"><span data-stu-id="2161b-127">This agent responds to the [OnRoutedMessage](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Routing.RoutingAgent.OnRoutedMessage.aspx) transport pipeline event and synchronously logs the message to a file on the local hard disk.</span></span>  <br/> |
|[<span data-ttu-id="2161b-128">Exchange 2013: X ヘッダートランスポートエージェントを構築する</span><span class="sxs-lookup"><span data-stu-id="2161b-128">Exchange 2013: Build an X-header transport agent</span></span>](https://code.msdn.microsoft.com/Exchange/Exchange-2013-Build-an-32f62f5a) <br/> |<span data-ttu-id="2161b-129">このエージェントは、 [Onendofheaders](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent.OnEndOfHeaders.aspx)イベントに応答し、メッセージ内の X ヘッダーを読み取りおよび変更します。</span><span class="sxs-lookup"><span data-stu-id="2161b-129">This agent responds to the [OnEndOfHeaders](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent.OnEndOfHeaders.aspx) event and read and modify X-headers in messages.</span></span>  <br/> |
   
## <a name="see-also"></a><span data-ttu-id="2161b-130">関連項目</span><span class="sxs-lookup"><span data-stu-id="2161b-130">See also</span></span>

- [<span data-ttu-id="2161b-131">Exchange 2013 におけるトランスポート エージェントの概念</span><span class="sxs-lookup"><span data-stu-id="2161b-131">Transport agent concepts in Exchange 2013</span></span>](transport-agent-concepts-in-exchange-2013.md)    
- [<span data-ttu-id="2161b-132">Exchange 2013 のトランスポート エージェントのリファレンス</span><span class="sxs-lookup"><span data-stu-id="2161b-132">Transport agent reference for Exchange 2013</span></span>](transport-agent-reference-for-exchange-2013.md)    
- [<span data-ttu-id="2161b-133">Exchange 2013 用の RoutingAgent トランスポートエージェントの作成</span><span class="sxs-lookup"><span data-stu-id="2161b-133">Create a RoutingAgent transport agent for Exchange 2013</span></span>](how-to-create-a-routingagent-transport-agent-for-exchange-2013.md)   
- [<span data-ttu-id="2161b-134">Exchange 2013 用の SmtpReceiveAgent トランスポートエージェントを作成する</span><span class="sxs-lookup"><span data-stu-id="2161b-134">Create an SmtpReceiveAgent transport agent for Exchange 2013</span></span>](how-to-create-an-smtpreceiveagent-transport-agent-for-exchange-2013.md)    
- [<span data-ttu-id="2161b-135">Exchange 2013 用の DeliveryAgent トランスポートエージェントの作成</span><span class="sxs-lookup"><span data-stu-id="2161b-135">Create a DeliveryAgent transport agent for Exchange 2013</span></span>](how-to-create-a-deliveryagent-transport-agent-for-exchange-2013.md)
    

