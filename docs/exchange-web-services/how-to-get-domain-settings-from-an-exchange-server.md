---
title: Exchange サーバーからドメインの設定を取得します。
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: 2f9acb81-5135-4f72-94e8-65c235d725e6
description: 自動検出サービスを使用して Exchange サーバーからドメインの設定を取得する方法について説明します。
ms.openlocfilehash: 0dd990cc82762936e7827115685ce0178eafb5ae
ms.sourcegitcommit: 34041125dc8c5f993b21cebfc4f8b72f0fd2cb6f
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/11/2018
ms.locfileid: "19758954"
---
# <a name="get-domain-settings-from-an-exchange-server"></a><span data-ttu-id="65a81-103">Exchange サーバーからドメインの設定を取得します。</span><span class="sxs-lookup"><span data-stu-id="65a81-103">Get domain settings from an Exchange server</span></span>

<span data-ttu-id="65a81-104">自動検出サービスを使用して Exchange サーバーからドメインの設定を取得する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="65a81-104">Learn how to get domain settings from an Exchange server by using the Autodiscover service.</span></span>
  
<span data-ttu-id="65a81-p101">自動検出サービスを使用して、メール ドメインの構成情報を取得できます。自動検出サービスは、アプリケーションが特定のドメインの正しいサービス エンドポイントに接続するためのプロセスを提供します。</span><span class="sxs-lookup"><span data-stu-id="65a81-p101">You can retrieve configuration information for an email domain by using the Autodiscover service. The Autodiscover service provides your application with a process for connecting to the correct service endpoint for a specific domain.</span></span>
  
<span data-ttu-id="65a81-107">自動検出サービスにアクセスするには、次の開発テクノロジのうちのいずれかを使用できます。</span><span class="sxs-lookup"><span data-stu-id="65a81-107">You can use one of the following development technologies to access the Autodiscover service:</span></span>
  
- <span data-ttu-id="65a81-108">Exchange Web サービス (EWS) マネージ API</span><span class="sxs-lookup"><span data-stu-id="65a81-108">The Exchange Web Services (EWS) Managed API</span></span>
    
- <span data-ttu-id="65a81-109">EWS</span><span class="sxs-lookup"><span data-stu-id="65a81-109">EWS</span></span>
    
    <span data-ttu-id="65a81-110">EWS を使用する場合は、次の方法を使用してユーザー設定を取得できます。</span><span class="sxs-lookup"><span data-stu-id="65a81-110">If you are using EWS, you can use the following methods to retrieve user settings:</span></span>
    
  - <span data-ttu-id="65a81-111">SOAP ベースの自動検出サービス</span><span class="sxs-lookup"><span data-stu-id="65a81-111">The SOAP-based Autodiscover service</span></span>
    
  - <span data-ttu-id="65a81-112">XML (POX) 自動検出サービス</span><span class="sxs-lookup"><span data-stu-id="65a81-112">The XML (POX) Autodiscover service</span></span>
    
  - <span data-ttu-id="65a81-113">SOAP または XML の自動検出サービスから生成される、自動生成されたプロキシ</span><span class="sxs-lookup"><span data-stu-id="65a81-113">An autogenerated proxy generated from the SOAP or XML Autodiscover service</span></span>
    
    <span data-ttu-id="65a81-114">これらのメソッドの詳細については、 [Exchange の自動検出](autodiscover-for-exchange.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="65a81-114">For more information about these methods, see [Autodiscover for Exchange](autodiscover-for-exchange.md).</span></span>
    
<span data-ttu-id="65a81-p102">EWS マネージ API は、ユーザー設定を取得するためのオブジェクト ベースのインターフェイスを提供します。クライアント アプリケーションがマネージ コードを使用する場合は、EWS マネージ API を使用することをお勧めします。EWS マネージ API インターフェイスは、標準的な自動生成された Web サービス プロキシよりも、単純なオブジェクト モデルに対してより最適化されています。 </span><span class="sxs-lookup"><span data-stu-id="65a81-p102">The EWS Managed API provides an object-based interface for retrieving user settings. If your client application uses managed code, we recommend that you use the EWS Managed API. The EWS Managed API interface is better optimized for a simple object model than the typical autogenerated web service proxy.</span></span> 
  
<span data-ttu-id="65a81-118">EWS を使用している場合は、POX の自動検出サービスよりも豊富な機能をサポートしている SOAP の自動検出サービスの使用をお勧めします。</span><span class="sxs-lookup"><span data-stu-id="65a81-118">If you are using EWS, we suggest that you use the SOAP Autodiscover service, because it supports a richer set of features than the POX Autodiscover service.</span></span>
  
<span data-ttu-id="65a81-p103">自動検出サービスは、要求された構成設定のみを返します。次の表に、自動検出サービスが返すことができるドメインの構成設定の一覧を示します。</span><span class="sxs-lookup"><span data-stu-id="65a81-p103">The Autodiscover service returns only the requested configuration settings. The following table lists the domain configuration settings that the Autodiscover service can return.</span></span>
  
<span data-ttu-id="65a81-121">**表 1: ドメインの構成設定**</span><span class="sxs-lookup"><span data-stu-id="65a81-121">**Table 1: Domain configuration settings**</span></span>

|<span data-ttu-id="65a81-122">**構成の設定**</span><span class="sxs-lookup"><span data-stu-id="65a81-122">**Configuration setting**</span></span>|<span data-ttu-id="65a81-123">**説明**</span><span class="sxs-lookup"><span data-stu-id="65a81-123">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="65a81-124">ExternalEwsUrl</span><span class="sxs-lookup"><span data-stu-id="65a81-124">ExternalEwsUrl</span></span>  <br/> |<span data-ttu-id="65a81-125">EWS の外部 URL。</span><span class="sxs-lookup"><span data-stu-id="65a81-125">The external URL for EWS.</span></span>  <br/> |
|<span data-ttu-id="65a81-126">ExternalEwsVersion</span><span class="sxs-lookup"><span data-stu-id="65a81-126">ExternalEwsVersion</span></span>  <br/> |<span data-ttu-id="65a81-127">EWS URL をホストする Exchange Server のバージョン。</span><span class="sxs-lookup"><span data-stu-id="65a81-127">The version of the Exchange server that hosts the EWS URL.</span></span>  <br/> |
   
## <a name="prerequisites-for-getting-domain-settings"></a><span data-ttu-id="65a81-128">ドメインの設定を取得するための前提条件</span><span class="sxs-lookup"><span data-stu-id="65a81-128">Prerequisites for getting domain settings</span></span>
<span data-ttu-id="65a81-129"><a name="bk_Prereq"> </a></span><span class="sxs-lookup"><span data-stu-id="65a81-129"></span></span>

<span data-ttu-id="65a81-130">ドメインの設定を取得するために自動検出サービスに接続するアプリケーションを作成する前に、次にアクセスできることを確認します。</span><span class="sxs-lookup"><span data-stu-id="65a81-130">Before you create an application that connects to the Autodiscover service to get domain settings, make sure that you have access to the following:</span></span>
  
- <span data-ttu-id="65a81-p104">Exchange Online、Office 365 の一部としての Exchange Online、または Exchange 2007 以降のバージョンの Exchange を実行しているサーバー。EWS SOAP ベースの自動検出サービスを使用する場合は、Exchange 2010 以降のバージョンの Exchange を実行しているサーバー。</span><span class="sxs-lookup"><span data-stu-id="65a81-p104">Exchange Online, Exchange Online as part of Office 365, or a server running a version of Exchange starting with Exchange 2007. If you are using the EWS SOAP-based Autodiscover service, a server running a version of Exchange starting with Exchange 2010.</span></span>
    
- <span data-ttu-id="65a81-133">クライアント アプリケーションからの接続を受け付けるように構成されている Exchange サーバーです。</span><span class="sxs-lookup"><span data-stu-id="65a81-133">An Exchange server that is configured to accept connections from your client application.</span></span> <span data-ttu-id="65a81-134">Exchange サーバーを構成する方法の詳細については、 [Exchange クライアント アプリケーションの EWS へのアクセスを制御する](controlling-client-application-access-to-ews-in-exchange.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="65a81-134">For information about how to configure your Exchange server, see [Controlling client application access to EWS in Exchange](controlling-client-application-access-to-ews-in-exchange.md).</span></span>
    
- <span data-ttu-id="65a81-135">EWS を使用する権限を持つアカウントです。</span><span class="sxs-lookup"><span data-stu-id="65a81-135">An account that is authorized to use EWS.</span></span> <span data-ttu-id="65a81-136">アカウントを構成する方法の詳細については、 [Exchange クライアント アプリケーションの EWS へのアクセスを制御する](controlling-client-application-access-to-ews-in-exchange.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="65a81-136">For information about how to configure an account, see [Controlling client application access to EWS in Exchange](controlling-client-application-access-to-ews-in-exchange.md).</span></span>
    
> [!NOTE]
> <span data-ttu-id="65a81-137">EWS のマネージ API を使用する場合は、状況によっては証明書の検証コールバックを入力しなければなりません。</span><span class="sxs-lookup"><span data-stu-id="65a81-137">If you are using the EWS Managed API, you must provide a certificate validation callback in some circumstances.</span></span> <span data-ttu-id="65a81-138">Visual Studio によって作成されたものなどのいくつかのライブラリの生成されたプロキシで証明書の検証コールバックを必要することもあります。</span><span class="sxs-lookup"><span data-stu-id="65a81-138">You may also need a certificate validation callback with some generated proxy libraries, such as those created by Visual Studio.</span></span> <span data-ttu-id="65a81-139">詳細については、 [EWS のマネージ API のサーバー証明書の検証](how-to-validate-a-server-certificate-for-the-ews-managed-api.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="65a81-139">For more information, see [Validate a server certificate for the EWS Managed API](how-to-validate-a-server-certificate-for-the-ews-managed-api.md).</span></span> 
  
### <a name="core-concepts-for-getting-domain-settings"></a><span data-ttu-id="65a81-140">ドメインの設定の取得に関する中心概念</span><span class="sxs-lookup"><span data-stu-id="65a81-140">Core concepts for getting domain settings</span></span>
<span data-ttu-id="65a81-141"><a name="bk_Core"> </a></span><span class="sxs-lookup"><span data-stu-id="65a81-141"></span></span>

<span data-ttu-id="65a81-142">自動検出を使用してドメインの設定を取得する前に、次の表に一覧表示されている概念を理解する必要があります。</span><span class="sxs-lookup"><span data-stu-id="65a81-142">Before you use Autodiscover to get domain settings, you should be familiar with the concepts listed in the following table.</span></span>
  
|<span data-ttu-id="65a81-143">**概念**</span><span class="sxs-lookup"><span data-stu-id="65a81-143">**Concept**</span></span>|<span data-ttu-id="65a81-144">**説明**</span><span class="sxs-lookup"><span data-stu-id="65a81-144">**Description**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="65a81-145">Exchange の自動検出</span><span class="sxs-lookup"><span data-stu-id="65a81-145">Autodiscover for Exchange</span></span>](autodiscover-for-exchange.md) <br/> |<span data-ttu-id="65a81-146">自動検出サービスの動作方法の概要を示します。</span><span class="sxs-lookup"><span data-stu-id="65a81-146">Provides an overview of how the Autodiscover service works.</span></span>  <br/> |
|[<span data-ttu-id="65a81-147">自動検出を使用してコネクション ポイントを検索するには</span><span class="sxs-lookup"><span data-stu-id="65a81-147">Use Autodiscover to find connection points</span></span>](how-to-use-autodiscover-to-find-connection-points.md) <br/> |<span data-ttu-id="65a81-148">クライアント アプリケーションを適切なサービス エンドポイントにリダイレクトするために自動検出サービスによって使用されるプロセスについて説明します。</span><span class="sxs-lookup"><span data-stu-id="65a81-148">Describes the process used by the Autodiscover service to redirect your client application to the correct service endpoint.</span></span>  <br/> |
   
<span data-ttu-id="65a81-149">EWS のマネージ API を使用する場合、 [Microsoft.Exchange.WebServices.Data](http://msdn.microsoft.com/en-us/library/exchange/dd633907%28v=exchg.80%29.aspx)名前空間の EWS への接続を管理する[Microsoft.Exchange.WebServices.Data.ExchangeService](http://msdn.microsoft.com/en-us/library/exchange/dd635811%28v=exchg.80%29.aspx)クラスを使用します。</span><span class="sxs-lookup"><span data-stu-id="65a81-149">If you are using the EWS Managed API, you use the [Microsoft.Exchange.WebServices.Data.ExchangeService](http://msdn.microsoft.com/en-us/library/exchange/dd635811%28v=exchg.80%29.aspx) class in the [Microsoft.Exchange.WebServices.Data](http://msdn.microsoft.com/en-us/library/exchange/dd633907%28v=exchg.80%29.aspx) namespace to manage your connection to EWS.</span></span> <span data-ttu-id="65a81-150">このセクションのコード例では、コードでは、次の名前空間を参照することを前提としています。</span><span class="sxs-lookup"><span data-stu-id="65a81-150">The code examples in this section assume that you reference the following namespaces in your code:</span></span> 
  
- <span data-ttu-id="65a81-151">**System.Net**</span><span class="sxs-lookup"><span data-stu-id="65a81-151">**System.Net**</span></span>
    
- <span data-ttu-id="65a81-152">**Microsoft.Exchange.WebServices.Data.ExchangeService**</span><span class="sxs-lookup"><span data-stu-id="65a81-152">**Microsoft.Exchange.WebServices.Data.ExchangeService**</span></span>
    
## <a name="get-domain-settings-by-using-the-ews-managed-api"></a><span data-ttu-id="65a81-153">EWS マネージ API を使用して、ドメインの設定を取得する</span><span class="sxs-lookup"><span data-stu-id="65a81-153">Get domain settings by using the EWS Managed API</span></span>
<span data-ttu-id="65a81-154"><a name="bk_Managed"> </a></span><span class="sxs-lookup"><span data-stu-id="65a81-154"></span></span>

<span data-ttu-id="65a81-155">要求を生成するのに[Microsoft.Exchange.WebServices.Data.AutodiscoverService](http://msdn.microsoft.com/en-us/library/exchange/dd634321%28v=exchg.80%29.aspx)オブジェクトの[Microsoft.Exchange.WebServices.Data.AutodiscoverSettings.GetUserSettings](http://msdn.microsoft.com/en-us/library/exchange/microsoft.exchange.webservices.autodiscover.autodiscoverservice.getusersettings%28v=exchg.80%29.aspx)メソッドを使用するには、EWS のマネージ API を使用する場合次の例のように、ドメインの構成情報を取得したとします。</span><span class="sxs-lookup"><span data-stu-id="65a81-155">If you are using the EWS Managed API, you can use the [Microsoft.Exchange.WebServices.Data.AutodiscoverSettings.GetUserSettings](http://msdn.microsoft.com/en-us/library/exchange/microsoft.exchange.webservices.autodiscover.autodiscoverservice.getusersettings%28v=exchg.80%29.aspx) method of the [Microsoft.Exchange.WebServices.Data.AutodiscoverService](http://msdn.microsoft.com/en-us/library/exchange/dd634321%28v=exchg.80%29.aspx) object to generate the request that retrieves configuration information for a domain, as shown in the following example.</span></span> <span data-ttu-id="65a81-156">この例では、使用可能なドメインの設定の一部だけを要求すると、およびサーバーから要求された設定のみが返されます。</span><span class="sxs-lookup"><span data-stu-id="65a81-156">In this example, only some of the possible domain settings are requested, and only the requested settings are returned from the server.</span></span> 
  
```cs
AutodiscoverService autodiscoverService = new AutodiscoverService("domain.contoso.com");
autodiscoverService.Credentials = new NetworkCredential("User1", "password", "domain.contoso.com");
// Submit a request and get the settings. The response contains only the
// settings that are requested, if they exist.
GetDomainSettingsResponse domainresponse = autodiscoverService.GetDomainSettings(
    "domain",
    ExchangeVersion.Exchang2013,
    DomainSettingName.ExternalEwsUrl,
    DomainSettingName.ExternalEwsVersion);
```

<span data-ttu-id="65a81-p110">返されたコレクションを解析して、各キー/値ペアにアクセスできます。次の使用例は、返された各要素を解析し、各キー/値ペアの名前と値を表示する方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="65a81-p110">You can parse the collection returned to access each key/value pair. The following example shows how to parse through each returned element and display the name and value of each key/value pair.</span></span>
  
```cs
// Display each retrieved value. The settings are part of a key/value pair.
foreach (KeyValuePair<DomainSettingName, Object> domainsetting in domainresponse.Settings)
{
    Console.WriteLine(domainsetting.Key.ToString() + ": " + domainsetting.Value.ToString());
}
```

<span data-ttu-id="65a81-159">または、特定の設定の値を取得できます。</span><span class="sxs-lookup"><span data-stu-id="65a81-159">Alternatively, you can obtain the value of a specific setting.</span></span> <span data-ttu-id="65a81-160">次の例では、 **ExternalEwsUrl**の設定、表示されます。</span><span class="sxs-lookup"><span data-stu-id="65a81-160">In the following example, the **ExternalEwsUrl** setting is to be displayed.</span></span> 
  
```cs
// Display a specific setting, such as ExternalEwsUrl.
Console.WriteLine(domainresponse.Settings[DomainSettingName.ExternalEwsUrl]);
```

## <a name="get-user-settings-by-using-ews-soap-autodiscover"></a><span data-ttu-id="65a81-161">EWS SOAP 自動検出を使用してユーザー設定を取得する</span><span class="sxs-lookup"><span data-stu-id="65a81-161">Get user settings by using EWS SOAP Autodiscover</span></span>
<span data-ttu-id="65a81-162"><a name="bk_SOAP"> </a></span><span class="sxs-lookup"><span data-stu-id="65a81-162"></span></span>

<span data-ttu-id="65a81-163">次の例では、自動検出サービスから両方のドメインの設定を取得する SOAP XML 要求を示しています。</span><span class="sxs-lookup"><span data-stu-id="65a81-163">The following example shows a SOAP XML request to get both domain settings from the Autodiscover service.</span></span>
  
```XML
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:a="http://schemas.microsoft.com/exchange/2010/Autodiscover" 
        xmlns:wsa="http://www.w3.org/2005/08/addressing" 
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
        xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
  <soap:Header>
    <a:RequestedServerVersion>Exchange2013</a:RequestedServerVersion>
    <wsa:Action>http://schemas.microsoft.com/exchange/2010/Autodiscover/Autodiscover/GetDomainSettings</wsa:Action>
    <wsa:To>https://autodiscover.exchange.microsoft.com/autodiscover/autodiscover.svc</wsa:To>
  </soap:Header>
  <soap:Body>
    <a:GetDomainSettingsRequestMessage xmlns:a="http://schemas.microsoft.com/exchange/2010/Autodiscover">
      <a:Request>
        <a:Domains>
          <a:Domain>domain</a:Domain>
        </a:Domains>
        <a:RequestedSettings>
          <a:Setting>ExternalEwsUrl</a:Setting>
          <a:Setting>ExternalEwsVersion</a:Setting>
        </a:RequestedSettings>
        <a:RequestedVersion>Exchange2013</a:RequestedVersion>
      </a:Request>
    </a:GetDomainSettingsRequestMessage>
  </soap:Body>
</soap:Envelope>
```

<span data-ttu-id="65a81-164">次の例では、サーバーがクライアントからの要求を解析した後に返す XML 応答を示します。</span><span class="sxs-lookup"><span data-stu-id="65a81-164">The following example shows the XML response that is returned by the server after it parses the request from the client.</span></span>
  
```XML
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/" 
        xmlns:a="http://www.w3.org/2005/08/addressing">
  <s:Header>
    <a:Action s:mustUnderstand="1">http://schemas.microsoft.com/exchange/2010/
          Autodiscover/Autodiscover/GetDomainSettingsResponse</a:Action>
    <h:ServerVersionInfo xmlns:h="http://schemas.microsoft.com/exchange/2010/Autodiscover" 
          xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
      <h:MajorVersion>15</h:MajorVersion>
      <h:MinorVersion>0</h:MinorVersion>
      <h:MajorBuildNumber>160</h:MajorBuildNumber>
      <h:MinorBuildNumber>4</h:MinorBuildNumber>
      <h:Version>Exchange2013</h:Version>
    </h:ServerVersionInfo>
  </s:Header>
  <s:Body>
    <GetDomainSettingsResponseMessage xmlns="http://schemas.microsoft.com/exchange/2010/Autodiscover">
      <Response xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
        <ErrorCode>NoError</ErrorCode>
        <ErrorMessage />
        <DomainResponses>
          <DomainResponse>
            <ErrorCode>NoError</ErrorCode>
            <ErrorMessage>No error.</ErrorMessage>
            <DomainSettingErrors />
            <DomainSettings>
              <DomainSetting i:type="DomainStringSetting">
                <Name>ExternalEwsUrl</Name>
                <Value>https://failover.exchange.microsoft.com/ews/exchange.asmx</Value>
              </DomainSetting>
              <DomainSetting i:type="DomainStringSetting">
                <Name>ExternalEwsVersion</Name>
                <Value>15.00.0085.000</Value>
              </DomainSetting>
            </DomainSettings>
            <RedirectTarget i:nil="true" />
          </DomainResponse>
        </DomainResponses>
      </Response>
    </GetDomainSettingsResponseMessage>
  </s:Body>
</s:Envelope>
```

## <a name="next-steps"></a><span data-ttu-id="65a81-165">次の手順</span><span class="sxs-lookup"><span data-stu-id="65a81-165">Next steps</span></span>
<span data-ttu-id="65a81-166"><a name="bk_Next"> </a></span><span class="sxs-lookup"><span data-stu-id="65a81-166"></span></span>

<span data-ttu-id="65a81-p112">ドメインの設定は、EWS に接続するときにクライアントが必要とする基本的な情報を提供します。この情報を使用して EWS に接続するか、またはサーバーからメール アカウントの追加の構成設定を取得することができます。詳細については、以下の記事をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="65a81-p112">Domain settings provide the basic information that your client needs to connect to EWS. You can use this information to connect to EWS, or you can retrieve additional configuration settings for an email account from the server. For more information, see the following article:</span></span>
  
- [<span data-ttu-id="65a81-170">Exchange から自動検出を使用してユーザー設定を取得します。</span><span class="sxs-lookup"><span data-stu-id="65a81-170">Get user settings from Exchange by using Autodiscover</span></span>](how-to-get-user-settings-from-exchange-by-using-autodiscover.md)
    
## <a name="see-also"></a><span data-ttu-id="65a81-171">関連項目</span><span class="sxs-lookup"><span data-stu-id="65a81-171">See also</span></span>


- [<span data-ttu-id="65a81-172">EWS アプリケーションを設定します。</span><span class="sxs-lookup"><span data-stu-id="65a81-172">Setting up your EWS application</span></span>](setting-up-your-ews-application.md)
    
- [<span data-ttu-id="65a81-173">Exchange の自動検出 web サービスの参照</span><span class="sxs-lookup"><span data-stu-id="65a81-173">Autodiscover web service reference for Exchange</span></span>](http://msdn.microsoft.com/library/a01124a8-a8cf-4b80-8625-d7ee05690bca%28Office.15%29.aspx)
    
- <span data-ttu-id="65a81-174">
  [Exchange 用 EWS リファレンス](http://msdn.microsoft.com/library/2a873474-1bb2-4cb1-a556-40e8c4159f4a%28Office.15%29.aspx)</span><span class="sxs-lookup"><span data-stu-id="65a81-174">[EWS reference for Exchange](http://msdn.microsoft.com/library/2a873474-1bb2-4cb1-a556-40e8c4159f4a%28Office.15%29.aspx)</span></span>
    

