---
title: Exchange での代理人アクセスと EWS
manager: sethgros
ms.date: 03/9/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: 240d1776-7adc-46cd-9099-88ffeba0a8aa
description: Exchange の EWS マネージ API と EWS を使用してユーザーのメールボックスに代理人アクセスできるようにする方法を説明します。
ms.openlocfilehash: 0416ed1889a7c235a35cb49290d39d3ccfc28c49
ms.sourcegitcommit: 34041125dc8c5f993b21cebfc4f8b72f0fd2cb6f
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/25/2018
ms.locfileid: "19758896"
---
# <a name="delegate-access-and-ews-in-exchange"></a><span data-ttu-id="3b301-103">Exchange での代理人アクセスと EWS</span><span class="sxs-lookup"><span data-stu-id="3b301-103">Delegate access and EWS in Exchange</span></span>

<span data-ttu-id="3b301-104">Exchange の EWS マネージ API と EWS を使用してユーザーのメールボックスに代理人アクセスできるようにする方法を説明します。</span><span class="sxs-lookup"><span data-stu-id="3b301-104">Find out how to use the EWS Managed API and EWS in Exchange to provide delegate access to users' mailboxes.</span></span>
  
<span data-ttu-id="3b301-105">ユーザーが他のユーザーのメールボックスにアクセスできるようにするには、次の 3 つの方法のいずれかを使用できます。 </span><span class="sxs-lookup"><span data-stu-id="3b301-105">You can enable users to access other users' mailboxes in one of three ways:</span></span> 
  
- <span data-ttu-id="3b301-106">代理人を追加し、各代理人にアクセス許可を指定します。</span><span class="sxs-lookup"><span data-stu-id="3b301-106">By adding delegates and specifying permissions for each delegate.</span></span>
    
- <span data-ttu-id="3b301-107">フォルダーのアクセス許可を直接変更します。</span><span class="sxs-lookup"><span data-stu-id="3b301-107">By modifying folder permissions directly.</span></span>
    
- <span data-ttu-id="3b301-108">偽装を使用します。</span><span class="sxs-lookup"><span data-stu-id="3b301-108">By using impersonation.</span></span>
    
<span data-ttu-id="3b301-p101">委任、およびフォルダーのアクセス許可は、各メールボックスに個別にアクセス許可を追加する必要があるため、少数のユーザーにのみアクセス許可を付与する場合に最適です。偽装は、1 つのサービス アカウントによるデータベース内のすべてのメールボックスへのアクセスを簡単に許可できるため、多数のメールボックスを処理するときに最適です。図 1 は、各種のアクセスの相違点を示しています。</span><span class="sxs-lookup"><span data-stu-id="3b301-p101">Delegation and folder permissions are best when you're only granting access to a few users, because you have to add permissions individually to each mailbox. Impersonation is the best choice when you're dealing with quantities of mailboxes, because you can easily enable one service account to access every mailbox in a database. Figure 1 shows some of the differences between each type of access.</span></span>
  
<span data-ttu-id="3b301-112">**図 1. 他のユーザーのメールボックスにアクセスする方法**</span><span class="sxs-lookup"><span data-stu-id="3b301-112">**Figure 1. Ways to access other users' mailboxes**</span></span>

![メールボックスのアクセス タイプ、各タイプのメールボックス所有者と代理人の関係、およびアクセス許可のタイプを示す図。委任用のアクセス許可またはフォルダー アクセス許可のために送信します。偽装のためのアクセス許可として送信します。](media/Ex15_Delegate_Overview.png)
  
<span data-ttu-id="3b301-116">メールを送信するか、会議をスケジュールする際に、代理人得ることができます「代理送信」のアクセス許可では、電子メールまたは代理人から送信された会議出席依頼の受信者が表示されます「*を委任する**メールボックス所有者*の代理」としているため、receive Outlook の電子メールや会議出席依頼します。</span><span class="sxs-lookup"><span data-stu-id="3b301-116">When it comes to sending mail or scheduling meetings, delegates can be given "send on behalf of" permissions, so the recipient of an email or a meeting request that was sent by a delegate will see " *delegate*  on behalf of  *mailbox owner*  " when they receive the email or meeting request in Outlook.</span></span> <span data-ttu-id="3b301-117">「代理送信」のテキストを含むクライアント実装の詳細では、"from"と「送信者」を使用して作成することができます値です。</span><span class="sxs-lookup"><span data-stu-id="3b301-117">Including the "send on behalf of" text is a client implementation detail - and can be created by using the "from" and "sender" values.</span></span> <span data-ttu-id="3b301-118">「から」値は、メールボックスの所有者を示すし、「送信者」の値は、メールを送信する代理人を示します。</span><span class="sxs-lookup"><span data-stu-id="3b301-118">The "from" value indicates the mailbox owner, and the "sender" value indicates the delegate that sent the mail.</span></span> <span data-ttu-id="3b301-119">ユーザーを偽装して、サービス アカウントに電子メールを送信、メールボックスの所有者の会議をスケジュールする場合、メッセージ「として送信されます」メールボックスの所有者。</span><span class="sxs-lookup"><span data-stu-id="3b301-119">If a service account impersonating a user sends an email or schedules a meeting for the mailbox owner, the message is "sent as" the mailbox owner.</span></span> <span data-ttu-id="3b301-120">サービス アカウントによって送信されたメールであることを受信者が確認する手段はありません。</span><span class="sxs-lookup"><span data-stu-id="3b301-120">There is no way for the recipient to know the mail was sent by the service account.</span></span> <span data-ttu-id="3b301-121">フォルダーのアクセス許可を付与し、代理アクセス権がないユーザーは、「送信者」または「代理送信」メールボックスの所有者のことではできません。</span><span class="sxs-lookup"><span data-stu-id="3b301-121">Users who are granted folder permissions and not delegate access are not able to "send as" or "send on behalf of" of a mailbox owner.</span></span> <span data-ttu-id="3b301-122">メールボックスのフォルダーにアクセス権を持つ、フォルダーにアイテムを作成できる場合がありますが、アイテムを送信することはできません。</span><span class="sxs-lookup"><span data-stu-id="3b301-122">They have access to the mailbox folders, and might be able to create items in the folders, but they cannot send the items.</span></span> 
  
<span data-ttu-id="3b301-123">まだそのフォルダーのアクセス許可を直接変更するのには適切ですか。</span><span class="sxs-lookup"><span data-stu-id="3b301-123">When is it appropriate to modify folder permissions directly?</span></span> <span data-ttu-id="3b301-124">一般的とする、フォルダーへのユーザー アクセスを提供する必要しますが、 [DelegateFolderPermissionLevel](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.delegatefolderpermissionlevel%28v=exchg.80%29.aspx) EWS のマネージ API の列挙値、アクセス許可の要件は、このマップではないと、ユーザー、「代理送信」アクセス許可を付与したくない、または[PermissionLevel](http://msdn.microsoft.com/library/87978600-3523-451e-a725-ef092c543e2a%28Office.15%29.aspx)EWS の要素の値、または 1 つのカスタム フォルダーへのユーザー アクセスを提供します。</span><span class="sxs-lookup"><span data-stu-id="3b301-124">Generally, when you want to provide a user access to a folder, but do not want to grant the user "send on behalf of" permissions, when your permissions requirements do not map to the [DelegateFolderPermissionLevel](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.delegatefolderpermissionlevel%28v=exchg.80%29.aspx) EWS Managed API enumeration values or the [PermissionLevel](http://msdn.microsoft.com/library/87978600-3523-451e-a725-ef092c543e2a%28Office.15%29.aspx) EWS element values, or when you want to provide a user access to a single custom folder.</span></span> 
  
<span data-ttu-id="3b301-125">のみ、目標を達成するのにはフォルダーのアクセス許可を変更する必要がある場合、代理人を追加する必要はありません (つまり、「代理送信」アクセス許可が必要なければ、) [Exchange EWS を使用して別のユーザーのフォルダーのアクセス許可の設定](how-to-set-folder-permissions-for-another-user-by-using-ews-in-exchange.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="3b301-125">If you only need to modify folder permissions to achieve your goal, and do not need to add a delegate (that is, you don't need "send on behalf of" permissions), see [Set folder permissions for another user by using EWS in Exchange](how-to-set-folder-permissions-for-another-user-by-using-ews-in-exchange.md).</span></span> 
  
<span data-ttu-id="3b301-126">使用することもできます[Outlook](http://office.microsoft.com/en-us/outlook-help/allow-someone-else-to-manage-your-mail-and-calendar-HA102749417.aspx)または[Exchange Server PowerShell (Exchange 管理シェル)](https://docs.microsoft.com/en-us/powershell/exchange/exchange-server/exchange-management-shell?view=exchange-ps)の代理アクセス権を設定するのには注意してください。</span><span class="sxs-lookup"><span data-stu-id="3b301-126">Note that you can also use [Outlook](http://office.microsoft.com/en-us/outlook-help/allow-someone-else-to-manage-your-mail-and-calendar-HA102749417.aspx) or the [Exchange Server PowerShell (Exchange Management Shell)](https://docs.microsoft.com/en-us/powershell/exchange/exchange-server/exchange-management-shell?view=exchange-ps) to set up delegate access.</span></span> 
  
## <a name="how-does-delegate-access-work"></a><span data-ttu-id="3b301-127">代理人アクセスはどのように機能するか</span><span class="sxs-lookup"><span data-stu-id="3b301-127">How does delegate access work?</span></span>

<span data-ttu-id="3b301-128">代理アクセスでは、一部またはすべてのメールボックス所有者のフォルダーにアクセスし、メールボックス所有者の代理として行動することができます。</span><span class="sxs-lookup"><span data-stu-id="3b301-128">Delegate access enables users to access some or all of the mailbox owner's folders and act on behalf of the mailbox owner.</span></span> <span data-ttu-id="3b301-129">メールボックスの所有者にはユーザー、または会議室のように、リソースを使用できます。</span><span class="sxs-lookup"><span data-stu-id="3b301-129">The mailbox owner can be a user, or a resource, like a conference room.</span></span> <span data-ttu-id="3b301-130">などの受付係には、予約要求を処理するために会議室の予定表フォルダーへの代理アクセス権を付与できます。</span><span class="sxs-lookup"><span data-stu-id="3b301-130">For example, a receptionist can be granted delegate permissions to a conference room's calendar folder, to handle booking requests.</span></span> <span data-ttu-id="3b301-131">EWS のマネージ API または EWS を使用するには、代理人を追加するには、メールボックスの所有者または管理者を有効にするのには、代理人がアクセス、およびそのフォルダーに対するアクセス許可を指定し、どのようなフォルダーを指定します。</span><span class="sxs-lookup"><span data-stu-id="3b301-131">You can use the EWS Managed API or EWS to enable the mailbox owner or an administrator to add a delegate, specify what folders the delegate can access, and then specify permissions for that folder.</span></span> <span data-ttu-id="3b301-132">デリゲートには、次のフォルダーへのアクセス権を与えることができます。</span><span class="sxs-lookup"><span data-stu-id="3b301-132">Delegates can be granted access to the following folders:</span></span> 
  
- <span data-ttu-id="3b301-133">予定表</span><span class="sxs-lookup"><span data-stu-id="3b301-133">Calendar</span></span>
    
- <span data-ttu-id="3b301-134">タスク</span><span class="sxs-lookup"><span data-stu-id="3b301-134">Tasks</span></span>
    
- <span data-ttu-id="3b301-135">受信トレイ</span><span class="sxs-lookup"><span data-stu-id="3b301-135">Inbox</span></span>
    
- <span data-ttu-id="3b301-136">連絡先</span><span class="sxs-lookup"><span data-stu-id="3b301-136">Contacts</span></span>
    
- <span data-ttu-id="3b301-137">メモ</span><span class="sxs-lookup"><span data-stu-id="3b301-137">Notes</span></span>
    
- <span data-ttu-id="3b301-138">ジャーナル</span><span class="sxs-lookup"><span data-stu-id="3b301-138">Journal</span></span>
    
<span data-ttu-id="3b301-139">ユーザーに 1 つ以上のこれらのフォルダーに代理人アクセスが設定されているとき、ことができますを作成、取得、更新、削除、コピー、およびそのフォルダーとフォルダーの設定の[アクセス許可](#bk_delegateperms)によって、すべての子フォルダー内のアイテムを検索します。</span><span class="sxs-lookup"><span data-stu-id="3b301-139">When a user has delegate access to one or more of these folders, they can create, get, update, delete, copy, and search for items in that folder and any child folders, depending on the [permissions](#bk_delegateperms) set on the folder.</span></span> <span data-ttu-id="3b301-140">アプリケーションがこれらのアクションを実行する方法は、[明示的](#bk_explicit)または[暗黙的な](#bk_implicit)アクセスが必要かどうかによって異なります。</span><span class="sxs-lookup"><span data-stu-id="3b301-140">The way in which the application performs these actions depends on whether [explicit](#bk_explicit) or [implicit](#bk_implicit) access is required.</span></span> 
  
## <a name="delegate-permissions"></a><span data-ttu-id="3b301-141">代理アクセス権</span><span class="sxs-lookup"><span data-stu-id="3b301-141">Delegate permissions</span></span>
<span data-ttu-id="3b301-142"><a name="bk_delegateperms"> </a></span><span class="sxs-lookup"><span data-stu-id="3b301-142"></span></span>

<span data-ttu-id="3b301-143">管理者またはメールボックスの所有者のメールボックスに代理人を追加するときは、1 つまたは複数のフォルダーのアクセス許可レベルを設定、こともできます。</span><span class="sxs-lookup"><span data-stu-id="3b301-143">When an administrator or mailbox owner adds a delegate to a mailbox, they can also set the permission level for one or more folders.</span></span> <span data-ttu-id="3b301-144">フォルダーのアクセス許可レベルが設定されていない場合、アクセス許可の値の既定値は、[なし] にします。</span><span class="sxs-lookup"><span data-stu-id="3b301-144">If a permission level is not set for a folder, the permission value defaults to None.</span></span> <span data-ttu-id="3b301-145">複数のユーザーが、フォルダーに同じアクセス許可レベルを持つことができ、ユーザーが別のフォルダーに異なるアクセス許可レベルを持つことができます。</span><span class="sxs-lookup"><span data-stu-id="3b301-145">Multiple users can have the same permission level on a folder, and users can have different permission levels for different folders.</span></span> <span data-ttu-id="3b301-146">EWS のマネージ API を使用する場合フォルダーに代理アクセス権を設定するのには、各フォルダーの[DelegateFolderPermissionLevel](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.delegatefolderpermissionlevel%28v=exchg.80%29.aspx)の列挙値のいずれかを含む、 [DelegateUser.Permissions](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.delegateuser.permissions%28v=exchg.80%29.aspx)プロパティを使用します。</span><span class="sxs-lookup"><span data-stu-id="3b301-146">If you're using the EWS Managed API, you use the [DelegateUser.Permissions](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.delegateuser.permissions%28v=exchg.80%29.aspx) property, which contains one of the [DelegateFolderPermissionLevel](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.delegatefolderpermissionlevel%28v=exchg.80%29.aspx) enumeration values for each folder, to set delegate permissions on folders.</span></span> <span data-ttu-id="3b301-147">EWS を使用する場合、アクセス許可レベルを定義するのには、 [DelegatePermissions](http://msdn.microsoft.com/library/292badc7-bab3-4368-9d7c-9a8b7edb279b%28Office.15%29.aspx) 、代理人アクセス許可を設定する要素と要素の[PermissionLevel](http://msdn.microsoft.com/library/87978600-3523-451e-a725-ef092c543e2a%28Office.15%29.aspx)を使用します。</span><span class="sxs-lookup"><span data-stu-id="3b301-147">If you're using EWS, you use the [DelegatePermissions](http://msdn.microsoft.com/library/292badc7-bab3-4368-9d7c-9a8b7edb279b%28Office.15%29.aspx) element to set delegate permissions, and the [PermissionLevel](http://msdn.microsoft.com/library/87978600-3523-451e-a725-ef092c543e2a%28Office.15%29.aspx) element to define the permission level.</span></span> 
  
<span data-ttu-id="3b301-148">**表 2 になります。デリゲートのアクセス許可のレベル**</span><span class="sxs-lookup"><span data-stu-id="3b301-148">**Table 2. Delegate permission levels**</span></span>

|<span data-ttu-id="3b301-149">**アクセス許可レベル**</span><span class="sxs-lookup"><span data-stu-id="3b301-149">**Permission level**</span></span>|<span data-ttu-id="3b301-150">**説明**</span><span class="sxs-lookup"><span data-stu-id="3b301-150">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="3b301-151">なし</span><span class="sxs-lookup"><span data-stu-id="3b301-151">None</span></span>  <br/> |<span data-ttu-id="3b301-152">これはすべてのフォルダーの既定値です。</span><span class="sxs-lookup"><span data-stu-id="3b301-152">This is the default value for all folders.</span></span>  <br/> |
|<span data-ttu-id="3b301-153">Author</span><span class="sxs-lookup"><span data-stu-id="3b301-153">Author</span></span>  <br/> |<span data-ttu-id="3b301-154">代理人は、読み取り、アイテムの作成し変更ししを作成するアイテムを削除できます。</span><span class="sxs-lookup"><span data-stu-id="3b301-154">A delegate can read and create items, and modify and delete items they create.</span></span> <span data-ttu-id="3b301-155">などの代理人はメールボックスの所有者の仕事または予定表のフォルダーに直接仕事の依頼と会議出席依頼を作成し、メールボックス所有者の代わりにアイテムを送信できます。</span><span class="sxs-lookup"><span data-stu-id="3b301-155">For example, a delegate can create task requests and meeting requests directly in the mailbox owner's Task or Calendar folder, and then send either item on the mailbox owner's behalf.</span></span>  <br/> |
|<span data-ttu-id="3b301-156">Editor</span><span class="sxs-lookup"><span data-stu-id="3b301-156">Editor</span></span>  <br/> |<span data-ttu-id="3b301-157">代理人は、Author にできるすべてのことに加え、メールボックスの所有者が作成したアイテムの変更や削除もできます。</span><span class="sxs-lookup"><span data-stu-id="3b301-157">A delegate can do everything an Author can do, and also modify and delete the items the mailbox owner created.</span></span>  <br/> |
|<span data-ttu-id="3b301-158">Reviewer</span><span class="sxs-lookup"><span data-stu-id="3b301-158">Reviewer</span></span>  <br/> |<span data-ttu-id="3b301-159">代理人はアイテムを読むことができます。たとえば、Reviewer のアクセス許可を持つ代理人は、別のユーザーの受信トレイのメッセージを読むことができます。</span><span class="sxs-lookup"><span data-stu-id="3b301-159">A delegate can read items; for example a delegate with Reviewer permission can read messages in another person's Inbox.</span></span>  <br/> |
|<span data-ttu-id="3b301-160">Custom</span><span class="sxs-lookup"><span data-stu-id="3b301-160">Custom</span></span>  <br/> |<span data-ttu-id="3b301-161">メールボックスの所有者が代理人にアクセス許可のカスタム セットを与えている場合です。</span><span class="sxs-lookup"><span data-stu-id="3b301-161">The mailbox owner has granted a custom set of permissions to the delegate.</span></span>  <br/> |
   
<span data-ttu-id="3b301-162">EWS マネージ API の[DelgateUser.ViewPrivateItems](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.delegateuser.viewprivateitems%28v=exchg.80%29.aspx)プロパティと[ViewPrivateItems](http://msdn.microsoft.com/library/80b949ac-440c-4a01-b428-ebafb5b1b802%28Office.15%29.aspx)の EWS の要素は、すべてのメールボックス所有者のフォルダーすべてのメール、連絡先、予定表、タスク、メモ、および仕訳帳のフォルダーに影響を与えるグローバル設定です。</span><span class="sxs-lookup"><span data-stu-id="3b301-162">The [DelgateUser.ViewPrivateItems](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.delegateuser.viewprivateitems%28v=exchg.80%29.aspx) EWS Managed API property and the [ViewPrivateItems](http://msdn.microsoft.com/library/80b949ac-440c-4a01-b428-ebafb5b1b802%28Office.15%29.aspx) EWS element is a global setting that affects all the mailbox owner's folders, including all Mail, Contacts, Calendar, Tasks, Notes, and Journal folders.</span></span> <span data-ttu-id="3b301-163">フォルダーの 1 つだけの非公開アイテムへのアクセスを許可することはできません。</span><span class="sxs-lookup"><span data-stu-id="3b301-163">You cannot allow access to private items in only one folder.</span></span> 
  
## <a name="explicit-access"></a><span data-ttu-id="3b301-164">明示的なアクセス</span><span class="sxs-lookup"><span data-stu-id="3b301-164">Explicit access</span></span>
<span data-ttu-id="3b301-165"><a name="bk_explicit"> </a></span><span class="sxs-lookup"><span data-stu-id="3b301-165"></span></span>

<span data-ttu-id="3b301-p110">簡単に言えば、明示的なアクセスとは、代理人がメールボックス所有者のフォルダーまたはアイテムに対してアクションを実行するための通路のようなものです。代理人がサーバーへの要求にメールボックスの所有者のフォルダーの既知のフォルダー名とメールボックスの所有者の SMTP アドレスを含めると、代理人に明示的なアクセスが与えられます。このアクセスは明示的です。なぜなら、代理人の要求は、メソッドまたは操作のコンテキストがメールボックス所有者のメールボックスであって、代理人のメールボックスではないことを、明示的に示しているためです。</span><span class="sxs-lookup"><span data-stu-id="3b301-p110">Simply put, explicit access is the entry way for delegates to perform actions on a mailbox owner's folders or items. Explicit access is granted to a delegate when they include the well-known folder name for a mailbox owner's folder along with the mailbox owner's SMTP address in a request to the server. The access is explicit because the delegate's request explicitly states that the context for the method or operation is the mailbox owner's mailbox, and not the delegate's mailbox.</span></span>
  
<span data-ttu-id="3b301-169">明示的なアクセス権は、すべてのメソッドや、フォルダーまたは前方に移動する項目に対して実行する操作のコンテキストを定義します。</span><span class="sxs-lookup"><span data-stu-id="3b301-169">Explicit access defines the context for all methods or operations performed on the folders or items moving forward.</span></span> <span data-ttu-id="3b301-170">明示的なアクセス権を一意に設定されている場合に返されるすべてのアイテムおよびフォルダーの Id (ではなく、人間が読める形式) に、メールボックスの所有者に属するものとして識別します。</span><span class="sxs-lookup"><span data-stu-id="3b301-170">All item and folder IDs returned when the explicit access is set uniquely identify themselves as belonging to the mailbox owner (although not in any human readable format).</span></span> <span data-ttu-id="3b301-171">この方法では、アプリケーションが繰り返しは、メールボックス所有者の SMTP アドレスを指定する必要がないです。コンテキストは、識別子で非表示にします。</span><span class="sxs-lookup"><span data-stu-id="3b301-171">This way, the application doesn't need to specify the mailbox owner's SMTP address again and again; the context is hidden in the identifiers.</span></span> <span data-ttu-id="3b301-172">アイテムまたはフォルダーを特定すると、デリゲートは実際に項目を変更するのには[暗黙のアクセス](#bk_implicit)を使用します。</span><span class="sxs-lookup"><span data-stu-id="3b301-172">After an item or folder is identified, a delegate actually uses [implicit access](#bk_implicit) to modify the item.</span></span> <span data-ttu-id="3b301-173">明示的および暗黙的なアクセスを取得するプロセスを次の図に示します。</span><span class="sxs-lookup"><span data-stu-id="3b301-173">The following figure shows the process of getting explicit and implicit access.</span></span> 
  
<span data-ttu-id="3b301-174">**図 2 になります。アイテムまたはフォルダーへの明示的および暗黙的なアクセスを要求します。**</span><span class="sxs-lookup"><span data-stu-id="3b301-174">**Figure 2. Requesting explicit and implicit access to an item or folder**</span></span>

![アプリケーションが明示的なアクセスの要求を送信し、サーバーからの応答を受け取り、暗黙的なアクセスの要求を送信し、サーバーからの応答を受け取る流れを示した図。](media/Ex15_Delegate_ExplictImplicit.png)
  
<span data-ttu-id="3b301-p112">様々なシナリオで明示的なアクセスを設定できます。基本的に、フォルダー ID をメソッドまたは操作に入れて送信する場合は常に、明示的なアクセスを設定できます。これには、フォルダーの検索、予定の検索、アイテムの取得、会話の検索などがあります。</span><span class="sxs-lookup"><span data-stu-id="3b301-p112">You can set explicit access in many different scenarios. Essentially, any time you're sending a folder ID in a method or operation, you can set explicit access. This can include finding folders, finding appointments, getting items, finding conversations, and so on.</span></span>
  
### <a name="explicit-access-and-the-ews-managed-api"></a><span data-ttu-id="3b301-179">明示的なアクセスと EWS マネージ API</span><span class="sxs-lookup"><span data-stu-id="3b301-179">Explicit access and the EWS Managed API</span></span>
<span data-ttu-id="3b301-180"><a name="bk_explicitewsma"> </a></span><span class="sxs-lookup"><span data-stu-id="3b301-180"></span></span>

<span data-ttu-id="3b301-181">フォルダーを識別するのには[フォルダー Id](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.folderid%28v=exchg.80%29.aspx)の入力パラメーターを受け取るオーバー ロードされたメソッドの次のいずれかを使用して、明示的なデリゲートのアクセスを開始できます。</span><span class="sxs-lookup"><span data-stu-id="3b301-181">You can initiate explicit delegate access by using any of the following overloaded methods that take a [FolderId](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.folderid%28v=exchg.80%29.aspx) input parameter to identify the target folder:</span></span> 
  
- [<span data-ttu-id="3b301-182">Folder.Bind</span><span class="sxs-lookup"><span data-stu-id="3b301-182">Folder.Bind</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.folder.bind%28v=exchg.80%29.aspx)
    
- [<span data-ttu-id="3b301-183">ExchangeService.FindItems</span><span class="sxs-lookup"><span data-stu-id="3b301-183">ExchangeService.FindItems</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservice.finditems%28v=exchg.80%29.aspx)
    
- [<span data-ttu-id="3b301-184">ExchangeService.FindAppointments</span><span class="sxs-lookup"><span data-stu-id="3b301-184">ExchangeService.FindAppointments</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservice.findappointments%28v=exchg.80%29.aspx)
    
- [<span data-ttu-id="3b301-185">ExchangeService.FindFolders</span><span class="sxs-lookup"><span data-stu-id="3b301-185">ExchangeService.FindFolders</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservice.findfolders%28v=exchg.80%29.aspx)
    
- <span data-ttu-id="3b301-186">その他多数。</span><span class="sxs-lookup"><span data-stu-id="3b301-186">And more!</span></span>
    
<span data-ttu-id="3b301-187">これらのメソッドのそれぞれに**フォルダー Id**パラメーターを使用するには次のようにメールボックス所有者のターゲット フォルダーを識別します。</span><span class="sxs-lookup"><span data-stu-id="3b301-187">You can use the **FolderId** parameter in each of these methods to identify the mailbox owner's target folder, as follows.</span></span> 
  
```cs
new FolderId(WellKnownFolderName.Calendar, "primary@contoso.com");
```

<span data-ttu-id="3b301-188">たとえば、予定表フォルダーにバインドするにこの**バインド**のメソッドでは、**フォルダー Id**を指定、よく知られているフォルダー名、およびメールボックス所有者の SMTP アドレス。</span><span class="sxs-lookup"><span data-stu-id="3b301-188">For example, to bind to the Calendar folder, the **FolderId** in this **Bind** method specifies the well-known folder name, and the mailbox owner's SMTP address.</span></span> 
  
```cs
CalendarFolder calendar = CalendarFolder.Bind(service, new FolderId(WellKnownFolderName.Calendar, "primary@contoso.com"), new PropertySet());
```

<span data-ttu-id="3b301-189">よく知られているフォルダー名と SMTP アドレスを指定すると、代理人がメールボックス所有者の予定表フォルダーにバインドできる、フォルダーに明示的なアクセス権をましょうします。</span><span class="sxs-lookup"><span data-stu-id="3b301-189">By specifying the well-known folder name and the SMTP address, the delegate can bind to the mailbox owner's Calendar folder — thereby gaining explicit access to the folder.</span></span> <span data-ttu-id="3b301-190">[暗黙のアクセス](#bk_implicit)フォルダー内のアイテムのすべての後続の要求は、Id と Id のフォルダーにアイテムに返されるコンテキストに依存しています。</span><span class="sxs-lookup"><span data-stu-id="3b301-190">All subsequent requests for [implicit access](#bk_implicit) to items in the folder then rely on the context returned in the item IDs and folder IDs.</span></span> <span data-ttu-id="3b301-191">基本的には、識別子には、黙示的な代理人アクセスの呼び出しのコンテキストが含まれています。</span><span class="sxs-lookup"><span data-stu-id="3b301-191">Essentially, the identifiers contain the context for the implied delegate access calls.</span></span> <span data-ttu-id="3b301-192">または、特定の条件に一致する項目の項目 ID を取得するには、次のように使用します。</span><span class="sxs-lookup"><span data-stu-id="3b301-192">Or, to retrieve the item ID of an item that meets specific criteria, use the following.</span></span> 
  
```cs
FindItemsResults<Item> results = service.FindItems(new FolderId(WellKnownFolderName.Calendar, "primary@contoso.com"), filter, view);
```

<span data-ttu-id="3b301-193">この場合、アイテム ID が返された後、このアイテム ID を使用すれば、代理人は暗黙的なアクセスでアイテムを変更できます。</span><span class="sxs-lookup"><span data-stu-id="3b301-193">In this case the item ID is returned, and then the delegate can then use implicit access to make changes to the item by using the item ID.</span></span>
  
<span data-ttu-id="3b301-194">項目 ID または既存の明示的なアクセス権を使用してアクセスしていないフォルダー ID が必要になるまでに明示的なアクセス権をもう一度開始する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="3b301-194">You don't have to initiate explicit access again until you require an item ID or a folder ID that you didn't access via the existing explicit access.</span></span> 
  
### <a name="explicit-access-and-ews"></a><span data-ttu-id="3b301-195">明示的なアクセスと EWS</span><span class="sxs-lookup"><span data-stu-id="3b301-195">Explicit access and EWS</span></span>
<span data-ttu-id="3b301-196"><a name="bk_explicitewsma"> </a></span><span class="sxs-lookup"><span data-stu-id="3b301-196"></span></span>

<span data-ttu-id="3b301-197">[GetFolder](http://msdn.microsoft.com/library/355bcf93-dc71-4493-b177-622afac5fdb9%28Office.15%29.aspx)、 [FindItem](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx)、 [FindFolder](http://msdn.microsoft.com/library/7a9855aa-06cc-45ba-ad2a-645c15b7d031%28Office.15%29.aspx)操作を使用して明示的なアクセスを行うことができます。</span><span class="sxs-lookup"><span data-stu-id="3b301-197">You can initiate explicit access by using the [GetFolder](http://msdn.microsoft.com/library/355bcf93-dc71-4493-b177-622afac5fdb9%28Office.15%29.aspx), [FindItem](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx), or [FindFolder](http://msdn.microsoft.com/library/7a9855aa-06cc-45ba-ad2a-645c15b7d031%28Office.15%29.aspx) operations.</span></span> <span data-ttu-id="3b301-198">これらの操作は、対象となるフォルダーを識別する[DistinguishedFolderId](http://msdn.microsoft.com/library/50018162-2941-4227-8a5b-d6b4686bb32f%28Office.15%29.aspx)要素を使用するオプションを提供します。</span><span class="sxs-lookup"><span data-stu-id="3b301-198">These operations provide the option to use the [DistinguishedFolderId](http://msdn.microsoft.com/library/50018162-2941-4227-8a5b-d6b4686bb32f%28Office.15%29.aspx) element to identify the target folder.</span></span> <span data-ttu-id="3b301-199">**DistinguishedFolderId**要素には、[メールボックス](http://msdn.microsoft.com/library/befc70fd-51cb-4258-884c-80c9050f0e82%28Office.15%29.aspx)の要素、1 つの省略可能な子要素があります。</span><span class="sxs-lookup"><span data-stu-id="3b301-199">The **DistinguishedFolderId** element has a single optional child element, the [Mailbox](http://msdn.microsoft.com/library/befc70fd-51cb-4258-884c-80c9050f0e82%28Office.15%29.aspx) element.</span></span> <span data-ttu-id="3b301-200">**メールボックス**の要素、 **DistinguishedFolderId**の要素の子として使用する場合は、代理人アクセスのメールボックスを指定します。</span><span class="sxs-lookup"><span data-stu-id="3b301-200">The **Mailbox** element, when used as a child of the **DistinguishedFolderId** element, specifies the mailbox for the delegate to access.</span></span> <span data-ttu-id="3b301-201">呼び出し元のユーザーにメールボックス所有者のフォルダーにアクセスする権限がある場合、応答にはアイテムまたはそのメールボックス内のフォルダーの識別子のコレクションが含まれます。</span><span class="sxs-lookup"><span data-stu-id="3b301-201">If the calling user has permission to access the mailbox owner's folder, the response will contain a collection of identifiers to items or folders in that mailbox.</span></span> <span data-ttu-id="3b301-202">暗黙の代理人アクセスの応答で返されるアイテムおよびフォルダーの識別子を使用できます。</span><span class="sxs-lookup"><span data-stu-id="3b301-202">The item and folder identifiers that are returned in the response can be used for implicit delegate access.</span></span> 
  
## <a name="implicit-access"></a><span data-ttu-id="3b301-203">暗黙的なアクセス</span><span class="sxs-lookup"><span data-stu-id="3b301-203">Implicit access</span></span>
<span data-ttu-id="3b301-204"><a name="bk_implicit"> </a></span><span class="sxs-lookup"><span data-stu-id="3b301-204"></span></span>

<span data-ttu-id="3b301-p115">代理人がメールボックスの所有者のメールボックス内のアイテムまたはフォルダーの ID を取得したら、アイテムの更新、削除、またはコピーを行うとき、後は暗黙的なアクセスが使用されます。代理人が要求でそのアイテム ID またはフォルダー ID を使用すると、メールボックス所有者のメールボックス内のアイテムに対して変更が加えられます。代理人はメールボックス所有者の SMTP アドレスを含める必要はありません。 </span><span class="sxs-lookup"><span data-stu-id="3b301-p115">Implicit access is used after a delegate has retrieved the ID for an item or folder in the mailbox owner's mailbox and the delegate wants to update, delete, or copy the item. When the delegate uses that item or folder ID in a request, the changes are made to the item in the mailbox owner's mailbox. The delegate does not have to include the mailbox owner's SMTP address.</span></span> 
  
<span data-ttu-id="3b301-208">など、その代理人にメールボックス所有者のフォルダーのいずれかの ID が設定されているとき、代理人は ID を使用して、フォルダー、メールボックス所有者のメールボックスを明示的に識別することがなくそのフォルダーに対して**FindItem**操作を実行できます。</span><span class="sxs-lookup"><span data-stu-id="3b301-208">For example, when a delegate has the ID of one of the mailbox owner's folders, the delegate can perform a **FindItem** operation on that folder by using the folder ID, without explicitly identifying the mailbox owner's mailbox.</span></span> <span data-ttu-id="3b301-209">その時点では、デリゲートは、応答で返される Id を使用して、メールボックス所有者のフォルダーにアクションを実行できます。</span><span class="sxs-lookup"><span data-stu-id="3b301-209">At that point, the delegate can perform actions on the mailbox owner's folder by using the IDs that are returned in the responses.</span></span> 
  
### <a name="implicit-access-and-the-ews-managed-api"></a><span data-ttu-id="3b301-210">暗黙的なアクセスと EWS マネージ API</span><span class="sxs-lookup"><span data-stu-id="3b301-210">Implicit access and the EWS Managed API</span></span>

<span data-ttu-id="3b301-211">[FindItems](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservice.finditems%28v=exchg.80%29.aspx)メソッドによって、アイテムの ID を取得した場合は、項目にバインドするのにはそれ以降の[Item.Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.bind%28v=exchg.80%29.aspx)メソッドの呼び出しでそのアイテムの ID が使用できます。</span><span class="sxs-lookup"><span data-stu-id="3b301-211">If an item ID was retrieved by the [FindItems](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservice.finditems%28v=exchg.80%29.aspx) method, that item ID can be used in a subsequent [Item.Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.bind%28v=exchg.80%29.aspx) method call to bind to the item.</span></span> <span data-ttu-id="3b301-212">[Item.Update](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.item.update%28v=exchg.80%29.aspx)、 [Item.Delete](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.item.delete%28v=exchg.80%29.aspx)、または[Item.Copy](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.item.copy%28v=exchg.80%29.aspx)メソッドを呼び出すことができますし、- または項目 ID を必要とするメソッドの呼び出し-タスクを完了するために必要とします。</span><span class="sxs-lookup"><span data-stu-id="3b301-212">You can then call the [Item.Update](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.item.update%28v=exchg.80%29.aspx), [Item.Delete](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.item.delete%28v=exchg.80%29.aspx), or [Item.Copy](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.item.copy%28v=exchg.80%29.aspx) method — or any method call that requires an item ID — as needed to complete your task.</span></span> <span data-ttu-id="3b301-213">限り、代理人が、アイテムを含むフォルダーの適切なアクセス許可 (および該当する場合、フォルダー項目へ移動)、代理人は、アクセス許可レベルに応じて変更を実行できます。</span><span class="sxs-lookup"><span data-stu-id="3b301-213">As long as the delegate has appropriate permissions to the folder that contains the item (and, if applicable, the folder the item is moving to), the delegate can make changes according to their permission levels.</span></span> 
  
### <a name="implicit-access-and-ews"></a><span data-ttu-id="3b301-214">暗黙的なアクセスと EWS</span><span class="sxs-lookup"><span data-stu-id="3b301-214">Implicit access and EWS</span></span>

<span data-ttu-id="3b301-215">[FindItem](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx)操作によって項目 ID を取得した場合は、項目にバインドするのには以降の[GetItem](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx)操作でそのアイテムの ID が使用できます。</span><span class="sxs-lookup"><span data-stu-id="3b301-215">If an item ID was retrieved by the [FindItem](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx) operation, that item ID can be used in subsequent [GetItem](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) operations to bind to the item.</span></span> <span data-ttu-id="3b301-216">[UpdateItem](http://msdn.microsoft.com/library/5d027523-e0bc-4da2-b60b-0cb9fc1fdfe4%28Office.15%29.aspx)、 [DeleteItem](http://msdn.microsoft.com/library/3e26c416-fa12-476e-bfd2-5c1f4bb7b348%28Office.15%29.aspx)、または[CopyItem](http://msdn.microsoft.com/library/bcc68f9e-d511-4c29-bba6-ed535524624a%28Office.15%29.aspx)の操作を呼び出すことができますし、- または項目 ID が要求される操作-タスクを完了するために必要とします。</span><span class="sxs-lookup"><span data-stu-id="3b301-216">You can then call the [UpdateItem](http://msdn.microsoft.com/library/5d027523-e0bc-4da2-b60b-0cb9fc1fdfe4%28Office.15%29.aspx), [DeleteItem](http://msdn.microsoft.com/library/3e26c416-fa12-476e-bfd2-5c1f4bb7b348%28Office.15%29.aspx), or [CopyItem](http://msdn.microsoft.com/library/bcc68f9e-d511-4c29-bba6-ed535524624a%28Office.15%29.aspx) operation — or any operation that requires an item ID — as needed to complete your task.</span></span> <span data-ttu-id="3b301-217">限り、代理人が、アイテムを含むフォルダーの適切なアクセス許可 (および該当する場合、フォルダー項目へ移動)、代理人は、アクセス許可レベルに応じて変更を実行できます。</span><span class="sxs-lookup"><span data-stu-id="3b301-217">As long as the delegate has appropriate permissions to the folder that contains the item (and, if applicable, the folder the item is moving to), the delegate can make changes according to their permission levels.</span></span> 
  
## <a name="in-this-section"></a><span data-ttu-id="3b301-218">このセクションの内容</span><span class="sxs-lookup"><span data-stu-id="3b301-218">In this section</span></span>
<span data-ttu-id="3b301-219"><a name="bk_implicit"> </a></span><span class="sxs-lookup"><span data-stu-id="3b301-219"></span></span>

- [<span data-ttu-id="3b301-220">追加し、Exchange の EWS を使用して、デリゲートを削除します。</span><span class="sxs-lookup"><span data-stu-id="3b301-220">Add and remove delegates by using EWS in Exchange</span></span>](how-to-add-and-remove-delegates-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="3b301-221">EWS を使用して Exchange 内で代理人に予定表にアクセスします。</span><span class="sxs-lookup"><span data-stu-id="3b301-221">Access a calendar as a delegate by using EWS in Exchange</span></span>](how-to-access-a-calendar-as-a-delegate-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="3b301-222">Exchange EWS を使用して代理人としてアクセス連絡先</span><span class="sxs-lookup"><span data-stu-id="3b301-222">Access contacts as a delegate by using EWS in Exchange</span></span>](how-to-access-contacts-as-a-delegate-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="3b301-223">EWS を使用して Exchange 内で代理人として電子メールにアクセスします。</span><span class="sxs-lookup"><span data-stu-id="3b301-223">Access email as a delegate by using EWS in Exchange</span></span>](how-to-access-email-as-a-delegate-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="3b301-224">Exchange EWS を使用して別のユーザーのフォルダーのアクセス許可を設定します。</span><span class="sxs-lookup"><span data-stu-id="3b301-224">Set folder permissions for another user by using EWS in Exchange</span></span>](how-to-set-folder-permissions-for-another-user-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="3b301-225">Exchange EWS での委任に関連するエラーの処理</span><span class="sxs-lookup"><span data-stu-id="3b301-225">Handling delegation-related errors in EWS in Exchange</span></span>](handling-delegation-related-errors-in-ews-in-exchange.md)
    
## <a name="see-also"></a><span data-ttu-id="3b301-226">関連項目</span><span class="sxs-lookup"><span data-stu-id="3b301-226">See also</span></span>


- [<span data-ttu-id="3b301-227">Exchange の Web サービス クライアントを開発する</span><span class="sxs-lookup"><span data-stu-id="3b301-227">Develop web service clients for Exchange</span></span>](develop-web-service-clients-for-exchange.md)
    
- [<span data-ttu-id="3b301-228">自分のメールと予定表を管理するために他のユーザーを許可します。</span><span class="sxs-lookup"><span data-stu-id="3b301-228">Allow someone else to manage your mail and calendar</span></span>](http://office.microsoft.com/en-us/outlook-help/allow-someone-else-to-manage-your-mail-and-calendar-HA102749417.aspx)
    
- [<span data-ttu-id="3b301-229">追加 MailboxPermission</span><span class="sxs-lookup"><span data-stu-id="3b301-229">Add- MailboxPermission</span></span>](http://technet.microsoft.com/en-us/library/bb124097%28v=exchg.150%29.aspx)
    

