---
title: Exchange での代理人アクセスと EWS
manager: sethgros
ms.date: 03/9/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: 240d1776-7adc-46cd-9099-88ffeba0a8aa
description: Exchange の EWS マネージ API と EWS を使用してユーザーのメールボックスに代理人アクセスできるようにする方法を説明します。
ms.openlocfilehash: 344255d86a51e13b21f1eda5113d292395d7cb8f
ms.sourcegitcommit: 9061fcf40c218ebe88911783f357b7df278846db
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/28/2018
ms.locfileid: "21354051"
---
# <a name="delegate-access-and-ews-in-exchange"></a><span data-ttu-id="44aee-103">Exchange での代理人アクセスと EWS</span><span class="sxs-lookup"><span data-stu-id="44aee-103">Delegate access and EWS in Exchange</span></span>

<span data-ttu-id="44aee-104">Exchange の EWS マネージ API と EWS を使用してユーザーのメールボックスに代理人アクセスできるようにする方法を説明します。</span><span class="sxs-lookup"><span data-stu-id="44aee-104">Find out how to use the EWS Managed API and EWS in Exchange to provide delegate access to users' mailboxes.</span></span>
  
<span data-ttu-id="44aee-105">ユーザーが他のユーザーのメールボックスにアクセスできるようにするには、次の 3 つの方法のいずれかを使用できます。</span><span class="sxs-lookup"><span data-stu-id="44aee-105">You can enable users to access other users' mailboxes in one of three ways:</span></span> 
  
- <span data-ttu-id="44aee-106">代理人を追加し、各代理人にアクセス許可を指定します。</span><span class="sxs-lookup"><span data-stu-id="44aee-106">By adding delegates and specifying permissions for each delegate.</span></span>
    
- <span data-ttu-id="44aee-107">フォルダーのアクセス許可を直接変更します。</span><span class="sxs-lookup"><span data-stu-id="44aee-107">By modifying folder permissions directly.</span></span>
    
- <span data-ttu-id="44aee-108">偽装を使用します。</span><span class="sxs-lookup"><span data-stu-id="44aee-108">By using impersonation.</span></span>
    
<span data-ttu-id="44aee-p101">委任、およびフォルダーのアクセス許可は、各メールボックスに個別にアクセス許可を追加する必要があるため、少数のユーザーにのみアクセス許可を付与する場合に最適です。偽装は、1 つのサービス アカウントによるデータベース内のすべてのメールボックスへのアクセスを簡単に許可できるため、多数のメールボックスを処理するときに最適です。図 1 は、各種のアクセスの相違点を示しています。</span><span class="sxs-lookup"><span data-stu-id="44aee-p101">Delegation and folder permissions are best when you're only granting access to a few users, because you have to add permissions individually to each mailbox. Impersonation is the best choice when you're dealing with quantities of mailboxes, because you can easily enable one service account to access every mailbox in a database. Figure 1 shows some of the differences between each type of access.</span></span>
  
<span data-ttu-id="44aee-112">**図 1. 他のユーザーのメールボックスにアクセスする方法**</span><span class="sxs-lookup"><span data-stu-id="44aee-112">**Figure 1. Ways to access other users' mailboxes**</span></span>

![メールボックスのアクセス タイプ、各タイプのメールボックス所有者と代理人の関係、およびアクセス許可のタイプを示す図。委任用のアクセス許可またはフォルダー アクセス許可のために送信します。偽装のためのアクセス許可として送信します。](media/Ex15_Delegate_Overview.png)
  
<span data-ttu-id="44aee-116">メールの送信や会議のスケジュールに関して、代理人には「代理送信」のアクセス許可が与えられます。そのため、代理人から送信されたメールまたは会議出席依頼の受信者がそれを Outlook で受信した場合、「*メールボックスの所有者*の*代理人として送信*」したことが表示されます。</span><span class="sxs-lookup"><span data-stu-id="44aee-116">When it comes to sending mail or scheduling meetings, delegates can be given "send on behalf of" permissions, so the recipient of an email or a meeting request that was sent by a delegate will see " *delegate*  on behalf of  *mailbox owner*  " when they receive the email or meeting request in Outlook.</span></span> <span data-ttu-id="44aee-117">「代理人として送信」のテキストを含めることは、クライアント実装の詳細事項の 1 つです。これは "from" と "sender" の値を使用して作成できます。</span><span class="sxs-lookup"><span data-stu-id="44aee-117">Including the "send on behalf of" text is a client implementation detail - and can be created by using the "from" and "sender" values.</span></span> <span data-ttu-id="44aee-118">"from" の値はメールボックスの所有者を示し、"sender" の値はメール送信した代理人を示します。</span><span class="sxs-lookup"><span data-stu-id="44aee-118">When an email message is sent by a delegate, the "from" value identifies the mailbox owner, and the "sender" value identifies the delegate that sent the mail.</span></span> <span data-ttu-id="44aee-119">ユーザーを偽装しているサービス アカウントが、メールボックスの所有者の代わりにメールの送信や会議のスケジュールを行う場合、メッセージはメールボックスの所有者「として」送信されます。</span><span class="sxs-lookup"><span data-stu-id="44aee-119">If a service account impersonating a user sends an email or schedules a meeting for the mailbox owner, the message is "sent as" the mailbox owner.</span></span> <span data-ttu-id="44aee-120">受信者には、サービス アカウントから送信されたメールであることを確認する手段はありません。</span><span class="sxs-lookup"><span data-stu-id="44aee-120">There is no way for the recipient to know the mail was sent by the service account.</span></span> <span data-ttu-id="44aee-121">フォルダーのアクセス許可が付与され、代理人としてのアクセス権が付与されていないユーザーは、メールボックスの所有者として送信したり、代理送信したりできません。</span><span class="sxs-lookup"><span data-stu-id="44aee-121">Users who are granted folder permissions and not delegate access are not able to "send as" or "send on behalf of" of a mailbox owner.</span></span> <span data-ttu-id="44aee-122">そのようなユーザーはメールボックスのフォルダーへのアクセス権を持ち、フォルダーにアイテムを作成できる場合もありますが、アイテムを送信することはできません。</span><span class="sxs-lookup"><span data-stu-id="44aee-122">They have access to the mailbox folders, and might be able to create items in the folders, but they cannot send the items.</span></span> 
  
<span data-ttu-id="44aee-123">フォルダーのアクセス許可を直接変更するのが適しているのはどのような場合でしょうか。</span><span class="sxs-lookup"><span data-stu-id="44aee-123">When is it appropriate to modify folder permissions directly?</span></span> <span data-ttu-id="44aee-124">一般に、フォルダーへのアクセスをユーザーに提供するものの「代理送信」のアクセス許可は付与しない場合、アクセス許可の要件が [DelegateFolderPermissionLevel](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.delegatefolderpermissionlevel%28v=exchg.80%29.aspx) EWS マネージ API 列挙値または [PermissionLevel](http://msdn.microsoft.com/library/87978600-3523-451e-a725-ef092c543e2a%28Office.15%29.aspx) EWS の要素の値にマップしない場合、または単一のカスタム フォルダーへのアクセスをユーザーに提供する場合です。</span><span class="sxs-lookup"><span data-stu-id="44aee-124">When is it appropriate to modify folder permissions directly? Generally, when you want to provide a user access to a folder, but do not want to grant the user "send on behalf of" permissions, when your permissions requirements do not map to the [DelegateFolderPermissionLevelhttp://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.delegatefolderpermissionlevel(v=exchg.80).aspx](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.delegatefolderpermissionlevel%28v=exchg.80%29.aspx) EWS Managed API enumeration values or the [PermissionLevel](http://msdn.microsoft.com/library/87978600-3523-451e-a725-ef092c543e2a%28Office.15%29.aspx) EWS element values, or when you want to provide a user access to a single custom folder.</span></span> 
  
<span data-ttu-id="44aee-125">フォルダーのアクセス許可を変更するだけで目標を達成でき、代理人を追加する必要がない場合 (つまり、「代理送信」のアクセス許可が必要ない場合) は、[「Exchange で EWS を使用して別のユーザーのフォルダーのアクセス許可を設定する」](how-to-set-folder-permissions-for-another-user-by-using-ews-in-exchange.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="44aee-125">If you only need to modify folder permissions to achieve your goal, and do not need to add a delegate (that is, you don't need "send on behalf of" permissions), see How to: Set folder permissions for another user.</span></span> 
  
<span data-ttu-id="44aee-126">なお、[Outlook](http://office.microsoft.com/ja-JP/outlook-help/allow-someone-else-to-manage-your-mail-and-calendar-HA102749417.aspx) または [Exchange Server PowerShell (Exchange 管理シェル)](https://docs.microsoft.com/en-us/powershell/exchange/exchange-server/exchange-management-shell?view=exchange-ps) を使用して代理人アクセスを設定することもできます。</span><span class="sxs-lookup"><span data-stu-id="44aee-126">Note that you can also use [Outlook](http://office.microsoft.com/ja-JP/outlook-help/allow-someone-else-to-manage-your-mail-and-calendar-HA102749417.aspx) or the [Exchange Server PowerShell (Exchange Management Shell)](https://docs.microsoft.com/en-us/powershell/exchange/exchange-server/exchange-management-shell?view=exchange-ps) to set up delegate access.</span></span> 
  
## <a name="how-does-delegate-access-work"></a><span data-ttu-id="44aee-127">代理人アクセスはどのように機能するか</span><span class="sxs-lookup"><span data-stu-id="44aee-127">How does delegate access work?</span></span>

<span data-ttu-id="44aee-128">代理人アクセスにより、ユーザーはメールボックス所有者のフォルダーの一部または全部にアクセスし、メールボックス所有者の代理として行動できるようになります。</span><span class="sxs-lookup"><span data-stu-id="44aee-128">Delegate access enables users to access some or all of the mailbox owner's folders and act on behalf of the mailbox owner.</span></span> <span data-ttu-id="44aee-129">メールボックスの所有者はユーザーの場合もあれば、会議室のようなリソースの場合もあります。</span><span class="sxs-lookup"><span data-stu-id="44aee-129">The mailbox owner can be a user, or a resource, like a conference room.</span></span> <span data-ttu-id="44aee-130">たとえば、予約要求を処理するため、受付係に会議室の予定表フォルダーへの代理アクセス権を付与できます。</span><span class="sxs-lookup"><span data-stu-id="44aee-130">For example, a receptionist can be granted delegate permissions to a conference room's calendar folder, to handle booking requests.</span></span> <span data-ttu-id="44aee-131">EWS マネージ API または EWS を使用すれば、メールボックスの所有者または管理者は、代理人を追加すること、代理人がアクセスできるフォルダーを指定すること、そのフォルダーに対するアクセス許可を指定することができるようになります。</span><span class="sxs-lookup"><span data-stu-id="44aee-131">You can use the EWS Managed API or EWS to enable the mailbox owner or an administrator to add a delegate, specify what folders the delegate can access, and then specify permissions for that folder.</span></span> <span data-ttu-id="44aee-132">代理人には、次のフォルダーへのアクセス権を与えることができます。</span><span class="sxs-lookup"><span data-stu-id="44aee-132">Delegates can be granted access to the following folders:</span></span> 
  
- <span data-ttu-id="44aee-133">予定表</span><span class="sxs-lookup"><span data-stu-id="44aee-133">Calendar</span></span>
    
- <span data-ttu-id="44aee-134">タスク</span><span class="sxs-lookup"><span data-stu-id="44aee-134">Tasks</span></span>
    
- <span data-ttu-id="44aee-135">受信トレイ</span><span class="sxs-lookup"><span data-stu-id="44aee-135">Inbox</span></span>
    
- <span data-ttu-id="44aee-136">連絡先</span><span class="sxs-lookup"><span data-stu-id="44aee-136">Contacts</span></span>
    
- <span data-ttu-id="44aee-137">メモ</span><span class="sxs-lookup"><span data-stu-id="44aee-137">Notes</span></span>
    
- <span data-ttu-id="44aee-138">ジャーナル</span><span class="sxs-lookup"><span data-stu-id="44aee-138">Journal</span></span>
    
<span data-ttu-id="44aee-p106">これらのフォルダーの 1 つ以上に対する代理人アクセスを持つユーザーは、フォルダーに設定されている[アクセス許可](#bk_delegateperms)に応じて、そのフォルダーおよび子フォルダー内のアイテムの作成、取得、更新、削除、コピー、検索ができます。アプリケーションがこれらのアクションを実行する方法は、[明示的な](#bk_explicit)アクセスと[暗黙的な](#bk_implicit)アクセスのどちらが必要かに応じて異なります。</span><span class="sxs-lookup"><span data-stu-id="44aee-p106">When a user has delegate access to one or more of these folders, they can create, get, update, delete, copy, and search for items in that folder and any child folders, depending on the [permissions](#bk_delegateperms) set on the folder. The way in which the application performs these actions depends on whether [explicit](#bk_explicit) or [implicit](#bk_implicit) access is required.</span></span> 
  
## <a name="delegate-permissions"></a><span data-ttu-id="44aee-141">代理アクセス権</span><span class="sxs-lookup"><span data-stu-id="44aee-141">Delegate permissions</span></span>
<span data-ttu-id="44aee-142"><a name="bk_delegateperms"> </a></span><span class="sxs-lookup"><span data-stu-id="44aee-142"></span></span>

<span data-ttu-id="44aee-143">管理者またはメールボックスの所有者がメールボックスに代理人を追加するときは、1 つ以上のフォルダーのアクセス許可レベルを設定することもできます。</span><span class="sxs-lookup"><span data-stu-id="44aee-143">When an administrator or mailbox owner adds a delegate to a mailbox, they can also set the permission level for one or more folders.</span></span> <span data-ttu-id="44aee-144">フォルダーのアクセス許可レベルが設定されていない場合、アクセス許可の値の既定値は、[なし] に設定されます。</span><span class="sxs-lookup"><span data-stu-id="44aee-144">If a permission level is not set for a folder, the permission value defaults to None.</span></span> <span data-ttu-id="44aee-145">あるフォルダーに対して複数のユーザーが同じアクセス許可レベルを持つことも、ユーザーが持つアクセス許可レベルをフォルダーごとに変えることもできます。</span><span class="sxs-lookup"><span data-stu-id="44aee-145">Multiple users can have the same permission level on a folder, and users can have different permission levels for different folders.</span></span> <span data-ttu-id="44aee-146">EWS マネージ API を使用する場合は、[DelegateUser.Permissions](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.delegateuser.permissions%28v=exchg.80%29.aspx) プロパティ (各フォルダーの [DelegateFolderPermissionLevel](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.delegatefolderpermissionlevel%28v=exchg.80%29.aspx) 列挙値の 1 つを指定する) を使用して、フォルダーに対する代理アクセス権を設定します。</span><span class="sxs-lookup"><span data-stu-id="44aee-146">If you're using the EWS Managed API, you use the [DelegateUser.Permissions](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.delegateuser.permissions%28v=exchg.80%29.aspx) property, which contains one of the [DelegateFolderPermissionLevel](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.delegatefolderpermissionlevel%28v=exchg.80%29.aspx) enumeration values for each folder, to set delegate permissions on folders.</span></span> <span data-ttu-id="44aee-147">EWS を使用する場合は、[DelegatePermissions](http://msdn.microsoft.com/library/292badc7-bab3-4368-9d7c-9a8b7edb279b%28Office.15%29.aspx) 要素を使用して代理アクセス権を設定し、[PermissionLevel](http://msdn.microsoft.com/library/87978600-3523-451e-a725-ef092c543e2a%28Office.15%29.aspx) 要素を使用してアクセス許可レベルを定義します。</span><span class="sxs-lookup"><span data-stu-id="44aee-147">If you're using EWS, you use the [DelegatePermissions](http://msdn.microsoft.com/library/292badc7-bab3-4368-9d7c-9a8b7edb279b%28Office.15%29.aspx) element to set delegate permissions, and the [PermissionLevel](http://msdn.microsoft.com/library/87978600-3523-451e-a725-ef092c543e2a%28Office.15%29.aspx) element to define the permission level.</span></span> 
  
<span data-ttu-id="44aee-148">**表 2. 代理アクセス権レベル**</span><span class="sxs-lookup"><span data-stu-id="44aee-148">**Table 2.  Delegate permission levels**</span></span>

|<span data-ttu-id="44aee-149">**アクセス許可レベル**</span><span class="sxs-lookup"><span data-stu-id="44aee-149">**Permission level**</span></span>|<span data-ttu-id="44aee-150">**説明**</span><span class="sxs-lookup"><span data-stu-id="44aee-150">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="44aee-151">なし</span><span class="sxs-lookup"><span data-stu-id="44aee-151">None</span></span>  <br/> |<span data-ttu-id="44aee-152">これはすべてのフォルダーの既定値です。</span><span class="sxs-lookup"><span data-stu-id="44aee-152">This is the default value for all folders.</span></span>  <br/> |
|<span data-ttu-id="44aee-153">Author</span><span class="sxs-lookup"><span data-stu-id="44aee-153">Author</span></span>  <br/> |<span data-ttu-id="44aee-154">代理人は、アイテムの読み取りと作成、自分が作成したアイテムの変更と削除ができます。</span><span class="sxs-lookup"><span data-stu-id="44aee-154">A delegate can read and create items, and modify and delete items they create.</span></span> <span data-ttu-id="44aee-155">たとえば、代理人はタスクの依頼や会議出席依頼をメールボックスの所有者のタスクのフォルダーまたは予定表のフォルダーに直接作成して、メールボックスの所有者の代わりにいずれかのアイテムを送信できます。</span><span class="sxs-lookup"><span data-stu-id="44aee-155">A delegate can read and create items, and modify and delete items they create. For example, a delegate can create task requests and meeting requests directly in the mailbox owner’s Task or Calendar folder, and then send either item on the mailbox owner’s behalf.</span></span>  <br/> |
|<span data-ttu-id="44aee-156">Editor (編集者)</span><span class="sxs-lookup"><span data-stu-id="44aee-156">Editor</span></span>  <br/> |<span data-ttu-id="44aee-157">代理人は、Author にできるすべてのことに加え、メールボックスの所有者が作成したアイテムの変更や削除もできます。</span><span class="sxs-lookup"><span data-stu-id="44aee-157">A delegate can do everything an Author can do, and also modify and delete the items the mailbox owner created.</span></span>  <br/> |
|<span data-ttu-id="44aee-158">Reviewer</span><span class="sxs-lookup"><span data-stu-id="44aee-158">Reviewer</span></span>  <br/> |<span data-ttu-id="44aee-159">代理人はアイテムを読むことができます。たとえば、Reviewer のアクセス許可を持つ代理人は、別のユーザーの受信トレイのメッセージを読むことができます。</span><span class="sxs-lookup"><span data-stu-id="44aee-159">A delegate can read items; for example a delegate with Reviewer permission can read messages in another person's Inbox.</span></span>  <br/> |
|<span data-ttu-id="44aee-160">Custom</span><span class="sxs-lookup"><span data-stu-id="44aee-160">Custom</span></span>  <br/> |<span data-ttu-id="44aee-161">メールボックスの所有者が代理人にアクセス許可のカスタム セットを与えている場合です。</span><span class="sxs-lookup"><span data-stu-id="44aee-161">The mailbox owner has granted a custom set of permissions to the delegate.</span></span>  <br/> |
   
<span data-ttu-id="44aee-162">[DelegateUser.ViewPrivateItems](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.delegateuser.viewprivateitems%28v=exchg.80%29.aspx) EWS マネージ API プロパティと [ViewPrivateItems](http://msdn.microsoft.com/library/80b949ac-440c-4a01-b428-ebafb5b1b802%28Office.15%29.aspx) EWS 要素は、メール、連絡先、予定表、タスク、メモ、ジャーナルのすべてのフォルダーを含む、メールボックス所有者のすべてのフォルダーに影響を与えるグローバルな設定です。</span><span class="sxs-lookup"><span data-stu-id="44aee-162">The [DelgateUser.ViewPrivateItemshttp://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.delegateuser.viewprivateitems(v=exchg.80).aspx](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.delegateuser.viewprivateitems%28v=exchg.80%29.aspx) EWS Managed API property and the [ViewPrivateItems](http://msdn.microsoft.com/library/80b949ac-440c-4a01-b428-ebafb5b1b802%28Office.15%29.aspx) EWS element is a global setting that affects all the mailbox owner’s folders, including all Mail, Contacts, Calendar, Tasks, Notes, and Journal folders. You cannot allow access to private items in only one folder.</span></span> <span data-ttu-id="44aee-163">1 つのフォルダーだけを選んで、その中の非公開アイテムへのアクセスを許可することはできません。</span><span class="sxs-lookup"><span data-stu-id="44aee-163">You cannot allow access to private items in only one folder.</span></span> 
  
## <a name="explicit-access"></a><span data-ttu-id="44aee-164">明示的なアクセス</span><span class="sxs-lookup"><span data-stu-id="44aee-164">Explicit access</span></span>
<span data-ttu-id="44aee-165"><a name="bk_explicit"> </a></span><span class="sxs-lookup"><span data-stu-id="44aee-165"></span></span>

<span data-ttu-id="44aee-p110">簡単に言えば、明示的なアクセスとは、代理人がメールボックス所有者のフォルダーまたはアイテムに対してアクションを実行するための通路のようなものです。代理人がサーバーへの要求にメールボックスの所有者のフォルダーの既知のフォルダー名とメールボックスの所有者の SMTP アドレスを含めると、代理人に明示的なアクセスが与えられます。このアクセスは明示的です。なぜなら、代理人の要求は、メソッドまたは操作のコンテキストがメールボックス所有者のメールボックスであって、代理人のメールボックスではないことを、明示的に示しているためです。</span><span class="sxs-lookup"><span data-stu-id="44aee-p110">Simply put, explicit access is the entry way for delegates to perform actions on a mailbox owner's folders or items. Explicit access is granted to a delegate when they include the well-known folder name for a mailbox owner's folder along with the mailbox owner's SMTP address in a request to the server. The access is explicit because the delegate's request explicitly states that the context for the method or operation is the mailbox owner's mailbox, and not the delegate's mailbox.</span></span>
  
<span data-ttu-id="44aee-p111">明示的なアクセスは、この先、フォルダーやアイテムで実行されるすべてのメソッドや操作のためにコンテキストを定義します。明示的なアクセスが設定されている場合に返されるすべてのアイテムとフォルダーの ID は、自らをメールボックスの所有者に属するものとして一意に識別します (ただし人間が読める形式ではありません)。こうして、アプリケーションはメールボックスの所有者の SMTP アドレスを繰り返し指定する必要がなくなります。コンテキストは識別子の中に隠されます。アイテムまたはフォルダーが識別された後、代理人はアイテムを変更するために、実際には[暗黙的なアクセス](#bk_implicit)を使用します。次の図に、明示的なアクセスと暗黙的なアクセスを行うプロセスを示します。</span><span class="sxs-lookup"><span data-stu-id="44aee-p111">Explicit access defines the context for all methods or operations performed on the folders or items moving forward. All item and folder IDs returned when the explicit access is set uniquely identify themselves as belonging to the mailbox owner (although not in any human readable format). This way, the application doesn't need to specify the mailbox owner's SMTP address again and again; the context is hidden in the identifiers. After an item or folder is identified, a delegate actually uses [implicit access](#bk_implicit) to modify the item. The following figure shows the process of getting explicit and implicit access.</span></span> 
  
<span data-ttu-id="44aee-174">**図 2. アイテムまたはフォルダーへの明示的および暗黙的なアクセスの要求**</span><span class="sxs-lookup"><span data-stu-id="44aee-174">**Figure 2.  Requesting explicit and implicit access to an item or folder**</span></span>

![アプリケーションが明示的なアクセスの要求を送信し、サーバーからの応答を受け取り、暗黙的なアクセスの要求を送信し、サーバーからの応答を受け取る流れを示した図。](media/Ex15_Delegate_ExplictImplicit.png)
  
<span data-ttu-id="44aee-p112">様々なシナリオで明示的なアクセスを設定できます。基本的に、フォルダー ID をメソッドまたは操作に入れて送信する場合は常に、明示的なアクセスを設定できます。これには、フォルダーの検索、予定の検索、アイテムの取得、会話の検索などがあります。</span><span class="sxs-lookup"><span data-stu-id="44aee-p112">You can set explicit access in many different scenarios. Essentially, any time you're sending a folder ID in a method or operation, you can set explicit access. This can include finding folders, finding appointments, getting items, finding conversations, and so on.</span></span>
  
### <a name="explicit-access-and-the-ews-managed-api"></a><span data-ttu-id="44aee-179">明示的なアクセスと EWS マネージ API</span><span class="sxs-lookup"><span data-stu-id="44aee-179">Explicit access and the EWS Managed API</span></span>
<span data-ttu-id="44aee-180"><a name="bk_explicitewsma"> </a></span><span class="sxs-lookup"><span data-stu-id="44aee-180"></span></span>

<span data-ttu-id="44aee-181">[FolderId](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.folderid%28v=exchg.80%29.aspx) 入力パラメーターでターゲット フォルダーを指定する次のオーバーロードされたメソッドのいずれかを使用すれば、明示的な代理人アクセスを開始できます。</span><span class="sxs-lookup"><span data-stu-id="44aee-181">You can initiate explicit delegate access by using any of the following overloaded methods that take a [FolderIdhttp://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.folderid(v=exchg.80).aspx](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.folderid%28v=exchg.80%29.aspx) input parameter to identify the target folder:</span></span> 
  
- [<span data-ttu-id="44aee-182">Folder.Bind</span><span class="sxs-lookup"><span data-stu-id="44aee-182">Folder.Bind</span></span>](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.folder.bind%28v=exchg.80%29.aspx)
    
- [<span data-ttu-id="44aee-183">ExchangeService.FindItems</span><span class="sxs-lookup"><span data-stu-id="44aee-183">ExchangeService.FindItems</span></span>](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.exchangeservice.finditems%28v=exchg.80%29.aspx)
    
- [<span data-ttu-id="44aee-184">ExchangeService.FindAppointments</span><span class="sxs-lookup"><span data-stu-id="44aee-184">ExchangeService.FindAppointments</span></span>](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.exchangeservice.findappointments%28v=exchg.80%29.aspx)
    
- [<span data-ttu-id="44aee-185">ExchangeService.FindFolders</span><span class="sxs-lookup"><span data-stu-id="44aee-185">ExchangeService.FindFolders</span></span>](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.exchangeservice.findfolders%28v=exchg.80%29.aspx)
    
- <span data-ttu-id="44aee-186">その他多数。</span><span class="sxs-lookup"><span data-stu-id="44aee-186">And more!</span></span>
    
<span data-ttu-id="44aee-187">これらの各メソッドで **FolderId** パラメーターを使用して、次のようにメールボックス所有者のターゲット フォルダーを指定できます。</span><span class="sxs-lookup"><span data-stu-id="44aee-187">You can use the **FolderId** parameter in each of these methods to identify the mailbox owner's target folder, as follows.</span></span> 
  
```cs
new FolderId(WellKnownFolderName.Calendar, "primary@contoso.com");
```

<span data-ttu-id="44aee-188">たとえば、予定表フォルダーにバインドするには、次の **Bind** メソッドの **FolderId** で既知のフォルダー名とメールボックス所有者の SMTP アドレスを指定します。</span><span class="sxs-lookup"><span data-stu-id="44aee-188">For example, to bind to the Calendar folder, the **FolderId** in this **Bind** method specifies the well-known folder name, and the mailbox owner’s SMTP address.</span></span> 
  
```cs
CalendarFolder calendar = CalendarFolder.Bind(service, new FolderId(WellKnownFolderName.Calendar, "primary@contoso.com"), new PropertySet());
```

<span data-ttu-id="44aee-p113">既知のフォルダー名と SMTP アドレスを指定すると、代理人はメールボックス所有者の予定表フォルダーにバインドできるため、フォルダーへの明示的なアクセスを取得できます。これ以降、フォルダー内のアイテムに対する[暗黙的なアクセス](#bk_implicit)のすべての要求では、アイテム ID とフォルダー ID で返されるコンテキストを利用します。基本的に、識別子には暗黙的な代理人アクセスの呼び出しのコンテキストが含まれています。または、特定の条件を満たすアイテムのアイテム ID を取得するには、以下を使用します。</span><span class="sxs-lookup"><span data-stu-id="44aee-p113">By specifying the well-known folder name and the SMTP address, the delegate can bind to the mailbox owner's Calendar folder — thereby gaining explicit access to the folder. All subsequent requests for [implicit access](#bk_implicit) to items in the folder then rely on the context returned in the item IDs and folder IDs. Essentially, the identifiers contain the context for the implied delegate access calls. Or, to retrieve the item ID of an item that meets specific criteria, use the following.</span></span> 
  
```cs
FindItemsResults<Item> results = service.FindItems(new FolderId(WellKnownFolderName.Calendar, "primary@contoso.com"), filter, view);
```

<span data-ttu-id="44aee-193">この場合、アイテム ID が返された後、このアイテム ID を使用すれば、代理人は暗黙的なアクセスでアイテムを変更できます。</span><span class="sxs-lookup"><span data-stu-id="44aee-193">In this case the item ID is returned, and then the delegate can then use implicit access to make changes to the item by using the item ID.</span></span>
  
<span data-ttu-id="44aee-194">既存の明示的なアクセスでアクセスしていないアイテム ID またはフォルダー ID が必要になるまで、明示的なアクセスをもう一度開始する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="44aee-194">You don’t have to initiate explicit access again until you require an item ID or a folder ID that you didn’t access via the existing explicit access.</span></span> 
  
### <a name="explicit-access-and-ews"></a><span data-ttu-id="44aee-195">明示的なアクセスと EWS</span><span class="sxs-lookup"><span data-stu-id="44aee-195">Explicit access and EWS</span></span>
<span data-ttu-id="44aee-196"><a name="bk_explicitewsma"> </a></span><span class="sxs-lookup"><span data-stu-id="44aee-196"></span></span>

<span data-ttu-id="44aee-p114">[GetFolder](http://msdn.microsoft.com/library/355bcf93-dc71-4493-b177-622afac5fdb9%28Office.15%29.aspx)、[FindItem](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx)、または [FindFolder](http://msdn.microsoft.com/library/7a9855aa-06cc-45ba-ad2a-645c15b7d031%28Office.15%29.aspx) 操作を使用して、明示的なアクセスを開始できます。これらの操作は、[DistinguishedFolderId](http://msdn.microsoft.com/library/50018162-2941-4227-8a5b-d6b4686bb32f%28Office.15%29.aspx) 要素を使用して対象フォルダーを指定するオプションを提供します。**DistinguishedFolderId** 要素には省略可能な子要素が 1 つだけあります。すなわち、[Mailbox](http://msdn.microsoft.com/library/befc70fd-51cb-4258-884c-80c9050f0e82%28Office.15%29.aspx) 要素です。**Mailbox** 要素は、**DistinguishedFolderId** 要素の子として使用する場合、代理人がアクセスするメールボックスを指定します。呼び出し元のユーザーにメールボックス所有者のフォルダーにアクセスする権限がある場合、応答にはそのメールボックス内のアイテムまたはフォルダーの識別子のコレクションが含まれます。応答で返されるアイテムおよびフォルダーの識別子を暗黙的な代理人アクセスで使用できます。 </span><span class="sxs-lookup"><span data-stu-id="44aee-p114">You can initiate explicit access by using the [GetFolder](http://msdn.microsoft.com/library/355bcf93-dc71-4493-b177-622afac5fdb9%28Office.15%29.aspx), [FindItem](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx), or [FindFolder](http://msdn.microsoft.com/library/7a9855aa-06cc-45ba-ad2a-645c15b7d031%28Office.15%29.aspx) operations. These operations provide the option to use the [DistinguishedFolderId](http://msdn.microsoft.com/library/50018162-2941-4227-8a5b-d6b4686bb32f%28Office.15%29.aspx) element to identify the target folder. The **DistinguishedFolderId** element has a single optional child element, the [Mailbox](http://msdn.microsoft.com/library/befc70fd-51cb-4258-884c-80c9050f0e82%28Office.15%29.aspx) element. The **Mailbox** element, when used as a child of the **DistinguishedFolderId** element, specifies the mailbox for the delegate to access. If the calling user has permission to access the mailbox owner's folder, the response will contain a collection of identifiers to items or folders in that mailbox. The item and folder identifiers that are returned in the response can be used for implicit delegate access.</span></span> 
  
## <a name="implicit-access"></a><span data-ttu-id="44aee-203">暗黙的なアクセス</span><span class="sxs-lookup"><span data-stu-id="44aee-203">Implicit access</span></span>
<span data-ttu-id="44aee-204"><a name="bk_implicit"> </a></span><span class="sxs-lookup"><span data-stu-id="44aee-204"></span></span>

<span data-ttu-id="44aee-p115">代理人がメールボックスの所有者のメールボックス内のアイテムまたはフォルダーの ID を取得したら、アイテムの更新、削除、またはコピーを行うとき、後は暗黙的なアクセスが使用されます。代理人が要求でそのアイテム ID またはフォルダー ID を使用すると、メールボックス所有者のメールボックス内のアイテムに対して変更が加えられます。代理人はメールボックス所有者の SMTP アドレスを含める必要はありません。 </span><span class="sxs-lookup"><span data-stu-id="44aee-p115">Implicit access is used after a delegate has retrieved the ID for an item or folder in the mailbox owner's mailbox and the delegate wants to update, delete, or copy the item. When the delegate uses that item or folder ID in a request, the changes are made to the item in the mailbox owner's mailbox. The delegate does not have to include the mailbox owner's SMTP address.</span></span> 
  
<span data-ttu-id="44aee-p116">たとえば、代理人がメールボックス所有者のいずれかのフォルダーの ID を持っている場合、フォルダー ID を使用すれば、そのフォルダーに対して **FindItem** 操作を実行でき、メールボックス所有者のメールボックスを明示的に指定する必要はありません。その時点で、代理人は応答で返される ID を使用して、メールボックス所有者のフォルダーにアクションを実行できます。</span><span class="sxs-lookup"><span data-stu-id="44aee-p116">For example, when a delegate has the ID of one of the mailbox owner's folders, the delegate can perform a **FindItem** operation on that folder by using the folder ID, without explicitly identifying the mailbox owner's mailbox. At that point, the delegate can perform actions on the mailbox owner's folder by using the IDs that are returned in the responses.</span></span> 
  
### <a name="implicit-access-and-the-ews-managed-api"></a><span data-ttu-id="44aee-210">暗黙的なアクセスと EWS マネージ API</span><span class="sxs-lookup"><span data-stu-id="44aee-210">Implicit access and the EWS Managed API</span></span>

<span data-ttu-id="44aee-211">[FindItems](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.exchangeservice.finditems%28v=exchg.80%29.aspx) メソッドでアイテム ID を取得したら、後続の [Item.Bind](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.item.bind%28v=exchg.80%29.aspx) メソッドの呼び出しでそのアイテム ID を使用し、アイテムにバインドできます。</span><span class="sxs-lookup"><span data-stu-id="44aee-211">If an item ID was retrieved by the [FindItems](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.exchangeservice.finditems%28v=exchg.80%29.aspx) method, that item ID can be used in a subsequent [Item.Bind](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.item.bind%28v=exchg.80%29.aspx) method call to bind to the item.</span></span> <span data-ttu-id="44aee-212">次いで、タスクを完了するために必要な [Item.Update](http://msdn.microsoft.com/ja-JP/library/office/microsoft.exchange.webservices.data.item.update%28v=exchg.80%29.aspx)、[Item.Delete](http://msdn.microsoft.com/ja-JP/library/office/microsoft.exchange.webservices.data.item.delete%28v=exchg.80%29.aspx)、[Item.Copy](http://msdn.microsoft.com/ja-JP/library/office/microsoft.exchange.webservices.data.item.copy%28v=exchg.80%29.aspx) メソッド (あるいは、アイテム ID を必要とする任意のメソッド呼び出し) を呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="44aee-212">You can then call the [Item.Update](http://msdn.microsoft.com/ja-JP/library/office/microsoft.exchange.webservices.data.item.update%28v=exchg.80%29.aspx), [Item.Delete](http://msdn.microsoft.com/ja-JP/library/office/microsoft.exchange.webservices.data.item.delete%28v=exchg.80%29.aspx), or [Item.Copy](http://msdn.microsoft.com/ja-JP/library/office/microsoft.exchange.webservices.data.item.copy%28v=exchg.80%29.aspx) method — or any method call that requires an item ID — as needed to complete your task.</span></span> <span data-ttu-id="44aee-213">アイテムを含むフォルダー (および該当する場合は、アイテムの移動先のフォルダー) の適切なアクセス許可を持っているなら、代理人はアクセス許可レベルに応じて変更を実行できます。</span><span class="sxs-lookup"><span data-stu-id="44aee-213">As long as the delegate has appropriate permissions to the folder that contains the item (and, if applicable, the folder the item is moving to), the delegate can make changes according to their permission levels.</span></span> 
  
### <a name="implicit-access-and-ews"></a><span data-ttu-id="44aee-214">暗黙的なアクセスと EWS</span><span class="sxs-lookup"><span data-stu-id="44aee-214">Implicit access and EWS</span></span>

<span data-ttu-id="44aee-p118">[FindItem](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx) 操作でアイテム ID を取得したら、後続の [GetItem](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) 操作でそのアイテム ID を使用して、アイテムにバインドできます。次いで、タスクを完了するために必要な [UpdateItem](http://msdn.microsoft.com/library/5d027523-e0bc-4da2-b60b-0cb9fc1fdfe4%28Office.15%29.aspx)、[DeleteItem](../web-service-reference/deleteitem-operation.md)、[CopyItem](http://msdn.microsoft.com/library/bcc68f9e-d511-4c29-bba6-ed535524624a%28Office.15%29.aspx) 操作 (あるいはアイテム ID を必要とする任意の操作) を呼び出すことができます。アイテムを含むフォルダー (および該当する場合は、アイテムの移動先のフォルダー) の適切なアクセス許可を持っているなら、代理人はアクセス許可レベルに応じて変更を実行できます。</span><span class="sxs-lookup"><span data-stu-id="44aee-p118">If an item ID was retrieved by the [FindItem](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx) operation, that item ID can be used in subsequent [GetItem](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) operations to bind to the item. You can then call the [UpdateItem](http://msdn.microsoft.com/library/5d027523-e0bc-4da2-b60b-0cb9fc1fdfe4%28Office.15%29.aspx), [DeleteItem](../web-service-reference/deleteitem-operation.md), or [CopyItem](http://msdn.microsoft.com/library/bcc68f9e-d511-4c29-bba6-ed535524624a%28Office.15%29.aspx) operation — or any operation that requires an item ID — as needed to complete your task. As long as the delegate has appropriate permissions to the folder that contains the item (and, if applicable, the folder the item is moving to), the delegate can make changes according to their permission levels.</span></span> 
  
## <a name="in-this-section"></a><span data-ttu-id="44aee-218">このセクションの内容</span><span class="sxs-lookup"><span data-stu-id="44aee-218">In this section</span></span>
<span data-ttu-id="44aee-219"><a name="bk_implicit"> </a></span><span class="sxs-lookup"><span data-stu-id="44aee-219"></span></span>

- [<span data-ttu-id="44aee-220">Exchange で EWS を使用して代理人を追加および削除する</span><span class="sxs-lookup"><span data-stu-id="44aee-220">How to: Add and remove delegates by using EWS in Exchange</span></span>](how-to-add-and-remove-delegates-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="44aee-221">Exchange で EWS を使用して予定表に代理人としてアクセスする</span><span class="sxs-lookup"><span data-stu-id="44aee-221">How to: Access a calendar as a delegate by using EWS in Exchange</span></span>](how-to-access-a-calendar-as-a-delegate-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="44aee-222">Exchange で EWS を使用して、代理人として連絡先にアクセスする</span><span class="sxs-lookup"><span data-stu-id="44aee-222">How to: Access contacts as a delegate by using EWS in Exchange</span></span>](how-to-access-contacts-as-a-delegate-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="44aee-223">Exchange で EWS を使用して、代理人としてメールにアクセスする</span><span class="sxs-lookup"><span data-stu-id="44aee-223">How to: Access email as a delegate by using EWS in Exchange</span></span>](how-to-access-email-as-a-delegate-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="44aee-224">Exchange で EWS を使用して別のユーザーのフォルダーのアクセス許可を設定する</span><span class="sxs-lookup"><span data-stu-id="44aee-224">How to: Set folder permissions for another user by using EWS in Exchange</span></span>](how-to-set-folder-permissions-for-another-user-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="44aee-225">Exchange の EWS での委任に関連するエラーの処理</span><span class="sxs-lookup"><span data-stu-id="44aee-225">Handling delegation-related errors in EWS in Exchange</span></span>](handling-delegation-related-errors-in-ews-in-exchange.md)
    
## <a name="see-also"></a><span data-ttu-id="44aee-226">関連項目</span><span class="sxs-lookup"><span data-stu-id="44aee-226">See also</span></span>


- [<span data-ttu-id="44aee-227">Exchange の Web サービス クライアントを開発する</span><span class="sxs-lookup"><span data-stu-id="44aee-227">Develop web service clients for Exchange</span></span>](develop-web-service-clients-for-exchange.md)
    
- [<span data-ttu-id="44aee-228">自分のメールと予定表の管理を他のユーザーに許可する</span><span class="sxs-lookup"><span data-stu-id="44aee-228">Allow someone else to manage your mail and calendarhttp://office.microsoft.com/ja-JP/outlook-help/allow-someone-else-to-manage-your-mail-and-calendar-HA102749417.aspx</span></span>](http://office.microsoft.com/ja-JP/outlook-help/allow-someone-else-to-manage-your-mail-and-calendar-HA102749417.aspx)
    
- [<span data-ttu-id="44aee-229">Add- MailboxPermission</span><span class="sxs-lookup"><span data-stu-id="44aee-229">Add- MailboxPermission</span></span>](http://technet.microsoft.com/ja-JP/library/bb124097%28v=exchg.150%29.aspx)
    

