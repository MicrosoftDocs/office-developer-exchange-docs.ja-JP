---
title: Exchange Online と Exchange オンプレミス クライアントでのプログラミングの比較
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: 3c2eabe4-52bc-461e-a6dd-f65f22f16e50
description: Exchange Online および Exchange オンプレミスに対して動作する EWS マネージ API または EWS クライアント アプリケーションを作成するための設計に関する考慮事項について説明します。
ms.openlocfilehash: 8b4dbae5cadfed377aa3a7179144a7cea68bc35c
ms.sourcegitcommit: 88ec988f2bb67c1866d06b361615f3674a24e795
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/31/2020
ms.locfileid: "44456165"
---
# <a name="comparing-exchange-online-and-exchange-on-premises-client-programming"></a><span data-ttu-id="cb15d-103">Exchange Online と Exchange オンプレミス クライアントでのプログラミングの比較</span><span class="sxs-lookup"><span data-stu-id="cb15d-103">Comparing Exchange Online and Exchange on-premises client programming</span></span>

<span data-ttu-id="cb15d-104">Exchange Online および Exchange オンプレミスに対して動作する EWS マネージ API または EWS クライアント アプリケーションを作成するための設計に関する考慮事項について説明します。</span><span class="sxs-lookup"><span data-stu-id="cb15d-104">Learn about the design considerations for creating an EWS Managed API or EWS client application that works against Exchange Online and Exchange on-premises.</span></span>
  
<span data-ttu-id="cb15d-105">ほとんどの場合、対象とするクライアントおよび Exchange の Web サービスは、対象が Exchange Online、Office 365 の一部としての Exchange Online、または Exchange オンプレミス サーバーかどうかに関係なく、同様に動作します。</span><span class="sxs-lookup"><span data-stu-id="cb15d-105">For the most part, clients and the web services in Exchange they target will work the same way regardless of whether the target is an Exchange Online, Exchange Online as part of Office 365, or Exchange on-premises server.</span></span> <span data-ttu-id="cb15d-106">ただし、いくつかの例外があり、アプリケーションがそれらの例外を処理できることを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="cb15d-106">There are, however, some exceptions, and you'll want to make sure that your application can handle them.</span></span> <span data-ttu-id="cb15d-107">この記事の情報は、Exchange Online および Exchange オンプレミスの両方を対象とするクライアントを設計する際に役立ちます。</span><span class="sxs-lookup"><span data-stu-id="cb15d-107">Use the information in this article to help you design your client to target both Exchange Online and Exchange on-premises.</span></span>

<span data-ttu-id="cb15d-108"><a name="autodiscover"> </a></span><span class="sxs-lookup"><span data-stu-id="cb15d-108"><a name="autodiscover"> </a></span></span>

## <a name="autodiscover-client-programming-considerations"></a><span data-ttu-id="cb15d-109">自動検出クライアント プログラミングに関する考慮事項</span><span class="sxs-lookup"><span data-stu-id="cb15d-109">Autodiscover client programming considerations</span></span>

<span data-ttu-id="cb15d-p102">[自動検出](autodiscover-for-exchange.md) は、Exchange クライアントの構成情報を提供します。クライアント アプリケーションは、クライアントが Exchange Online と Exchange オンプレミスのどちらを対象にしているかに応じて、次の 3 つの方法のいずれかで構成情報を検出できます。</span><span class="sxs-lookup"><span data-stu-id="cb15d-p102">[Autodiscover](autodiscover-for-exchange.md) provides configuration information for Exchange clients. A client application can discover its configuration information in one of three ways, depending on whether the client is targeting Exchange Online or Exchange on-premises.</span></span> 
  
<span data-ttu-id="cb15d-112">**表 1. 自動検出サービスの種類と Exchange の適用性**</span><span class="sxs-lookup"><span data-stu-id="cb15d-112">**Table 1. Autodiscover service types and Exchange applicability**</span></span>

|<span data-ttu-id="cb15d-113">**自動検出サービスの種類**</span><span class="sxs-lookup"><span data-stu-id="cb15d-113">**Autodiscover service type**</span></span>|<span data-ttu-id="cb15d-114">**適用対象**</span><span class="sxs-lookup"><span data-stu-id="cb15d-114">**Applies to**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="cb15d-115">SOAP 自動検出</span><span class="sxs-lookup"><span data-stu-id="cb15d-115">SOAP Autodiscover</span></span>](autodiscover-for-exchange.md#bk_Options) <br/> |<span data-ttu-id="cb15d-116">Exchange Online および Exchange 2010 以降のバージョンの Exchange オンプレミス</span><span class="sxs-lookup"><span data-stu-id="cb15d-116">Exchange Online and versions of Exchange on-premises starting with Exchange 2010</span></span>  <br/> |
|[<span data-ttu-id="cb15d-117">POX 自動検出</span><span class="sxs-lookup"><span data-stu-id="cb15d-117">POX Autodiscover</span></span>](autodiscover-for-exchange.md#bk_Options) <br/> |<span data-ttu-id="cb15d-118">Exchange Online および Exchange 2007 以降のバージョンの Exchange オンプレミス</span><span class="sxs-lookup"><span data-stu-id="cb15d-118">Exchange Online and versions of Exchange on-premises starting with Exchange 2007</span></span>  <br/> |
|[<span data-ttu-id="cb15d-119">サービス接続ポイント (SCP) の検索</span><span class="sxs-lookup"><span data-stu-id="cb15d-119">Service connection point (SCP) lookup</span></span>](how-to-find-autodiscover-endpoints-by-using-scp-lookup-in-exchange.md) <br/> |<span data-ttu-id="cb15d-120">Exchange 2007 以降のバージョンの Exchange オンプレミス</span><span class="sxs-lookup"><span data-stu-id="cb15d-120">Versions of Exchange on-premises starting with Exchange 2007</span></span>  <br/> |
   
<span data-ttu-id="cb15d-p103">クライアント構成情報だけでなく、SOAP および POX の自動検出は Exchange サービス バージョンも返し、そのサービスが Exchange Online によってホストされているかどうかを示します。使用している自動検出の種類に応じて、この情報はさまざまな要素で返されます。</span><span class="sxs-lookup"><span data-stu-id="cb15d-p103">In addition to the client configuration information, that SOAP and POX Autodiscover also return the Exchange service version and indicate whether the service is hosted by Exchange Online. This information is returned in different elements, depending on the type of Autodiscover you use.</span></span>
  
<span data-ttu-id="cb15d-123">**表 2. サービス バージョンを返す自動検出の要素と Exchange Online ホスティング情報**</span><span class="sxs-lookup"><span data-stu-id="cb15d-123">**Table 2. Autodiscover elements that return service version and Exchange Online hosting information**</span></span>

|<span data-ttu-id="cb15d-124">**自動検出サービスの種類**</span><span class="sxs-lookup"><span data-stu-id="cb15d-124">**Autodiscover service type**</span></span>|<span data-ttu-id="cb15d-125">**サービス バージョンを格納する XML 要素**</span><span class="sxs-lookup"><span data-stu-id="cb15d-125">**XML element that contains service version**</span></span>|<span data-ttu-id="cb15d-126">**ユーザーが Exchange Online アカウントを持っているかどうかを示す XML 要素**</span><span class="sxs-lookup"><span data-stu-id="cb15d-126">**XML element that indicates whether the user has an Exchange Online account**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="cb15d-127">SOAP 自動検出</span><span class="sxs-lookup"><span data-stu-id="cb15d-127">SOAP Autodiscover</span></span>  <br/> |<span data-ttu-id="cb15d-128">**CasVersion** テキスト値を持つ [設定 (SOAP)](https://msdn.microsoft.com/library/43db26e1-f7be-49fd-b26b-fc1b10bd3458%28Office.15%29.aspx) 要素</span><span class="sxs-lookup"><span data-stu-id="cb15d-128">[Setting (SOAP)](https://msdn.microsoft.com/library/43db26e1-f7be-49fd-b26b-fc1b10bd3458%28Office.15%29.aspx) element with the **CasVersion** text value.</span></span>  <br/> |<span data-ttu-id="cb15d-129">**UserMSOnline** テキスト値を持つ [設定 (SOAP)](https://msdn.microsoft.com/library/43db26e1-f7be-49fd-b26b-fc1b10bd3458%28Office.15%29.aspx) 要素</span><span class="sxs-lookup"><span data-stu-id="cb15d-129">[Setting (SOAP)](https://msdn.microsoft.com/library/43db26e1-f7be-49fd-b26b-fc1b10bd3458%28Office.15%29.aspx) element with the **UserMSOnline** text value.</span></span>  <br/> |
|<span data-ttu-id="cb15d-130">POX 自動検出</span><span class="sxs-lookup"><span data-stu-id="cb15d-130">POX Autodiscover</span></span>  <br/> |[<span data-ttu-id="cb15d-131">ServerVersion (POX)</span><span class="sxs-lookup"><span data-stu-id="cb15d-131">ServerVersion (POX)</span></span>](https://msdn.microsoft.com/library/2c0bc41c-2452-4fc8-a19c-0e85f9fdbc4a%28Office.15%29.aspx) <br/> |<span data-ttu-id="cb15d-132">**MicrosoftOnline**</span><span class="sxs-lookup"><span data-stu-id="cb15d-132">**MicrosoftOnline**</span></span> <br/> |
   
<span data-ttu-id="cb15d-133">クライアントがこの情報を確実に取り込むようにして、Exchange サーバーで利用可能な[機能セット](web-service-api-feature-availability-in-exchange-and-the-ews-managed-api.md)を対象にできるようにします。</span><span class="sxs-lookup"><span data-stu-id="cb15d-133">Ensure that your client captures this information so that it can target the [feature set](web-service-api-feature-availability-in-exchange-and-the-ews-managed-api.md) that is available on the Exchange server.</span></span> <span data-ttu-id="cb15d-134">これは、ユーザーのメールボックスが Exchange Online にあるか、または Exchange オンプレミス組織にあるかに基づいた別々の動作をクライアントが予期することができるかどうかを判別するのに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="cb15d-134">This can be useful to determine whether your client can expect different behavior based on whether the user's mailbox is located in an Exchange Online or Exchange on-premises organization.</span></span> 

<span data-ttu-id="cb15d-135"><a name="testing"> </a></span><span class="sxs-lookup"><span data-stu-id="cb15d-135"><a name="testing"> </a></span></span>

## <a name="testing-and-log-files-in-applications-that-target-exchange-online"></a><span data-ttu-id="cb15d-136">Exchange Online を対象とするアプリケーションのテストおよびログ ファイル</span><span class="sxs-lookup"><span data-stu-id="cb15d-136">Testing and log files in applications that target Exchange Online</span></span>

<span data-ttu-id="cb15d-137">Exchange Online は、EWS のプロトコル ログ ファイル、EWS のパフォーマンス カウンターへのアクセス、およびオンプレミスの Exchange サーバーで利用可能な EWS 関連サービス イベントへのアクセスを提供しません。</span><span class="sxs-lookup"><span data-stu-id="cb15d-137">Exchange Online does not provide access to the EWS protocol log files, EWS performance counters, and EWS-related service events that are available on on-premises Exchange servers.</span></span> <span data-ttu-id="cb15d-138">ただし、これらへのアクセスは、アプリケーションが EWS と対話するときにどのように実行されるかを判別するのに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="cb15d-138">Access to these is useful, however, in discovering how your application performs when it interacts with EWS.</span></span> <span data-ttu-id="cb15d-139">テスト用の Exchange オンプレミス サーバーに対してアプリケーションを必ずテストして、そのパフォーマンスを最適化できるようにします。</span><span class="sxs-lookup"><span data-stu-id="cb15d-139">Make sure that you test your application against a test Exchange on-premise server so that you can optimize its performance.</span></span> <span data-ttu-id="cb15d-140">可能であれば、Exchange Online の調整設定に一致するように、テスト サーバーで[調整設定を変更する](https://technet.microsoft.com/library/bb232205%28v=exchg.150%29.aspx#Policies)ことができます。これにより、Exchange Online に接続したときのアプリケーションの動作を検証できます。</span><span class="sxs-lookup"><span data-stu-id="cb15d-140">If possible, you can [change the throttling settings](https://technet.microsoft.com/library/bb232205%28v=exchg.150%29.aspx#Policies) on your test server to match the throttling settings for Exchange Online, so you can evaluate how your application will behave when it connects to Exchange Online.</span></span> 
  
> [!TIP]
> <span data-ttu-id="cb15d-141">[EWSRelentless](https://ewsrelentless.codeplex.com/) ツールを使用して、EWS の負荷テストを実行できます。</span><span class="sxs-lookup"><span data-stu-id="cb15d-141">You can use the [EWSRelentless](https://ewsrelentless.codeplex.com/) tool to perform an EWS load test.</span></span> <span data-ttu-id="cb15d-142">テスト サーバー、EWS プロトコル ログ、EWS パフォーマンス カウンター、サービス イベント、および EWS 調整設定でこのツールを使用すると、負荷がある状態で EWS がどのように動作するかについて理解を深めることができます。</span><span class="sxs-lookup"><span data-stu-id="cb15d-142">You can use this tool with a test server, the EWS protocol logs, EWS performance counters, service events, and the EWS throttling settings to better understand how EWS performs under load.</span></span> 

<span data-ttu-id="cb15d-143"><a name="throttling"> </a></span><span class="sxs-lookup"><span data-stu-id="cb15d-143"><a name="throttling"> </a></span></span>

## <a name="throttling-settings-and-exchange-online"></a><span data-ttu-id="cb15d-144">調整設定と Exchange Online</span><span class="sxs-lookup"><span data-stu-id="cb15d-144">Throttling settings and Exchange Online</span></span>

<span data-ttu-id="cb15d-p107">[EWS 調整設定](ews-throttling-in-exchange.md)の Exchange Online の既定値は、Exchange オンプレミスの既定値とは異なります。また、Exchange Online の調整設定は変更できません。Exchange 管理シェル コマンドレットを使用すると、Exchange オンプレミスの調整設定を検出できます。ただし、これらのコマンドレットは、Exchange Online では有効ではありません。</span><span class="sxs-lookup"><span data-stu-id="cb15d-p107">The default values for the [EWS throttling settings](ews-throttling-in-exchange.md) are different for Exchange Online than they are for Exchange on-premises. Also, you cannot change Exchange Online throttling settings. You can use Exchange Management Shell cmdlets to discover the throttling settings for Exchange on-premises; however, those cmdlets are not enabled for Exchange Online.</span></span> 

<span data-ttu-id="cb15d-148"><a name="ems"> </a></span><span class="sxs-lookup"><span data-stu-id="cb15d-148"><a name="ems"> </a></span></span>

## <a name="exchange-management-shell-cmdlets-and-configuration-settings"></a><span data-ttu-id="cb15d-149">Exchange 管理シェルのコマンドレットと構成設定</span><span class="sxs-lookup"><span data-stu-id="cb15d-149">Exchange Management Shell cmdlets and configuration settings</span></span>

<span data-ttu-id="cb15d-p108">コマンドレットの多くは、Exchange Online および Exchange オンプレミスの Web サービス API に直接または間接的に影響を与える可能性があります。コマンドレットは、Exchange Online で以下には利用できません。</span><span class="sxs-lookup"><span data-stu-id="cb15d-p108">A number of cmdlets can directly or indirectly affect the web service APIs in Exchange Online and Exchange on-premises. Cmdlets are not available for the following in Exchange Online:</span></span>
  
- <span data-ttu-id="cb15d-152">調整設定</span><span class="sxs-lookup"><span data-stu-id="cb15d-152">Throttling settings</span></span> 
    
- <span data-ttu-id="cb15d-153">仮想ディレクトリ設定</span><span class="sxs-lookup"><span data-stu-id="cb15d-153">Virtual directory settings</span></span> 
    
- <span data-ttu-id="cb15d-154">認証設定</span><span class="sxs-lookup"><span data-stu-id="cb15d-154">Authentication settings</span></span>
    
<span data-ttu-id="cb15d-155">Exchange Online で利用可能なコマンドレットの詳細については、「[Exchange Online の PowerShell コマンドレット](http://help.outlook.com/140/dd575549.aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="cb15d-155">For details about the cmdlets that are available for Exchange Online, see [PowerShell cmdlets in Exchange Online](http://help.outlook.com/140/dd575549.aspx).</span></span> <span data-ttu-id="cb15d-156">Exchange オンプレミスで使用可能なコマンドレットの詳細については、「[Exchange 2013 コマンドレット](https://technet.microsoft.com/library/bb124413%28v=exchg.150%29.aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="cb15d-156">For more about cmdlets that are available for Exchange on-premises, see [Exchange 2013 cmdlets](https://technet.microsoft.com/library/bb124413%28v=exchg.150%29.aspx).</span></span>
  
## <a name="client-affinity-and-network-load-balancers"></a><span data-ttu-id="cb15d-157">クライアント アフィニティとネットワーク負荷分散装置</span><span class="sxs-lookup"><span data-stu-id="cb15d-157">Client affinity and network load balancers</span></span>
<span data-ttu-id="cb15d-158"><a name="affinity"> </a></span><span class="sxs-lookup"><span data-stu-id="cb15d-158"><a name="affinity"> </a></span></span>

<span data-ttu-id="cb15d-p110">ほとんどの EWS 通信では、Exchange とのアフィニティを維持するためにクライアントが参加する必要はありません。メールボックス イベントへのサブスクリプションには、クライアントが Cookie およびその他の情報を提供して、ユーザーのメールボックス イベントのキューを維持する Exchange サーバーとのアフィニティを維持する必要があります。Exchange Server 2010 は、exchangecookie を使用して、ネットワーク負荷分散装置間でクライアント アフィニティを維持します。Exchange Online および Exchange 2013 以降のバージョンの Exchange オンプレミスは、[X-AnchorMailbox ヘッダー、X-PreferServerAffinity ヘッダー、および X-BackEndOverrideCookie Cookie](how-to-maintain-affinity-between-group-of-subscriptions-and-mailbox-server.md#bk_howmaintained) を使用して、メールボックスの通知のアフィニティを維持します。</span><span class="sxs-lookup"><span data-stu-id="cb15d-p110">Most EWS communication does not require that the client participate in maintaining affinity with Exchange. The subscriptions to mailbox events do require that the client provide cookies and other information to maintain affinity with the Exchange server that maintains the queue of mailbox events for a user. Exchange Server 2010 uses the exchangecookie to maintain client affinity across the network load balancers. Exchange Online and versions of Exchange on-premises starting with Exchange 2013 use the [X-AnchorMailbox header, X-PreferServerAffinity header, and X-BackEndOverrideCookie cookie](how-to-maintain-affinity-between-group-of-subscriptions-and-mailbox-server.md#bk_howmaintained) to maintain affinity for mailbox notifications.</span></span> 
  
## <a name="authentication"></a><span data-ttu-id="cb15d-163">認証</span><span class="sxs-lookup"><span data-stu-id="cb15d-163">Authentication</span></span>
<span data-ttu-id="cb15d-164"><a name="auth"> </a></span><span class="sxs-lookup"><span data-stu-id="cb15d-164"><a name="auth"> </a></span></span>

<span data-ttu-id="cb15d-165">クライアントは、基本認証または OAuth を使用して、Exchange Online で認証を行うことができます。</span><span class="sxs-lookup"><span data-stu-id="cb15d-165">Clients can authenticate with Exchange Online by using either Basic or OAuth.</span></span> <span data-ttu-id="cb15d-166">Exchange 2013 以降のバージョンの Exchange オンプレミスは、既定では NTLM を使用します。ただし、基本認証を使用するように Exchange オンプレミスを構成することもできます。</span><span class="sxs-lookup"><span data-stu-id="cb15d-166">Versions of Exchange on-premises starting with Exchange 2013 use NTLM by default; however, it's possible to configure Exchange on-premises to use Basic authentication as well.</span></span> 
  
## <a name="client-latency-diagnostics"></a><span data-ttu-id="cb15d-167">クライアントの待機時間診断</span><span class="sxs-lookup"><span data-stu-id="cb15d-167">Client latency diagnostics</span></span>
<span data-ttu-id="cb15d-168"><a name="diag"> </a></span><span class="sxs-lookup"><span data-stu-id="cb15d-168"><a name="diag"> </a></span></span>

<span data-ttu-id="cb15d-169">Exchange Online は、クライアントの待機時間診断の報告があった場合に、それらの診断を収集します。</span><span class="sxs-lookup"><span data-stu-id="cb15d-169">Exchange Online collects client latency diagnostics if they are reported.</span></span> <span data-ttu-id="cb15d-170">これは、Microsoft が Exchange Online での接続の問題のトラブルシューティングをサポートするのに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="cb15d-170">This helps Microsoft support troubleshoot connectivity issues with Exchange Online.</span></span> <span data-ttu-id="cb15d-171">Exchange オンプレミスは、クライアントの待機時間診断は収集しません。</span><span class="sxs-lookup"><span data-stu-id="cb15d-171">Exchange on-premises does not collect client latency diagnostics.</span></span> <span data-ttu-id="cb15d-172">クライアントが Exchange オンプレミスを対象とする場合は、クライアントはサーバーに待機時間診断を報告することはできません。</span><span class="sxs-lookup"><span data-stu-id="cb15d-172">If your client targets Exchange on-premises, the client can't report latency diagnostics to the server.</span></span>
  
## <a name="functionality-in-the-ews-managed-api"></a><span data-ttu-id="cb15d-173">EWS マネージ API の機能</span><span class="sxs-lookup"><span data-stu-id="cb15d-173">Functionality in the EWS Managed API</span></span>
<span data-ttu-id="cb15d-174"><a name="ewsma"> </a></span><span class="sxs-lookup"><span data-stu-id="cb15d-174"><a name="ewsma"> </a></span></span>

<span data-ttu-id="cb15d-175">EWS マネージ API は、サービス ポイント接続検索などの Exchange オンプレミスに特有のいくつかの機能や、クライアントの待機時間レポートなどの Exchange Online に特有のいくつかの機能を公開します。</span><span class="sxs-lookup"><span data-stu-id="cb15d-175">The EWS Managed API exposes some functionality that is specific to Exchange on-premises, such as service point connection lookup, and some functionality that is specific to Exchange Online, such as client latency reporting.</span></span> <span data-ttu-id="cb15d-176">いくつかの機能は、EWS マネージ API で実装される前に Exchange Online で実装される可能性があることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="cb15d-176">Note that it's possible for some functionality to be implemented in Exchange Online before it is implemented in the EWS Managed API.</span></span> 
  
<span data-ttu-id="cb15d-177">次の EWS マネージ API 機能は、Exchange Online にのみ適用できます。</span><span class="sxs-lookup"><span data-stu-id="cb15d-177">The following EWS Managed API functionality is only applicable to Exchange Online:</span></span>
  
- <span data-ttu-id="cb15d-178">クライアントの待機時間レポート</span><span class="sxs-lookup"><span data-stu-id="cb15d-178">Client latency reporting</span></span>
    
- <span data-ttu-id="cb15d-179">基本事前認証</span><span class="sxs-lookup"><span data-stu-id="cb15d-179">Basic pre-authentication</span></span>
    
- <span data-ttu-id="cb15d-180">応答で RequestId が返されることを要求する機能</span><span class="sxs-lookup"><span data-stu-id="cb15d-180">The ability to request that the RequestId be returned in responses</span></span>
    
## <a name="api-features-in-exchange-online-plans-and-exchange-server-editions"></a><span data-ttu-id="cb15d-181">Exchange Online プランと Exchange サーバー エディションの API 機能</span><span class="sxs-lookup"><span data-stu-id="cb15d-181">API features in Exchange Online plans and Exchange Server editions</span></span>
<span data-ttu-id="cb15d-182"><a name="exo"> </a></span><span class="sxs-lookup"><span data-stu-id="cb15d-182"><a name="exo"> </a></span></span>

<span data-ttu-id="cb15d-183">Office 365 および Exchange Online の各種プランや Exchange サーバーの標準バージョンおよびエンタープライズ バージョンで、それぞれに異なる機能セットを利用できることが考えられます。</span><span class="sxs-lookup"><span data-stu-id="cb15d-183">Different feature sets might be available in different Office 365 and Exchange Online plans, or in the standard and enterprise versions of Exchange Server.</span></span> <span data-ttu-id="cb15d-184">Exchange Online のプラン、またはユーザーのメールボックスをホストする Exchange サーバー エディションによっては、いくつかの API 機能は、お使いのクライアント アプリケーションで利用できない場合がありますのでご注意ください。</span><span class="sxs-lookup"><span data-stu-id="cb15d-184">Be aware that some API functionality might not be available to your client application depending on the Exchange Online plan or Exchange Server edition that hosts a user's mailbox.</span></span> 
  
<span data-ttu-id="cb15d-185">**表 3. プランおよびエディションによる API 機能のバリエーション**</span><span class="sxs-lookup"><span data-stu-id="cb15d-185">**Table 3. API feature variations across plans and editions**</span></span>

|<span data-ttu-id="cb15d-186">**API 機能**</span><span class="sxs-lookup"><span data-stu-id="cb15d-186">**API feature**</span></span>|<span data-ttu-id="cb15d-187">**プランまたはエディションに関する考慮事項**</span><span class="sxs-lookup"><span data-stu-id="cb15d-187">**Plan or edition considerations**</span></span>|
|:-----|:-----|

<span data-ttu-id="cb15d-188">|Exchange 偽装を経由する場合を除き、アカウントへの EWS アクセス</span><span class="sxs-lookup"><span data-stu-id="cb15d-188">|EWS access to accounts, except via Exchange impersonation</span></span>  <br/> <span data-ttu-id="cb15d-189">|[Office 365 for business](https://office.microsoft.com/business/compare-office-365-kiosk-plans-FX103178917.aspx)では許可されていません— Kiosk プラン。</span><span class="sxs-lookup"><span data-stu-id="cb15d-189">|Not allowed in the [Office 365 for business—Kiosk plans](https://office.microsoft.com/business/compare-office-365-kiosk-plans-FX103178917.aspx).</span></span>  <br/> |


<span data-ttu-id="cb15d-190">|ユニファイドメッセージング (UM)</span><span class="sxs-lookup"><span data-stu-id="cb15d-190">|Unified Messaging (UM)</span></span>  <br/> <span data-ttu-id="cb15d-191">|Office 365 Enterprise (E3) プラン、Exchange Online プラン2、および Exchange Server 2013 Enterprise edition でのみ利用可能です。</span><span class="sxs-lookup"><span data-stu-id="cb15d-191">|Only available with Office 365 Enterprise (E3) plan, Exchange Online Plan 2, and the Exchange Server 2013 Enterprise editions.</span></span>  <br/> <span data-ttu-id="cb15d-192">| |Active Directory ドメインサービス (AD DS) の統合</span><span class="sxs-lookup"><span data-stu-id="cb15d-192">| |Active Directory Domain Services (AD DS) integration</span></span>  <br/> <span data-ttu-id="cb15d-193">|Office 365 Small Business および Office 365 Small Business Premium プランでは利用できません。</span><span class="sxs-lookup"><span data-stu-id="cb15d-193">|Not available with the Office 365 Small Business and Office 365 Small Business Premium plan.</span></span>  <br/> <span data-ttu-id="cb15d-194">| |Information Rights Management、アーカイブ、および法的保持</span><span class="sxs-lookup"><span data-stu-id="cb15d-194">| |Information Rights Management, archiving, and legal holds</span></span>  <br/> <span data-ttu-id="cb15d-195">|Office 365 Enterprise (E3 および E4) プランでのみ使用できます。</span><span class="sxs-lookup"><span data-stu-id="cb15d-195">|Only available with the Office 365 Enterprise (E3 and E4) plans.</span></span>  <br/> <span data-ttu-id="cb15d-196">| |データ損失防止</span><span class="sxs-lookup"><span data-stu-id="cb15d-196">| |Data Loss Protection</span></span>  <br/> <span data-ttu-id="cb15d-197">|Office 365 Enterprise プラン、Exchange Online プラン2、および Exchange Server 2013 Enterprise edition でのみ使用できます。</span><span class="sxs-lookup"><span data-stu-id="cb15d-197">|Only available with the Office 365 Enterprise plans, Exchange Online Plan 2, and Exchange Server 2013 Enterprise editions.</span></span>  <br/> |
   
<span data-ttu-id="cb15d-198">機能の可用性は変わる可能性があるため、Exchange Online プランと Exchange サーバー エディションを確認して、機能の可用性がクライアントに及ぼす影響を検証することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="cb15d-198">Because feature availability can change, we recommend that you check the Exchange Online plans and Exchange Server editions to evaluate how feature availability might affect your client.</span></span> <span data-ttu-id="cb15d-199">[GetServiceConfiguration 操作](how-to-get-service-configuration-information-by-using-ews-in-exchange.md)を使用して、または機能を実装する操作のためのテスト要求を送信することによって、機能の可用性を確認するようにクライアントを設計することもできます。</span><span class="sxs-lookup"><span data-stu-id="cb15d-199">You can also design your client to check feature availability by using the [GetServiceConfiguration operation](how-to-get-service-configuration-information-by-using-ews-in-exchange.md) or by sending test requests for the operations that implement the features.</span></span> <span data-ttu-id="cb15d-200">その機能が利用できない場合、サーバーからの応答でそのように示されます。</span><span class="sxs-lookup"><span data-stu-id="cb15d-200">If the feature isn't available, the response from the server will indicate as such.</span></span> 
  
## <a name="other-considerations"></a><span data-ttu-id="cb15d-201">その他の考慮事項</span><span class="sxs-lookup"><span data-stu-id="cb15d-201">Other considerations</span></span>
<span data-ttu-id="cb15d-202"><a name="other"> </a></span><span class="sxs-lookup"><span data-stu-id="cb15d-202"><a name="other"> </a></span></span>

<span data-ttu-id="cb15d-203">Exchange Online ではなく、Exchange オンプレミスを対象としている場合は、次を行うことができます。</span><span class="sxs-lookup"><span data-stu-id="cb15d-203">You can do the following when targeting Exchange on-premises but not Exchange Online:</span></span>
  
- <span data-ttu-id="cb15d-204">Exchange サーバーにインストールされているクライアントを作成します。</span><span class="sxs-lookup"><span data-stu-id="cb15d-204">Create a client that is installed on the Exchange server.</span></span> 
    
- <span data-ttu-id="cb15d-205">EWS およびその他のクライアントで作成および送信したメッセージの配信と内容に影響を与えることのできる[カスタム トランスポート エージェント](../transport-agents/transport-agents-in-exchange-2013.md)をインストールします。</span><span class="sxs-lookup"><span data-stu-id="cb15d-205">Install [custom transport agents](../transport-agents/transport-agents-in-exchange-2013.md) that can affect the delivery and content of messages you create and send with EWS and other clients.</span></span> 
    
## <a name="see-also"></a><span data-ttu-id="cb15d-206">関連項目</span><span class="sxs-lookup"><span data-stu-id="cb15d-206">See also</span></span>

- [<span data-ttu-id="cb15d-207">Exchange の EWS クライアントの設計の概要</span><span class="sxs-lookup"><span data-stu-id="cb15d-207">EWS client design overview for Exchange</span></span>](ews-client-design-overview-for-exchange.md)
- [<span data-ttu-id="cb15d-208">Exchange Online と Exchange Server 2013 の比較</span><span class="sxs-lookup"><span data-stu-id="cb15d-208">Comparing Exchange Online and Exchange Server 2013</span></span>](https://blogs.technet.com/b/exchange/archive/2012/09/19/comparing-exchange-online-and-exchange-server-2013.aspx)  
- [<span data-ttu-id="cb15d-209">ビジネス プラン向けのすべての Office 365 を比較する</span><span class="sxs-lookup"><span data-stu-id="cb15d-209">Compare all Office 365 for business plans</span></span>](https://office.microsoft.com/business/compare-all-office-365-for-business-plans-FX104051403.aspx)
- [<span data-ttu-id="cb15d-210">EwsRelentless - EWS 負荷生成ツール</span><span class="sxs-lookup"><span data-stu-id="cb15d-210">EwsRelentless - EWS load generation tool</span></span>](https://ewsrelentless.codeplex.com/)
- [<span data-ttu-id="cb15d-211">Exchange および EWS Managed API の Web サービス API 機能の可用性</span><span class="sxs-lookup"><span data-stu-id="cb15d-211">Web service API feature availability in Exchange and the EWS Managed API</span></span>](web-service-api-feature-availability-in-exchange-and-the-ews-managed-api.md)
- [<span data-ttu-id="cb15d-212">Exchange での EWS 調整</span><span class="sxs-lookup"><span data-stu-id="cb15d-212">EWS throttling in Exchange</span></span>](ews-throttling-in-exchange.md)
    

