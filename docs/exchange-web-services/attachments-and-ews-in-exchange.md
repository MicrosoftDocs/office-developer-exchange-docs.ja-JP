---
title: Exchange の添付物と EWS
manager: sethgros
ms.date: 7/11/2016
ms.audience: Developer
localization_priority: Normal
ms.assetid: 8e4289a4-ec9d-4502-9854-c593c95d5f98
description: 添付物と、Exchange クライアントの EWS マネージ API または EWS で添付物を表す方法について説明します。
ms.openlocfilehash: e4a97873798b8252e6fc14003519ce8a0eab7ec8
ms.sourcegitcommit: 34041125dc8c5f993b21cebfc4f8b72f0fd2cb6f
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/25/2018
ms.locfileid: "19758879"
---
# <a name="attachments-and-ews-in-exchange"></a><span data-ttu-id="d4c3d-103">Exchange の添付物と EWS</span><span class="sxs-lookup"><span data-stu-id="d4c3d-103">Attachments and EWS in Exchange</span></span>

<span data-ttu-id="d4c3d-104">添付物と、Exchange クライアントの EWS マネージ API または EWS で添付物を表す方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="d4c3d-104">Learn about attachments and how your EWS Managed API or EWS in Exchange client represents them.</span></span>
  
<span data-ttu-id="d4c3d-105">通常、添付物は、メール アイテムに関連付けられていますが、実際には、すべての EWS アイテム (子メールのメッセージ、予定表アイテム、連絡先、タスク) に添付物を含めることができます。</span><span class="sxs-lookup"><span data-stu-id="d4c3d-105">Usually, attachments are associated with email items, but in fact, all EWS items — email messages, calendar items, contacts, tasks — can include attachments.</span></span>
  
## <a name="types-of-attachments"></a><span data-ttu-id="d4c3d-106">添付物の種類</span><span class="sxs-lookup"><span data-stu-id="d4c3d-106">Types of attachments</span></span>

<span data-ttu-id="d4c3d-107">EWS は、添付物をファイル添付とアイテム添付の 2 つのグループに分類します。</span><span class="sxs-lookup"><span data-stu-id="d4c3d-107">EWS categorizes attachments into two groups: file attachments and item attachments.</span></span>
  
- <span data-ttu-id="d4c3d-108">**アイテム添付:** メール メッセージ、予定表アイテムなどの厳密に型指定された [EWS アイテム](folders-and-items-in-ews-in-exchange.md)。これらは厳密に型指定された別の EWS アイテムに添付されています。</span><span class="sxs-lookup"><span data-stu-id="d4c3d-108">**Item attachments:** Strongly-typed [EWS items](folders-and-items-in-ews-in-exchange.md), such as email messages and calendar items, that are attached to another strongly-typed EWS item.</span></span> <span data-ttu-id="d4c3d-109">EWS マネージ API または EWS を使用して作成できるすべての厳密に型指定されたアイテムは、アイテム添付として使用できます。</span><span class="sxs-lookup"><span data-stu-id="d4c3d-109">Any strongly-typed item that can be created by using the EWS Managed API or EWS can be used as an item attachment.</span></span> <span data-ttu-id="d4c3d-110">アイテム添付のコンテンツは、厳密に型指定されたアイテムであり、そのすべてのプロパティに簡単にアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="d4c3d-110">The content of an item attachment is the strongly-typed item, which provides easy access to all its properties.</span></span> <span data-ttu-id="d4c3d-111">アイテム添付はそれ自体のアイテム添付を持つことができます。そのためアイテム添付の階層 (または添付物の入れ子) を構成できます。</span><span class="sxs-lookup"><span data-stu-id="d4c3d-111">Item attachments can have their own item attachments, so a hierarchy of item attachments (or nesting of attachments) is possible.</span></span>
    
- <span data-ttu-id="d4c3d-112">**ファイル添付:** .txt、.jpg、.zip、.pdf などのすべてのファイル (.msg ファイルも含む)。</span><span class="sxs-lookup"><span data-stu-id="d4c3d-112">**File attachments:** Any file, such as a .txt, .jpg, .zip, .pdf, or even a .msg file. A file attachment only has a few properties, one of which is the base-64 encoded content of the file.</span></span> <span data-ttu-id="d4c3d-113">ファイル添付には少数のプロパティしかありませんが、その 1 つは、Base-64 でエンコードされたファイル コンテンツです。</span><span class="sxs-lookup"><span data-stu-id="d4c3d-113">File attachments: Any file, such as a .txt, .jpg, .zip, .pdf, or even a .msg file. A file attachment only has a few properties, one of which is the base-64 encoded content of the file.</span></span> 
    
- <span data-ttu-id="d4c3d-114">**参照添付物:** ファイル プロバイダーによって参照される添付物 (クラウド内にあるファイルなど)。</span><span class="sxs-lookup"><span data-stu-id="d4c3d-114">**Reference attachments:** Any attachment that is referenced by a file provider, such as a file located in the cloud.</span></span> <span data-ttu-id="d4c3d-115">1 つの添付物が複数のプロバイダーから参照される場合もあります。</span><span class="sxs-lookup"><span data-stu-id="d4c3d-115">An attachment can be from multiple providers.</span></span> 
    
<span data-ttu-id="d4c3d-116">添付物をアイテムに追加またはアイテムから取得する場合、ファイル添付であるか、アイテム添付であるかによって、操作が異なります。</span><span class="sxs-lookup"><span data-stu-id="d4c3d-116">When you add or retrieve attachments from an item, you'll do it differently depending on whether it's a file attachment or an item attachment.</span></span> <span data-ttu-id="d4c3d-117">たとえば、アイテムにファイル添付を追加する場合は、ファイルの場所を渡すだけです。</span><span class="sxs-lookup"><span data-stu-id="d4c3d-117">For example, to add a file attachment to an item, you can just pass in the location of the file.</span></span> <span data-ttu-id="d4c3d-118">アイテム添付として既存のアイテムを追加する場合は、既存のアイテムのプロパティまたは MIME コンテンツを新しいアイテム添付に実際にコピーする必要があります。既存のアイテムにバインドすることはできません。</span><span class="sxs-lookup"><span data-stu-id="d4c3d-118">To add an existing item as an item attachment, you actually have to copy the properties or the MIME content of the existing item to a new item attachment; you can't just bind to the existing item.</span></span> <span data-ttu-id="d4c3d-119">そのため、添付物の 2 つの種類を区別することが重要になります。</span><span class="sxs-lookup"><span data-stu-id="d4c3d-119">So distinguishing between the two types of attachments is important.</span></span> <span data-ttu-id="d4c3d-120">アイテム添付とファイル添付の違いの詳細については、[このセクション](#bk_inthissection)の記事で説明します。</span><span class="sxs-lookup"><span data-stu-id="d4c3d-120">More details about the differences between item attachments and file attachments are discussed in the articles [In this section](#bk_inthissection).</span></span>
  
## <a name="how-are-attachments-represented-programmatically"></a><span data-ttu-id="d4c3d-121">プログラムによる添付物の表示方法</span><span class="sxs-lookup"><span data-stu-id="d4c3d-121">How are attachments represented programmatically?</span></span>

<span data-ttu-id="d4c3d-122">添付物は、EWS のアイテムのコレクションに保存されます。</span><span class="sxs-lookup"><span data-stu-id="d4c3d-122">Attachments are stored in a collection on the EWS item.</span></span> <span data-ttu-id="d4c3d-123">添付物コレクションは、ファイル添付またはアイテム添付、あるいはその両方で構成されています。</span><span class="sxs-lookup"><span data-stu-id="d4c3d-123">The attachments collection is made up of file attachments and/or item attachments.</span></span> <span data-ttu-id="d4c3d-124">添付物コレクションに関するメタデータは、EWS マネージ API の [Item.Bind](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.item.bind%28v=exchg.80%29.aspx) メソッドまたは EWS の [GetItem](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) 操作を使用してアイテムを取得した場合に使用できます。ただし、添付物のコンテンツを実際に取得するには追加の呼び出しを行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="d4c3d-124">Attachments are stored in a collection on the EWS item. The attachments collection is made up of file attachments and/or item attachments. Metadata about the attachment collection is available when you get an item by using the EWS Managed API [Item.Bindhttp://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.bind(v=exchg.80).aspx](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.item.bind%28v=exchg.80%29.aspx) method or the EWS [GetItem](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) operation, but additional calls are required to actually retrieve the contents of the attachments.</span></span> 
  
<span data-ttu-id="d4c3d-125">**表 1. 添付物に関するアイテムのメタデータ**</span><span class="sxs-lookup"><span data-stu-id="d4c3d-125">**Table 1.  Item metadata about attachments**</span></span>

|<span data-ttu-id="d4c3d-126">**メタデータ エンティティ**</span><span class="sxs-lookup"><span data-stu-id="d4c3d-126">**Metadata entity**</span></span>|<span data-ttu-id="d4c3d-127">**EWS マネージ API のプロパティ**</span><span class="sxs-lookup"><span data-stu-id="d4c3d-127">**EWS Managed API property**</span></span>|<span data-ttu-id="d4c3d-128">**EWS の要素**</span><span class="sxs-lookup"><span data-stu-id="d4c3d-128">**EWS element**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="d4c3d-129">添付物のインジケーター (インライン添付のフラグを設定しない)</span><span class="sxs-lookup"><span data-stu-id="d4c3d-129">Attachment indicator (does not flag inline attachments)</span></span>  <br/> |[<span data-ttu-id="d4c3d-130">Item.HasAttachments</span><span class="sxs-lookup"><span data-stu-id="d4c3d-130">Item.HasAttachments</span></span>](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.item.hasattachments%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="d4c3d-131">HasAttachments</span><span class="sxs-lookup"><span data-stu-id="d4c3d-131">HasAttachments</span></span>](http://msdn.microsoft.com/library/538b7a85-11d7-4daa-8458-09b540760e8b%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="d4c3d-132">添付物のコレクション</span><span class="sxs-lookup"><span data-stu-id="d4c3d-132">Attachment collection</span></span>  <br/> |[<span data-ttu-id="d4c3d-133">Item.Attachments</span><span class="sxs-lookup"><span data-stu-id="d4c3d-133">item.attachments</span></span>](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.item.attachments%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="d4c3d-134">Attachments</span><span class="sxs-lookup"><span data-stu-id="d4c3d-134">Attachments</span></span>](http://msdn.microsoft.com/library/b470e614-34bb-44f0-8790-7ddbdcbbd29d%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="d4c3d-135">添付ファイルの ID</span><span class="sxs-lookup"><span data-stu-id="d4c3d-135">Attachment ID</span></span>  <br/> |[<span data-ttu-id="d4c3d-136">Attachment.Id</span><span class="sxs-lookup"><span data-stu-id="d4c3d-136">attachment_id</span></span>](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.attachment.id%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="d4c3d-137">AttachmentId</span><span class="sxs-lookup"><span data-stu-id="d4c3d-137">attachment_id</span></span>](http://msdn.microsoft.com/library/55a5fd77-60d1-40fa-8144-770600cedc6a%28Office.15%29.aspx) <br/> |
   
<span data-ttu-id="d4c3d-138">**表 2. 添付物のエンティティ**</span><span class="sxs-lookup"><span data-stu-id="d4c3d-138">**Table 2.  Attachment entities**</span></span>

|<span data-ttu-id="d4c3d-139">**添付物の種類**</span><span class="sxs-lookup"><span data-stu-id="d4c3d-139">**Attachment type**</span></span>|<span data-ttu-id="d4c3d-140">**EWS マネージ API のクラス**</span><span class="sxs-lookup"><span data-stu-id="d4c3d-140">**EWS Managed API class**</span></span>|<span data-ttu-id="d4c3d-141">**EWS の要素**</span><span class="sxs-lookup"><span data-stu-id="d4c3d-141">**EWS element**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="d4c3d-142">ファイル添付</span><span class="sxs-lookup"><span data-stu-id="d4c3d-142">File attachment</span></span>  <br/> |<span data-ttu-id="d4c3d-143">[FileAttachment](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.fileattachment%28v=exchg.80%29.aspx)</span><span class="sxs-lookup"><span data-stu-id="d4c3d-143">[fileAttachment](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.fileattachment%28v=exchg.80%29.aspx),</span></span> <br/> |[<span data-ttu-id="d4c3d-144">FileAttachment</span><span class="sxs-lookup"><span data-stu-id="d4c3d-144">FileAttachment</span></span>](http://msdn.microsoft.com/library/3ecea174-73d1-47fd-8917-6065cef1d565%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="d4c3d-145">アイテム添付</span><span class="sxs-lookup"><span data-stu-id="d4c3d-145">Item attachment</span></span>  <br/> |<span data-ttu-id="d4c3d-146">[ItemAttachment](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.itemattachment%28v=exchg.80%29.aspx)</span><span class="sxs-lookup"><span data-stu-id="d4c3d-146">[itemAttachment](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.itemattachment%28v=exchg.80%29.aspx),</span></span> <br/> [<span data-ttu-id="d4c3d-147">ItemAttachment\<TItem\></span><span class="sxs-lookup"><span data-stu-id="d4c3d-147">ItemAttachment\<TItem\></span></span>](http://msdn.microsoft.com/ja-JP/library/dd635165%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="d4c3d-148">[ItemAttachment](http://msdn.microsoft.com/library/089ee599-f45e-46f5-a18a-5cfb3d2851ff%28Office.15%29.aspx)</span><span class="sxs-lookup"><span data-stu-id="d4c3d-148">[itemAttachment](http://msdn.microsoft.com/library/089ee599-f45e-46f5-a18a-5cfb3d2851ff%28Office.15%29.aspx),</span></span> <br/> |
|<span data-ttu-id="d4c3d-149">参照添付物</span><span class="sxs-lookup"><span data-stu-id="d4c3d-149">Reference attachment</span></span>  <br/> |[<span data-ttu-id="d4c3d-150">ReferenceAttachmentType complexType (EWS)</span><span class="sxs-lookup"><span data-stu-id="d4c3d-150">ReferenceAttachmentType complexType (EWS)</span></span>](http://msdn.microsoft.com/library/18bfa012-e903-d7f3-528a-31ccceb65463%28Office.15%29.aspx) <br/> |<span data-ttu-id="d4c3d-151">[ReferenceAttachment](http://msdn.microsoft.com/library/b9bde862-6b75-4a81-8033-00a47be4dc2f%28Office.15%29.aspx)</span><span class="sxs-lookup"><span data-stu-id="d4c3d-151">[referenceAttachment](http://msdn.microsoft.com/library/b9bde862-6b75-4a81-8033-00a47be4dc2f%28Office.15%29.aspx),</span></span> <br/> |
   
## <a name="inline-attachments"></a><span data-ttu-id="d4c3d-152">インライン添付</span><span class="sxs-lookup"><span data-stu-id="d4c3d-152">Inline attachments</span></span>

<span data-ttu-id="d4c3d-p106">インライン添付は特別な種類の添付物です。ファイル添付とアイテム添付の両方とも、インライン添付にできます。インライン添付は、本文の内容の一部として表示され、アイテムの残りの部分のコンテンツとの関係でその位置を保持します。 </span><span class="sxs-lookup"><span data-stu-id="d4c3d-p106">Inline attachments are a special breed of attachment. Both file attachments and item attachments can be inline attachments. An inline attachment appears as part of the body content and retains its position relative to the rest of the content in the item.</span></span> 
  
<span data-ttu-id="d4c3d-156">EWS マネージ API の [IsInline](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.attachment.isinline%28v=exchg.80%29.aspx) プロパティまたは EWS の [IsInline](http://msdn.microsoft.com/library/5e7712c8-372a-4a16-be64-360c5ff3961a%28Office.15%29.aspx) 要素が true に設定されている場合、添付物はインライン添付です。</span><span class="sxs-lookup"><span data-stu-id="d4c3d-156">An attachment is an inline attachment if the EWS Managed API [IsInline](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.attachment.isinline%28v=exchg.80%29.aspx) property or the EWS [IsInline](http://msdn.microsoft.com/library/5e7712c8-372a-4a16-be64-360c5ff3961a%28Office.15%29.aspx) element is set to true.</span></span> <span data-ttu-id="d4c3d-157">インライン添付は、次のオプションのプロパティと要素を使用して、インライン添付の場所を識別します。</span><span class="sxs-lookup"><span data-stu-id="d4c3d-157">Inline attachments use the following optional properties and elements to identify the location of an inline attachment:</span></span> 
  
- <span data-ttu-id="d4c3d-158">EWS マネージ API — [ContentId](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.attachment.contentid%28v=exchg.80%29.aspx) または [ContentLocation](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.attachment.contentlocation%28v=exchg.80%29.aspx) プロパティ。</span><span class="sxs-lookup"><span data-stu-id="d4c3d-158">EWS Managed API — [ContentId](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.attachment.contentid%28v=exchg.80%29.aspx) or [ContentLocation](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.attachment.contentlocation%28v=exchg.80%29.aspx) properties.</span></span> 
    
- <span data-ttu-id="d4c3d-159">EWS — [ContentId](http://msdn.microsoft.com/library/bc59100d-6079-414b-a6e0-7c15feaa3184%28Office.15%29.aspx) または [ContentLocation](http://msdn.microsoft.com/library/d91cf587-24e3-4c13-8784-5ca29787cca7%28Office.15%29.aspx) 要素。</span><span class="sxs-lookup"><span data-stu-id="d4c3d-159">EWS — [ContentId](http://msdn.microsoft.com/library/bc59100d-6079-414b-a6e0-7c15feaa3184%28Office.15%29.aspx) or [ContentLocation](http://msdn.microsoft.com/library/d91cf587-24e3-4c13-8784-5ca29787cca7%28Office.15%29.aspx) element.</span></span> 
    
<span data-ttu-id="d4c3d-160">EWS マネージ API の [HasAttachments](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.item.hasattachments%28v=exchg.80%29.aspx) プロパティと EWS の [HasAttachments](http://msdn.microsoft.com/library/538b7a85-11d7-4daa-8458-09b540760e8b%28Office.15%29.aspx) 要素には、既存のインライン添付が存在しても反映されません。これがインライン添付が隠し添付ファイルとも呼ばれる理由です。</span><span class="sxs-lookup"><span data-stu-id="d4c3d-160">Note that the EWS Managed API [HasAttachments](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.item.hasattachments%28v=exchg.80%29.aspx) property and the EWS [HasAttachments](http://msdn.microsoft.com/library/538b7a85-11d7-4daa-8458-09b540760e8b%28Office.15%29.aspx) element do not reflect the existence of inline attachments, and that's why inline attachments are also called hidden attachments.</span></span> <span data-ttu-id="d4c3d-161">そのため、EWS マネージ API の [IsInline](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.attachment.isinline%28v=exchg.80%29.aspx) プロパティまたは EWS の [IsInline](http://msdn.microsoft.com/library/5e7712c8-372a-4a16-be64-360c5ff3961a%28Office.15%29.aspx) 要素を true に設定し、アイテムに他の添付物は含まれない場合、**HasAttachments** は false に設定されます。</span><span class="sxs-lookup"><span data-stu-id="d4c3d-161">So if you set the EWS Managed API [IsInline](http://msdn.microsoft.com/ja-JP/library/microsoft.exchange.webservices.data.attachment.isinline%28v=exchg.80%29.aspx) property or the EWS [IsInline](http://msdn.microsoft.com/library/5e7712c8-372a-4a16-be64-360c5ff3961a%28Office.15%29.aspx) element to true, and the item has no other attachments, **HasAttachments** will be set to false.</span></span> <span data-ttu-id="d4c3d-162">クライアントが **HasAttachments** を使用して、メールの添付物のインジケーターまたはアイコンを設定する場合は、インライン添付を含むメールではアイコンが表示されないことに注意してください。</span><span class="sxs-lookup"><span data-stu-id="d4c3d-162">If your client uses **HasAttachments** to populate an attachment indicator or icon on an email, be aware that the icon will not appear for emails with inline attachments.</span></span> 
  
## <a name="in-this-section"></a><span data-ttu-id="d4c3d-163">このセクションの内容</span><span class="sxs-lookup"><span data-stu-id="d4c3d-163">In this section</span></span>
<span data-ttu-id="d4c3d-164"><a name="bk_inthissection"> </a></span><span class="sxs-lookup"><span data-stu-id="d4c3d-164"></span></span>

- [<span data-ttu-id="d4c3d-165">Exchange で EWS を使用して添付ファイルを追加する</span><span class="sxs-lookup"><span data-stu-id="d4c3d-165">How to: Add attachments by using EWS in Exchange</span></span>](how-to-add-attachments-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="d4c3d-166">Exchange で EWS を使用して添付ファイルを取得する</span><span class="sxs-lookup"><span data-stu-id="d4c3d-166">How to: Get attachments by using EWS in Exchange</span></span>](how-to-get-attachments-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="d4c3d-167">Exchange で EWS を使用して添付ファイルを削除する</span><span class="sxs-lookup"><span data-stu-id="d4c3d-167">How to: Delete attachments by using EWS in Exchange</span></span>](how-to-delete-attachments-by-using-ews-in-exchange.md)
    
## <a name="see-also"></a><span data-ttu-id="d4c3d-168">関連項目</span><span class="sxs-lookup"><span data-stu-id="d4c3d-168">See also</span></span>
<span data-ttu-id="d4c3d-169"><a name="bk_additionalresources"> </a></span><span class="sxs-lookup"><span data-stu-id="d4c3d-169"></span></span>

- [<span data-ttu-id="d4c3d-170">Exchange の Web サービス クライアントを開発する</span><span class="sxs-lookup"><span data-stu-id="d4c3d-170">Develop web service clients for Exchange</span></span>](develop-web-service-clients-for-exchange.md)
    
- [<span data-ttu-id="d4c3d-171">Exchange の EWS のフォルダーとアイテム</span><span class="sxs-lookup"><span data-stu-id="d4c3d-171">Folders and items in EWS in Exchange</span></span>](folders-and-items-in-ews-in-exchange.md)
    
- [<span data-ttu-id="d4c3d-172">Exchange のメールと EWS</span><span class="sxs-lookup"><span data-stu-id="d4c3d-172">Email and EWS in Exchange</span></span>](email-and-ews-in-exchange.md)
    

