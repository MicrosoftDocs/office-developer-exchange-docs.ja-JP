---
title: Exchange の添付物と EWS
manager: sethgros
ms.date: 7/11/2016
ms.audience: Developer
localization_priority: Normal
ms.assetid: 8e4289a4-ec9d-4502-9854-c593c95d5f98
description: 添付物と、Exchange クライアントの EWS マネージ API または EWS で添付物を表す方法について説明します。
ms.openlocfilehash: e4a97873798b8252e6fc14003519ce8a0eab7ec8
ms.sourcegitcommit: 34041125dc8c5f993b21cebfc4f8b72f0fd2cb6f
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/11/2018
ms.locfileid: "19758879"
---
# <a name="attachments-and-ews-in-exchange"></a><span data-ttu-id="e9349-103">Exchange の添付物と EWS</span><span class="sxs-lookup"><span data-stu-id="e9349-103">Attachments and EWS in Exchange</span></span>

<span data-ttu-id="e9349-104">添付物と、Exchange クライアントの EWS マネージ API または EWS で添付物を表す方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="e9349-104">Learn about attachments and how your EWS Managed API or EWS in Exchange client represents them.</span></span>
  
<span data-ttu-id="e9349-105">通常、添付物は、メール アイテムに関連付けられていますが、実際には、すべての EWS アイテム (子メールのメッセージ、予定表アイテム、連絡先、タスク) に添付物を含めることができます。</span><span class="sxs-lookup"><span data-stu-id="e9349-105">Usually, attachments are associated with email items, but in fact, all EWS items — email messages, calendar items, contacts, tasks — can include attachments.</span></span>
  
## <a name="types-of-attachments"></a><span data-ttu-id="e9349-106">添付物の種類</span><span class="sxs-lookup"><span data-stu-id="e9349-106">Types of attachments</span></span>

<span data-ttu-id="e9349-107">EWS は、添付物をファイル添付とアイテム添付の 2 つのグループに分類します。</span><span class="sxs-lookup"><span data-stu-id="e9349-107">EWS categorizes attachments into two groups: file attachments and item attachments.</span></span>
  
- <span data-ttu-id="e9349-108">**アイテムの添付ファイル:** 厳密に型指定された[EWS の項目](folders-and-items-in-ews-in-exchange.md)、電子メール メッセージや予定表アイテムは、別の厳密に型指定された EWS アイテムに関連付けられているなどです。</span><span class="sxs-lookup"><span data-stu-id="e9349-108">**Item attachments:** Strongly-typed [EWS items](folders-and-items-in-ews-in-exchange.md), such as email messages and calendar items, that are attached to another strongly-typed EWS item.</span></span> <span data-ttu-id="e9349-109">EWS のマネージ API または EWS を使用して作成できる厳密に型指定されたアイテムは、アイテムの添付ファイルとして使用できます。</span><span class="sxs-lookup"><span data-stu-id="e9349-109">Any strongly-typed item that can be created by using the EWS Managed API or EWS can be used as an item attachment.</span></span> <span data-ttu-id="e9349-110">アイテムの添付ファイルの内容は、すべてのプロパティに簡単にアクセスを提供する厳密に型指定されたアイテムです。</span><span class="sxs-lookup"><span data-stu-id="e9349-110">The content of an item attachment is the strongly-typed item, which provides easy access to all its properties.</span></span> <span data-ttu-id="e9349-111">項目の添付ファイルは、項目の添付ファイルなどの添付ファイルの入れ子の階層は、独自のアイテムの添付ファイルを持つことができます。</span><span class="sxs-lookup"><span data-stu-id="e9349-111">Item attachments can have their own item attachments, so a hierarchy of item attachments (or nesting of attachments) is possible.</span></span>
    
- <span data-ttu-id="e9349-112">**添付ファイル:**.Txt、.jpg、.zip、.pdf などの任意のファイル、またはさらに .msg ファイル。</span><span class="sxs-lookup"><span data-stu-id="e9349-112">**File attachments:** Any file, such as a .txt, .jpg, .zip, .pdf, or even a .msg file.</span></span> <span data-ttu-id="e9349-113">添付ファイルは、いくつかのプロパティでは、base 64 エンコードされたコンテンツ ファイルのうちの 1 つだけにできます。</span><span class="sxs-lookup"><span data-stu-id="e9349-113">A file attachment only has a few properties, one of which is the base-64 encoded content of the file.</span></span> 
    
- <span data-ttu-id="e9349-114">**の添付ファイルを参照:** クラウド内のファイルなど、ファイルのプロバイダーによって参照されている添付ファイルです。</span><span class="sxs-lookup"><span data-stu-id="e9349-114">**Reference attachments:** Any attachment that is referenced by a file provider, such as a file located in the cloud.</span></span> <span data-ttu-id="e9349-115">添付ファイルは、複数のプロバイダーです。</span><span class="sxs-lookup"><span data-stu-id="e9349-115">An attachment can be from multiple providers.</span></span> 
    
<span data-ttu-id="e9349-116">追加アイテムから添付ファイルを取得すると、行うことが異なるか、添付ファイルまたはアイテムの添付ファイルであるかによって。</span><span class="sxs-lookup"><span data-stu-id="e9349-116">When you add or retrieve attachments from an item, you'll do it differently depending on whether it's a file attachment or an item attachment.</span></span> <span data-ttu-id="e9349-117">などのアイテムに添付ファイルを追加するを渡すことができますだけでファイルの場所にします。</span><span class="sxs-lookup"><span data-stu-id="e9349-117">For example, to add a file attachment to an item, you can just pass in the location of the file.</span></span> <span data-ttu-id="e9349-118">アイテムの添付ファイルとして既存の項目を追加するのには実際にコピーする必要のプロパティ] または [既存項目の MIME コンテンツに、新しいアイテムの添付ファイルです。だけを既存のアイテムにバインドできません。</span><span class="sxs-lookup"><span data-stu-id="e9349-118">To add an existing item as an item attachment, you actually have to copy the properties or the MIME content of the existing item to a new item attachment; you can't just bind to the existing item.</span></span> <span data-ttu-id="e9349-119">その 2 つの種類の添付ファイルを区別することが重要です。</span><span class="sxs-lookup"><span data-stu-id="e9349-119">So distinguishing between the two types of attachments is important.</span></span> <span data-ttu-id="e9349-120">項目の添付ファイルと添付ファイルの違いの詳細については、[このセクションの](#bk_inthissection)記事で説明します。</span><span class="sxs-lookup"><span data-stu-id="e9349-120">More details about the differences between item attachments and file attachments are discussed in the articles [In this section](#bk_inthissection).</span></span>
  
## <a name="how-are-attachments-represented-programmatically"></a><span data-ttu-id="e9349-121">プログラムによる添付物の表示方法</span><span class="sxs-lookup"><span data-stu-id="e9349-121">How are attachments represented programmatically?</span></span>

<span data-ttu-id="e9349-122">添付ファイルは、EWS の項目をコレクションに格納されます。</span><span class="sxs-lookup"><span data-stu-id="e9349-122">Attachments are stored in a collection on the EWS item.</span></span> <span data-ttu-id="e9349-123">添付ファイルまたはアイテムの添付ファイルの添付ファイル コレクションは構成されています。</span><span class="sxs-lookup"><span data-stu-id="e9349-123">The attachments collection is made up of file attachments and/or item attachments.</span></span> <span data-ttu-id="e9349-124">添付ファイル コレクションに関するメタデータは、EWS のマネージ API の[Item.Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.bind%28v=exchg.80%29.aspx)メソッドまたは EWS [GetItem](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx)操作を使用してアイテムを取得するが、追加の呼び出しが実際には、添付ファイルの内容を取得するために必要なときに使用できます。</span><span class="sxs-lookup"><span data-stu-id="e9349-124">Metadata about the attachment collection is available when you get an item by using the EWS Managed API [Item.Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.bind%28v=exchg.80%29.aspx) method or the EWS [GetItem](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) operation, but additional calls are required to actually retrieve the contents of the attachments.</span></span> 
  
<span data-ttu-id="e9349-125">**表 1 です。添付ファイルについての項目メタデータ**</span><span class="sxs-lookup"><span data-stu-id="e9349-125">**Table 1. Item metadata about attachments**</span></span>

|<span data-ttu-id="e9349-126">**メタデータ エンティティ**</span><span class="sxs-lookup"><span data-stu-id="e9349-126">**Metadata entity**</span></span>|<span data-ttu-id="e9349-127">**EWS のマネージ API のプロパティ**</span><span class="sxs-lookup"><span data-stu-id="e9349-127">**EWS Managed API property**</span></span>|<span data-ttu-id="e9349-128">**EWS の要素**</span><span class="sxs-lookup"><span data-stu-id="e9349-128">**EWS element**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="e9349-129">添付物のインジケーター (インライン添付のフラグを設定しない)</span><span class="sxs-lookup"><span data-stu-id="e9349-129">Attachment indicator (does not flag inline attachments)</span></span>  <br/> |[<span data-ttu-id="e9349-130">Item.HasAttachments</span><span class="sxs-lookup"><span data-stu-id="e9349-130">Item.HasAttachments</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.hasattachments%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="e9349-131">添付ファイル付き</span><span class="sxs-lookup"><span data-stu-id="e9349-131">HasAttachments</span></span>](http://msdn.microsoft.com/library/538b7a85-11d7-4daa-8458-09b540760e8b%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="e9349-132">添付物のコレクション</span><span class="sxs-lookup"><span data-stu-id="e9349-132">Attachment collection</span></span>  <br/> |[<span data-ttu-id="e9349-133">Item.Attachments</span><span class="sxs-lookup"><span data-stu-id="e9349-133">Item.Attachments</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.attachments%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="e9349-134">添付ファイル</span><span class="sxs-lookup"><span data-stu-id="e9349-134">Attachments</span></span>](http://msdn.microsoft.com/library/b470e614-34bb-44f0-8790-7ddbdcbbd29d%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="e9349-135">添付ファイルの ID</span><span class="sxs-lookup"><span data-stu-id="e9349-135">Attachment ID</span></span>  <br/> |[<span data-ttu-id="e9349-136">Attachment.Id</span><span class="sxs-lookup"><span data-stu-id="e9349-136">Attachment.Id</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.attachment.id%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="e9349-137">AttachmentId</span><span class="sxs-lookup"><span data-stu-id="e9349-137">AttachmentId</span></span>](http://msdn.microsoft.com/library/55a5fd77-60d1-40fa-8144-770600cedc6a%28Office.15%29.aspx) <br/> |
   
<span data-ttu-id="e9349-138">**表 2 になります。添付ファイルのエンティティ**</span><span class="sxs-lookup"><span data-stu-id="e9349-138">**Table 2. Attachment entities**</span></span>

|<span data-ttu-id="e9349-139">**添付ファイルの種類**</span><span class="sxs-lookup"><span data-stu-id="e9349-139">**Attachment type**</span></span>|<span data-ttu-id="e9349-140">**EWS マネージ API クラス**</span><span class="sxs-lookup"><span data-stu-id="e9349-140">**EWS Managed API class**</span></span>|<span data-ttu-id="e9349-141">**EWS の要素**</span><span class="sxs-lookup"><span data-stu-id="e9349-141">**EWS element**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="e9349-142">添付ファイル</span><span class="sxs-lookup"><span data-stu-id="e9349-142">File attachment</span></span>  <br/> |[<span data-ttu-id="e9349-143">FileAttachment</span><span class="sxs-lookup"><span data-stu-id="e9349-143">FileAttachment</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.fileattachment%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="e9349-144">FileAttachment</span><span class="sxs-lookup"><span data-stu-id="e9349-144">FileAttachment</span></span>](http://msdn.microsoft.com/library/3ecea174-73d1-47fd-8917-6065cef1d565%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="e9349-145">アイテム添付</span><span class="sxs-lookup"><span data-stu-id="e9349-145">Item attachment</span></span>  <br/> |[<span data-ttu-id="e9349-146">ItemAttachment</span><span class="sxs-lookup"><span data-stu-id="e9349-146">ItemAttachment</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.itemattachment%28v=exchg.80%29.aspx) <br/> [<span data-ttu-id="e9349-147">ItemAttachment\<TItem\></span><span class="sxs-lookup"><span data-stu-id="e9349-147">ItemAttachment\<TItem\></span></span>](http://msdn.microsoft.com/en-us/library/dd635165%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="e9349-148">ItemAttachment</span><span class="sxs-lookup"><span data-stu-id="e9349-148">ItemAttachment</span></span>](http://msdn.microsoft.com/library/089ee599-f45e-46f5-a18a-5cfb3d2851ff%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="e9349-149">参照添付ファイル</span><span class="sxs-lookup"><span data-stu-id="e9349-149">Reference attachment</span></span>  <br/> |[<span data-ttu-id="e9349-150">ReferenceAttachmentType complexType (EWS)</span><span class="sxs-lookup"><span data-stu-id="e9349-150">ReferenceAttachmentType complexType (EWS)</span></span>](http://msdn.microsoft.com/library/18bfa012-e903-d7f3-528a-31ccceb65463%28Office.15%29.aspx) <br/> |[<span data-ttu-id="e9349-151">ReferenceAttachment</span><span class="sxs-lookup"><span data-stu-id="e9349-151">ReferenceAttachment</span></span>](http://msdn.microsoft.com/library/b9bde862-6b75-4a81-8033-00a47be4dc2f%28Office.15%29.aspx) <br/> |
   
## <a name="inline-attachments"></a><span data-ttu-id="e9349-152">インライン添付</span><span class="sxs-lookup"><span data-stu-id="e9349-152">Inline attachments</span></span>

<span data-ttu-id="e9349-p106">インライン添付は特別な種類の添付物です。ファイル添付とアイテム添付の両方とも、インライン添付にできます。インライン添付は、本文の内容の一部として表示され、アイテムの残りの部分のコンテンツとの関係でその位置を保持します。 </span><span class="sxs-lookup"><span data-stu-id="e9349-p106">Inline attachments are a special breed of attachment. Both file attachments and item attachments can be inline attachments. An inline attachment appears as part of the body content and retains its position relative to the rest of the content in the item.</span></span> 
  
<span data-ttu-id="e9349-156">EWS [IsInline](http://msdn.microsoft.com/library/5e7712c8-372a-4a16-be64-360c5ff3961a%28Office.15%29.aspx)要素または指定されたマネージ API の EWS [IsInline](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.attachment.isinline%28v=exchg.80%29.aspx)プロパティが設定されている場合、添付ファイルはインラインの添付ファイルを true にします。</span><span class="sxs-lookup"><span data-stu-id="e9349-156">An attachment is an inline attachment if the EWS Managed API [IsInline](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.attachment.isinline%28v=exchg.80%29.aspx) property or the EWS [IsInline](http://msdn.microsoft.com/library/5e7712c8-372a-4a16-be64-360c5ff3961a%28Office.15%29.aspx) element is set to true.</span></span> <span data-ttu-id="e9349-157">インラインの添付ファイルは、インラインの添付ファイルの場所を識別するのには、次の省略可能なプロパティと要素を使用します。</span><span class="sxs-lookup"><span data-stu-id="e9349-157">Inline attachments use the following optional properties and elements to identify the location of an inline attachment:</span></span> 
  
- <span data-ttu-id="e9349-158">EWS マネージ API では、 [ContentId](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.attachment.contentid%28v=exchg.80%29.aspx)または[ContentLocation](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.attachment.contentlocation%28v=exchg.80%29.aspx)のプロパティです。</span><span class="sxs-lookup"><span data-stu-id="e9349-158">EWS Managed API — [ContentId](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.attachment.contentid%28v=exchg.80%29.aspx) or [ContentLocation](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.attachment.contentlocation%28v=exchg.80%29.aspx) properties.</span></span> 
    
- <span data-ttu-id="e9349-159">EWS- [ContentId](http://msdn.microsoft.com/library/bc59100d-6079-414b-a6e0-7c15feaa3184%28Office.15%29.aspx)または[ContentLocation](http://msdn.microsoft.com/library/d91cf587-24e3-4c13-8784-5ca29787cca7%28Office.15%29.aspx)要素です。</span><span class="sxs-lookup"><span data-stu-id="e9349-159">EWS — [ContentId](http://msdn.microsoft.com/library/bc59100d-6079-414b-a6e0-7c15feaa3184%28Office.15%29.aspx) or [ContentLocation](http://msdn.microsoft.com/library/d91cf587-24e3-4c13-8784-5ca29787cca7%28Office.15%29.aspx) element.</span></span> 
    
<span data-ttu-id="e9349-160">注は、EWS のマネージ API の[添付ファイル付き](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.hasattachments%28v=exchg.80%29.aspx)のプロパティは、EWS の[添付ファイル付き](http://msdn.microsoft.com/library/538b7a85-11d7-4daa-8458-09b540760e8b%28Office.15%29.aspx)の要素を反映しない存在のインラインの添付ファイルとはインラインの添付ファイルとも呼ばれます理由非表示の添付ファイルです。</span><span class="sxs-lookup"><span data-stu-id="e9349-160">Note that the EWS Managed API [HasAttachments](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.hasattachments%28v=exchg.80%29.aspx) property and the EWS [HasAttachments](http://msdn.microsoft.com/library/538b7a85-11d7-4daa-8458-09b540760e8b%28Office.15%29.aspx) element do not reflect the existence of inline attachments, and that's why inline attachments are also called hidden attachments.</span></span> <span data-ttu-id="e9349-161">マネージ API の EWS [IsInline](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.attachment.isinline%28v=exchg.80%29.aspx)プロパティまたは EWS [IsInline](http://msdn.microsoft.com/library/5e7712c8-372a-4a16-be64-360c5ff3961a%28Office.15%29.aspx)要素が true に設定すると、項目の他の添付ファイルがない、**添付ファイル付き**が false に設定されます。</span><span class="sxs-lookup"><span data-stu-id="e9349-161">So if you set the EWS Managed API [IsInline](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.attachment.isinline%28v=exchg.80%29.aspx) property or the EWS [IsInline](http://msdn.microsoft.com/library/5e7712c8-372a-4a16-be64-360c5ff3961a%28Office.15%29.aspx) element to true, and the item has no other attachments, **HasAttachments** will be set to false.</span></span> <span data-ttu-id="e9349-162">クライアントは、インジケーターの添付ファイルまたは電子メールのアイコンを設定するのには**添付ファイル付き**を使用する場合は、インラインの添付ファイル付き電子メールのアイコンが表示されないことに注意します。</span><span class="sxs-lookup"><span data-stu-id="e9349-162">If your client uses **HasAttachments** to populate an attachment indicator or icon on an email, be aware that the icon will not appear for emails with inline attachments.</span></span> 
  
## <a name="in-this-section"></a><span data-ttu-id="e9349-163">このセクションの内容</span><span class="sxs-lookup"><span data-stu-id="e9349-163">In this section</span></span>
<span data-ttu-id="e9349-164"><a name="bk_inthissection"> </a></span><span class="sxs-lookup"><span data-stu-id="e9349-164"></span></span>

- [<span data-ttu-id="e9349-165">Exchange EWS を使用して添付ファイルを追加します。</span><span class="sxs-lookup"><span data-stu-id="e9349-165">Add attachments by using EWS in Exchange</span></span>](how-to-add-attachments-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="e9349-166">Exchange EWS を使用して添付ファイルを取得します。</span><span class="sxs-lookup"><span data-stu-id="e9349-166">Get attachments by using EWS in Exchange</span></span>](how-to-get-attachments-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="e9349-167">Exchange EWS を使用して添付ファイルを削除します。</span><span class="sxs-lookup"><span data-stu-id="e9349-167">Delete attachments by using EWS in Exchange</span></span>](how-to-delete-attachments-by-using-ews-in-exchange.md)
    
## <a name="see-also"></a><span data-ttu-id="e9349-168">関連項目</span><span class="sxs-lookup"><span data-stu-id="e9349-168">See also</span></span>
<span data-ttu-id="e9349-169"><a name="bk_additionalresources"> </a></span><span class="sxs-lookup"><span data-stu-id="e9349-169"></span></span>

- [<span data-ttu-id="e9349-170">Exchange の Web サービス クライアントを開発する</span><span class="sxs-lookup"><span data-stu-id="e9349-170">Develop web service clients for Exchange</span></span>](develop-web-service-clients-for-exchange.md)
    
- [<span data-ttu-id="e9349-171">Exchange の EWS のフォルダーとアイテム</span><span class="sxs-lookup"><span data-stu-id="e9349-171">Folders and items in EWS in Exchange</span></span>](folders-and-items-in-ews-in-exchange.md)
    
- [<span data-ttu-id="e9349-172">Exchange の電子メールと EWS</span><span class="sxs-lookup"><span data-stu-id="e9349-172">Email and EWS in Exchange</span></span>](email-and-ews-in-exchange.md)
    

