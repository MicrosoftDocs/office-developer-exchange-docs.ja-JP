---
title: 自動検出を使用して構成情報を更新する
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: c2f3c6a5-e8ea-4375-b41a-686a6f238d33
description: 自動検出を使用して、Exchange 接続の構成情報をいつまたどのように更新するかについて説明します。
ms.openlocfilehash: b9a4264d150d09b0e143e0bf7365af351bb2ef44
ms.sourcegitcommit: 88ec988f2bb67c1866d06b361615f3674a24e795
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/03/2020
ms.locfileid: "44527755"
---
# <a name="refresh-configuration-information-by-using-autodiscover"></a><span data-ttu-id="b9ef1-103">自動検出を使用して構成情報を更新する</span><span class="sxs-lookup"><span data-stu-id="b9ef1-103">Refresh configuration information by using Autodiscover</span></span>

<span data-ttu-id="b9ef1-104">自動検出を使用して、Exchange 接続の構成情報をいつまたどのように更新するかについて説明します。</span><span class="sxs-lookup"><span data-stu-id="b9ef1-104">Learn how and when to refresh configuration information for your Exchange connection by using Autodiscover.</span></span>
  
<span data-ttu-id="b9ef1-p101">EWS アプリケーションを初めて実行するとき、自動検出は、ユーザーの Exchange メールボックスに接続するために必要な情報を収集する優れた方法です。しかし、自動検出は初めての使用だけに適しているわけではありません。定期的に自動検出を使用することで、アプリケーションを Exchange 展開の変化に対応させ、接続状態を保持することができます。</span><span class="sxs-lookup"><span data-stu-id="b9ef1-p101">When your EWS application runs for the first time, Autodiscover provides a great way for you to collect the information you need in order to connect to your user's Exchange mailbox. But Autodiscover isn't just for first time use. Using Autodiscover on a regular basis can help keep your application connected by enabling it to respond to changes in the Exchange deployment.</span></span>
  
## <a name="cache-autodiscover-endpoint-and-ews-settings"></a><span data-ttu-id="b9ef1-108">自動検出エンドポイントおよび EWS 設定のキャッシュ</span><span class="sxs-lookup"><span data-stu-id="b9ef1-108">Cache Autodiscover endpoint and EWS settings</span></span>
<span data-ttu-id="b9ef1-109"><a name="bk_CacheSettings"> </a></span><span class="sxs-lookup"><span data-stu-id="b9ef1-109"><a name="bk_CacheSettings"> </a></span></span>

<span data-ttu-id="b9ef1-p102">自動検出を定期的に使用することをお勧めしますが、これを行うには考慮すべき事項があります。環境の変化に対する迅速な対応と、数多く生成される不要なネットワーク トラフィックとのバランスをとるのが理想的です。アプリケーションが初めて自動検出応答に成功した場合、EWS 要求を送信するたびに自動検出プロセスを繰り返さなくてもいいように、次の情報を保存してください。</span><span class="sxs-lookup"><span data-stu-id="b9ef1-p102">While we recommend that you use Autodiscover regularly, how regularly you use it requires some consideration. Ideally you can balance responding quickly to changes in the environment against generating too much unnecessary network traffic. When your application gets a successful Autodiscover response for the first time, you should save the following information so that you do not have to repeat the Autodiscover process every time you send an EWS request.</span></span>
  
<span data-ttu-id="b9ef1-113">**表 1. 自動検出要求に関してキャッシュする情報**</span><span class="sxs-lookup"><span data-stu-id="b9ef1-113">**Table 1. Information to cache for Autodiscover requests**</span></span>

|<span data-ttu-id="b9ef1-114">**キャッシュする設定**</span><span class="sxs-lookup"><span data-stu-id="b9ef1-114">**Setting to cache**</span></span>|<span data-ttu-id="b9ef1-115">**有効期間**</span><span class="sxs-lookup"><span data-stu-id="b9ef1-115">**Valid for…**</span></span>|<span data-ttu-id="b9ef1-116">**詳細**</span><span class="sxs-lookup"><span data-stu-id="b9ef1-116">**Details**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="b9ef1-117">自動検出エンドポイント</span><span class="sxs-lookup"><span data-stu-id="b9ef1-117">Autodiscover endpoint</span></span>  <br/> |<span data-ttu-id="b9ef1-118">動作中</span><span class="sxs-lookup"><span data-stu-id="b9ef1-118">As long as it works</span></span>  <br/> |<span data-ttu-id="b9ef1-119">正常な応答が返された自動検出エンドポイントを保存すると、[自動検出エンドポイントの一覧を生成](how-to-generate-a-list-of-autodiscover-endpoints.md)して、正常な応答を取得するまで自動検出プロセスを繰り返す必要はありません。</span><span class="sxs-lookup"><span data-stu-id="b9ef1-119">When you save the Autodiscover endpoint that returned a successful response, you do not have to repeat the process of [generating a list of Autodiscover endpoints](how-to-generate-a-list-of-autodiscover-endpoints.md) and trying them until you get a successful response.</span></span><br/><br/> <span data-ttu-id="b9ef1-120">**注**: EWS のマネージ API は、自動検出エンドポイントのキャッシュをサポートしていません。</span><span class="sxs-lookup"><span data-stu-id="b9ef1-120">**NOTE**: The EWS Managed API does not support caching the Autodiscover endpoint.</span></span>           |
|<span data-ttu-id="b9ef1-121">EWS URL および自動検出応答から取得したその他の設定</span><span class="sxs-lookup"><span data-stu-id="b9ef1-121">EWS URL and any other settings retrieved from the Autodiscover response</span></span>  <br/> |<span data-ttu-id="b9ef1-122">1週間</span><span class="sxs-lookup"><span data-stu-id="b9ef1-122">One week</span></span>  <br/> |<span data-ttu-id="b9ef1-123">EWS URL およびその他の関連設定を保存することによって、EWS 要求ごとに、またはアプリケーションを再起動するときに、[新しい自動検出要求を送信する](how-to-get-user-settings-from-exchange-by-using-autodiscover.md)必要はありません。</span><span class="sxs-lookup"><span data-stu-id="b9ef1-123">By saving the EWS URL and other related settings, you do not have to [send a new Autodiscover request](how-to-get-user-settings-from-exchange-by-using-autodiscover.md) for each EWS request or if your application restarts.</span></span> <span data-ttu-id="b9ef1-124">ただし、EWS URL が動作するとしても、より最適なサーバーが使用可能な場合があります。</span><span class="sxs-lookup"><span data-stu-id="b9ef1-124">However, even if an EWS URL works for your user, a server might be available that is more optimal.</span></span><br/><br/> <span data-ttu-id="b9ef1-125">たとえば、ユーザーのメールボックスが新しいメールボックス サーバーに移動され、新しい優先 EWS エンドポイントが生成されるという場合です。</span><span class="sxs-lookup"><span data-stu-id="b9ef1-125">For example, the user's mailbox might have moved to a new mailbox server, resulting in a new preferred EWS endpoint.</span></span> <span data-ttu-id="b9ef1-126">前回の自動検出要求から1週間後に、新しい自動検出要求を送信して、ユーザー設定を更新することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="b9ef1-126">We recommend that you refresh your user settings by sending a new Autodiscover request after one week has passed since your last Autodiscover request.</span></span> <span data-ttu-id="b9ef1-127">この時間は、アプリケーションの要件を満たすように調整することができます。</span><span class="sxs-lookup"><span data-stu-id="b9ef1-127">This time can be adjusted to meet the requirements of your application.</span></span>  <br/> |
   
## <a name="refresh-cached-configuration-information"></a><span data-ttu-id="b9ef1-128">キャッシュされた構成情報を更新する</span><span class="sxs-lookup"><span data-stu-id="b9ef1-128">Refresh cached configuration information</span></span>
<span data-ttu-id="b9ef1-129"><a name="bk_RefreshConfig"> </a></span><span class="sxs-lookup"><span data-stu-id="b9ef1-129"><a name="bk_RefreshConfig"> </a></span></span>

<span data-ttu-id="b9ef1-p105">情報をキャッシュしたので、今度はそのキャッシュを最新の状態に保つ方法について調べてみましょう。次の場合に、キャッシュされた情報を更新することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="b9ef1-p105">Now that you have the information cached, let's examine how you can keep that cache fresh. We recommend that you refresh your cached information when:</span></span>
  
- <span data-ttu-id="b9ef1-132">情報の有効期間の期限が切れている場合。</span><span class="sxs-lookup"><span data-stu-id="b9ef1-132">The information's validity period expires.</span></span>
    
- <span data-ttu-id="b9ef1-133">[接続関連のエラー](#bk_ConnectionErrors)が発生し、キャッシュされた情報が1時間前に最後に更新されたことを示します。</span><span class="sxs-lookup"><span data-stu-id="b9ef1-133">A [Connection-related error](#bk_ConnectionErrors) occurs AND your cached information was last refreshed over an hour ago.</span></span>
    
<span data-ttu-id="b9ef1-134">キャッシュされた情報を更新するには、キャッシュされた自動検出エンドポイントに自動検出要求を送信し、次の操作を行います。</span><span class="sxs-lookup"><span data-stu-id="b9ef1-134">To refresh your cached information, send an Autodiscover request to a cached Autodiscover endpoint, and do the following:</span></span>
  
- <span data-ttu-id="b9ef1-135">要求が成功したら、応答の EWS エンドポイントとキャッシュされた EWS エンドポイントを比較し、次の操作を行います。</span><span class="sxs-lookup"><span data-stu-id="b9ef1-135">If the request succeeds, compare the EWS endpoint in the response with the cached EWS endpoint, and do the following:</span></span>
    
  - <span data-ttu-id="b9ef1-p106">2 つのエンドポイントが異なる場合は、新しい EWS エンドポイントを使用します。エラーから回復するために更新する場合は、新しいエンドポイントを使用して失敗した要求を再試行してください。</span><span class="sxs-lookup"><span data-stu-id="b9ef1-p106">If they are different, use the new EWS endpoint. If you're refreshing to recover from an error, retry the failed request with the new endpoint.</span></span>
    
  - <span data-ttu-id="b9ef1-p107">2 つのエンドポイントが同じ場合は、元の EWS エンドポイントを引き続き使用します。エラーから回復するために更新する場合は、必要に応じてエラーを処理します。</span><span class="sxs-lookup"><span data-stu-id="b9ef1-p107">If they are the same, continue to use the original EWS endpoint. If you're refreshing to recover from an error, handle the error as appropriate.</span></span>
    
- <span data-ttu-id="b9ef1-p108">要求が失敗した場合は、[自動検出プロセス](autodiscover-for-exchange.md)を最初から開始します。正常な応答を取得したら、キャッシュされた自動検出エンドポイントを、正常な自動検出エンドポイントに置き換え、新しい EWS エンドポイントを引き続き使用します。正常な応答を取得できなかった場合は、引き続き元の自動検出エンドポイントと EWS エンドポイントを使用します。エラーから回復するために更新する場合は、必要に応じてエラーを処理します。</span><span class="sxs-lookup"><span data-stu-id="b9ef1-p108">If the request fails, start the [Autodiscover process](autodiscover-for-exchange.md) from the beginning. After you get a successful response, replace the cached Autodiscover endpoint with the Autodiscover endpoint that succeeded and continue to use the new EWS endpoint. If you do not get a successful response, continue to use the original Autodiscover endpoint and EWS endpoint. If you're refreshing to recover from an error, handle the error as appropriate.</span></span> 
    
<span data-ttu-id="b9ef1-144">次の図は、このプロセスを視覚的に表したものです。</span><span class="sxs-lookup"><span data-stu-id="b9ef1-144">The following figure provides a visual representation of this process.</span></span>
  
<span data-ttu-id="b9ef1-145">**図 1. 自動検出を使用して構成情報を更新するプロセス**</span><span class="sxs-lookup"><span data-stu-id="b9ef1-145">**Figure 1. Process for refreshing configuration information by using Autodiscover**</span></span>

![模式図は自動検出が構成情報を更新する方法を示しています。](media/Ex15_Autodiscover_Refresh_Flowchart.png)
  
### <a name="connection-related-errors"></a><span data-ttu-id="b9ef1-147">接続に関連するエラー</span><span class="sxs-lookup"><span data-stu-id="b9ef1-147">Connection-related errors</span></span>
<span data-ttu-id="b9ef1-148"><a name="bk_ConnectionErrors"> </a></span><span class="sxs-lookup"><span data-stu-id="b9ef1-148"><a name="bk_ConnectionErrors"> </a></span></span>

<span data-ttu-id="b9ef1-149">キャッシュされた構成情報を更新すると、すべてではありませんが、一部のエラーを解決することができます。</span><span class="sxs-lookup"><span data-stu-id="b9ef1-149">Refreshing your cached configuration information can help with some errors, but not all.</span></span> 
  
<span data-ttu-id="b9ef1-150">**表 2. キャッシュの更新によって解決するエラー**</span><span class="sxs-lookup"><span data-stu-id="b9ef1-150">**Table 2. Errors addressed by refreshing your cache**</span></span>

|<span data-ttu-id="b9ef1-151">**エラー**</span><span class="sxs-lookup"><span data-stu-id="b9ef1-151">**Error**</span></span>|<span data-ttu-id="b9ef1-152">**EWS マネージ API の実装**</span><span class="sxs-lookup"><span data-stu-id="b9ef1-152">**EWS Managed API implementation**</span></span>|<span data-ttu-id="b9ef1-153">**注**</span><span class="sxs-lookup"><span data-stu-id="b9ef1-153">**Notes**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="b9ef1-154">DNS またはネットワーク障害のエラー</span><span class="sxs-lookup"><span data-stu-id="b9ef1-154">DNS or network failure errors</span></span><br/><br/> <span data-ttu-id="b9ef1-155">例: Host name could not be found. (ホスト名が見つかりませんでした。)</span><span class="sxs-lookup"><span data-stu-id="b9ef1-155">Example: Host name could not be found.</span></span>  <br/> |[<span data-ttu-id="b9ef1-156">ServiceRemoteException</span><span class="sxs-lookup"><span data-stu-id="b9ef1-156">ServiceRemoteException</span></span>](https://docs.microsoft.com/dotnet/api/microsoft.exchange.webservices.data.serviceremoteexception?view=exchange-ews-api) <br/> |<span data-ttu-id="b9ef1-157">サーバーが見つからないか、サーバーにアクセスできなかったことを示すすべてのエラーは、自動検出を試みることによって解決される場合があります。</span><span class="sxs-lookup"><span data-stu-id="b9ef1-157">Any error that indicates that the server could not be found or could not be reached might be resolved by trying Autodiscover.</span></span> <br/><br/> <span data-ttu-id="b9ef1-158">キャッシュされた EWS エンドポイントが有効ではなくなった可能性があります。自動検出によって新しいサーバーに誘導できる場合があります。</span><span class="sxs-lookup"><span data-stu-id="b9ef1-158">Your cached EWS endpoint might no longer be valid, and Autodiscover might be able to point you to the new server.</span></span>  <br/> |
|<span data-ttu-id="b9ef1-159">HTTP の状態エラー</span><span class="sxs-lookup"><span data-stu-id="b9ef1-159">HTTP status errors</span></span><br/><br/> <span data-ttu-id="b9ef1-160">例: 503 Service Unavailable (503 サービスを利用できません)</span><span class="sxs-lookup"><span data-stu-id="b9ef1-160">Example: 503 Service Unavailable</span></span>  <br/> |[<span data-ttu-id="b9ef1-161">ServiceRemoteException</span><span class="sxs-lookup"><span data-stu-id="b9ef1-161">ServiceRemoteException</span></span>](https://docs.microsoft.com/dotnet/api/microsoft.exchange.webservices.data.serviceremoteexception?view=exchange-ews-api) <br/> |<span data-ttu-id="b9ef1-162">HTTP の状態エラーはさまざまな理由で発生します。</span><span class="sxs-lookup"><span data-stu-id="b9ef1-162">HTTP status errors can happen for many different reasons.</span></span><br/><br/> <span data-ttu-id="b9ef1-163">ただし、自動検出を実行して、ユーザーが新しい EWS エンドポイントを利用できるかどうか調べることをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="b9ef1-163">However, it's a good idea to try Autodiscover to see if a new EWS endpoint is available for the user.</span></span>  <br/> |
|<span data-ttu-id="b9ef1-164">EWS のエラー コード</span><span class="sxs-lookup"><span data-stu-id="b9ef1-164">EWS error codes</span></span> <br/><br/> <span data-ttu-id="b9ef1-165">例: ErrorConnectionFailed</span><span class="sxs-lookup"><span data-stu-id="b9ef1-165">Example: ErrorConnectionFailed</span></span> <br/> |[<span data-ttu-id="b9ef1-166">ResponseCodeType</span><span class="sxs-lookup"><span data-stu-id="b9ef1-166">ResponseCodeType</span></span>](../web-service-reference/responsecode.md) <br/> | <span data-ttu-id="b9ef1-167">ほとんどの EWS のエラー コードは、構成情報の更新の根拠にはなりません。</span><span class="sxs-lookup"><span data-stu-id="b9ef1-167">Most EWS error codes don't warrant refreshing your configuration information.</span></span><br/><br/> <span data-ttu-id="b9ef1-168">ただし、次のエラー コードは、構成情報を更新する必要があることを明確に示しています。</span><span class="sxs-lookup"><span data-stu-id="b9ef1-168">However, the following specifically indicate that the configuration information needs to be updated:</span></span><br/><span data-ttu-id="b9ef1-169">- **ErrorConnectionFailed**</span><span class="sxs-lookup"><span data-stu-id="b9ef1-169">- **ErrorConnectionFailed**</span></span> <br/><span data-ttu-id="b9ef1-170">- **ErrorMailboxMoveInProgress**</span><span class="sxs-lookup"><span data-stu-id="b9ef1-170">- **ErrorMailboxMoveInProgress**</span></span> <br/> |
   
## <a name="see-also"></a><span data-ttu-id="b9ef1-171">関連項目</span><span class="sxs-lookup"><span data-stu-id="b9ef1-171">See also</span></span>

- [<span data-ttu-id="b9ef1-172">Exchange の自動検出</span><span class="sxs-lookup"><span data-stu-id="b9ef1-172">Autodiscover for Exchange</span></span>](autodiscover-for-exchange.md)  
- [<span data-ttu-id="b9ef1-173">自動検出エンドポイントの一覧を生成する</span><span class="sxs-lookup"><span data-stu-id="b9ef1-173">Generate a list of Autodiscover endpoints</span></span>](how-to-generate-a-list-of-autodiscover-endpoints.md)   
- [<span data-ttu-id="b9ef1-174">自動検出を使用して Exchange からユーザー設定を取得する</span><span class="sxs-lookup"><span data-stu-id="b9ef1-174">Get user settings from Exchange by using Autodiscover</span></span>](how-to-get-user-settings-from-exchange-by-using-autodiscover.md)
    

